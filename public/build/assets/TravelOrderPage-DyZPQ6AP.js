import{V as A,r as m,j as e,M as E,h}from"./app-C_ClQmDY.js";import{A as M}from"./AuthenticatedLayout-3cR_usYW.js";import{S as $}from"./Sidebar-Bhx-DaaE.js";import L from"./TravelOrderList-DNNmV7g8.js";import P from"./TravelOrderForm-CYJchxXB.js";import{y as o,L as k}from"./index-CBJp45S4.js";/* empty css                      */import"./ApplicationLogo-BORf3137.js";import"./Dropdown-CHXQRgIL.js";import"./transition-0ACRCynB.js";import"./search-BDKFcNkb.js";import"./createLucideIcon-D1ADp28Z.js";import"./x-Q1lJB2Tb.js";/* empty css                */import"./users-Dr4YdQlV.js";import"./file-text-DMC5LN9m.js";import"./calendar-B28JSqfz.js";import"./StatusBadge-Bvd18zn6.js";import"./TravelOrderDetailModal-BVDo1oL7.js";import"./format-Ur_Fko9Q.js";import"./parseISO-y7BAppcC.js";import"./differenceInDays-Dw6PLei1.js";import"./addDays-Bd4xD-lv.js";import"./MultiBulkActionModal-BJEyYUOT.js";import"./download-BQI3-SNa.js";import"./clsx-B-dksMZM.js";const ie=()=>{const{props:n}=A(),{auth:q,flash:a={}}=n,[v,c]=m.useState(n.travelOrders||[]),[p,x]=m.useState("list"),[g,u]=m.useState(!1),y=n.employees||[],j=n.departments||[];m.useEffect(()=>{a&&a.message&&o.success(a.message),a&&a.error&&o.error(a.error)},[a]);const O=t=>{h.post(route("travel-orders.store"),t,{onSuccess:r=>{r.props.travelOrders&&c(r.props.travelOrders),o.success("Travel Order requests created successfully")},onError:r=>{r&&typeof r=="object"?Object.keys(r).forEach(l=>{o.error(r[l])}):o.error("An error occurred while submitting form")}})},S=(t,r)=>{if(g)return;const l=Array.isArray(t);l?(console.log(`Batch status update for ${t.length} items`),u(!0)):console.log("Status update called with:",t,r);const f=(d,s)=>new Promise((N,T)=>{h.post(route("travel-orders.updateStatus",d),s,{preserveScroll:!0,onSuccess:i=>{!l&&i.props.travelOrders&&c(i.props.travelOrders),N(i)},onError:i=>{let b="An error occurred while updating status";i&&typeof i=="object"&&(b=Object.values(i).join(", ")),T(b)}})});if(!l)f(t,r).then(()=>{o.success("Travel Order status updated successfully")}).catch(d=>{o.error(d)});else{const d=t.map(s=>f(s,r));Promise.all(d).then(s=>{s.length>0&&s[s.length-1].props.travelOrders&&c(s[s.length-1].props.travelOrders),o.success(`Successfully updated ${t.length} travel order requests`),u(!1)}).catch(s=>{o.error(`Error updating some travel order requests: ${s}`),u(!1)})}},w=t=>{confirm("Are you sure you want to delete this travel order?")&&h.delete(route("travel-orders.destroy",t),{preserveScroll:!0,onSuccess:r=>{r.props.travelOrders?c(r.props.travelOrders):c(v.filter(l=>l.id!==t)),o.success("Travel Order deleted successfully")},onError:()=>o.error("Failed to delete travel order")})};return e.jsxs(M,{children:[e.jsx(E,{title:"Travel Order Management"}),e.jsxs("div",{className:"flex min-h-screen bg-gray-50/50",children:[e.jsx("div",{className:"fixed h-screen",children:e.jsx($,{})}),e.jsx("div",{className:"flex-1 p-8 ml-64",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Travel Order Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage employee travel orders and approvals."})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{className:`${p==="list"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,onClick:()=>x("list"),children:"View Travel Orders"}),e.jsx("button",{className:`${p==="create"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,onClick:()=>x("create"),children:"File New Travel Order"})]})})}),p==="list"?e.jsx(L,{travelOrders:v,onStatusUpdate:S,onDelete:w}):e.jsx(P,{employees:y,departments:j,onSubmit:O})]})})]})})]}),e.jsx(k,{position:"top-right",autoClose:3e3})]})};export{ie as default};
