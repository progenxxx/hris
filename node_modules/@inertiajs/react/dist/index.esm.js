import{router as et}from"@inertiajs/core";import{router as be,setupProgress as ke}from"@inertiajs/core";import{createElement as Ce}from"react";import{createHeadManager as Se,router as G}from"@inertiajs/core";import{createElement as E,useEffect as Te,useMemo as ve,useState as Fe}from"react";import{createContext as ye}from"react";var Y=ye(void 0);Y.displayName="InertiaHeadContext";var w=Y;import{createContext as he}from"react";var z=he(void 0);z.displayName="InertiaPageContext";var O=z;function H({children:p,initialPage:r,initialComponent:s,resolveComponent:a,titleCallback:i,onHeadUpdate:P}){let[l,m]=Fe({component:s||null,page:r,key:null}),g=ve(()=>Se(typeof window>"u",i||(f=>f),P||(()=>{})),[]);if(Te(()=>{G.init({initialPage:r,resolveComponent:a,swapComponent:async({component:f,page:e,preserveState:c})=>{m(n=>({component:f,page:e,key:c?n.key:Date.now()}))}}),G.on("navigate",()=>g.forceUpdate())},[]),!l.component)return E(w.Provider,{value:g},E(O.Provider,{value:l.page},null));let y=p||(({Component:f,props:e,key:c})=>{let n=E(f,{key:c,...e});return typeof f.layout=="function"?f.layout(n):Array.isArray(f.layout)?f.layout.concat(n).reverse().reduce((h,S)=>E(S,{children:h,...e})):n});return E(w.Provider,{value:g},E(O.Provider,{value:l.page},y({Component:l.component,key:l.key,props:l.page.props})))}H.displayName="Inertia";async function X({id:p="app",resolve:r,setup:s,title:a,progress:i={},page:P,render:l}){let m=typeof window>"u",g=m?null:document.getElementById(p),y=P||JSON.parse(g.dataset.page),f=n=>Promise.resolve(r(n)).then(h=>h.default||h),e=[],c=await Promise.all([f(y.component),be.decryptHistory().catch(()=>{})]).then(([n])=>s({el:g,App:H,props:{initialPage:y,initialComponent:n,resolveComponent:f,titleCallback:a,onHeadUpdate:m?h=>e=h:null}}));if(!m&&i&&ke(i),m){let n=await l(Ce("div",{id:p,"data-page":JSON.stringify(y)},c));return{head:e,body:n}}}import{useEffect as xe,useState as Ie}from"react";import{useContext as Re}from"react";function V(){let p=Re(O);if(!p)throw new Error("usePage must be used within the Inertia component");return p}var Z=({children:p,data:r,fallback:s})=>{if(!r)throw new Error("`<Deferred>` requires a `data` prop");let[a,i]=Ie(!1),P=V().props,l=Array.isArray(r)?r:[r];return xe(()=>{i(l.every(m=>P[m]!==void 0))},[P,l]),a?p:s};Z.displayName="InertiaDeferred";var Ee=Z;import ee,{useContext as Ae,useEffect as we,useMemo as Oe}from"react";var De=function({children:p,title:r}){let s=Ae(w),a=Oe(()=>s.createProvider(),[s]);we(()=>()=>{a.disconnect()},[a]);function i(e){return["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"].indexOf(e.type)>-1}function P(e){let c=Object.keys(e.props).reduce((n,h)=>{if(["head-key","children","dangerouslySetInnerHTML"].includes(h))return n;let S=e.props[h];return S===""?n+` ${h}`:n+` ${h}="${S}"`},"");return`<${e.type}${c}>`}function l(e){return typeof e.props.children=="string"?e.props.children:e.props.children.reduce((c,n)=>c+m(n),"")}function m(e){let c=P(e);return e.props.children&&(c+=l(e)),e.props.dangerouslySetInnerHTML&&(c+=e.props.dangerouslySetInnerHTML.__html),i(e)||(c+=`</${e.type}>`),c}function g(e){return ee.cloneElement(e,{inertia:e.props["head-key"]!==void 0?e.props["head-key"]:""})}function y(e){return m(g(e))}function f(e){let c=ee.Children.toArray(e).filter(n=>n).map(n=>y(n));return r&&!c.find(n=>n.startsWith("<title"))&&c.push(`<title inertia>${r}</title>`),c}return a.update(f(p)),null},Me=De;import{mergeDataIntoQueryString as Le,router as j,shouldIntercept as W}from"@inertiajs/core";import{createElement as He,forwardRef as Ve,useEffect as te,useMemo as re,useRef as Be,useState as Ne}from"react";var k=()=>{},ne=Ve(({children:p,as:r="a",data:s={},href:a,method:i="get",preserveScroll:P=!1,preserveState:l=null,replace:m=!1,only:g=[],except:y=[],headers:f={},queryStringArrayFormat:e="brackets",async:c=!1,onClick:n=k,onCancelToken:h=k,onBefore:S=k,onStart:R=k,onProgress:x=k,onFinish:B=k,onCancel:L=k,onSuccess:N=k,onError:A=k,prefetch:v=!1,cacheFor:F=0,...t},u)=>{let[o,b]=Ne(0),d=Be(null);r=r.toLowerCase(),i=i.toLowerCase();let[fe,de]=Le(i,a||"",s,e);a=fe,s=de;let q={data:s,method:i,preserveScroll:P,preserveState:l??i!=="get",replace:m,only:g,except:y,headers:f,async:c},J={...q,onCancelToken:h,onBefore:S,onStart(T){b($=>$+1),R(T)},onProgress:x,onFinish(T){b($=>$-1),B(T)},onCancel:L,onSuccess:N,onError:A},U=()=>{j.prefetch(a,q,{cacheFor:me})},I=re(()=>v===!0?["hover"]:v===!1?[]:Array.isArray(v)?v:[v],Array.isArray(v)?v:[v]),me=re(()=>F!==0?F:I.length===1&&I[0]==="click"?0:3e4,[F,I]);te(()=>()=>{clearTimeout(d.current)},[]),te(()=>{I.includes("mount")&&setTimeout(()=>U())},I);let Q={onClick:T=>{n(T),W(T)&&(T.preventDefault(),j.visit(a,J))}},ge={onMouseEnter:()=>{d.current=window.setTimeout(()=>{U()},75)},onMouseLeave:()=>{clearTimeout(d.current)},onClick:Q.onClick},Pe={onMouseDown:T=>{W(T)&&(T.preventDefault(),U())},onMouseUp:T=>{T.preventDefault(),j.visit(a,J)},onClick:T=>{n(T),W(T)&&T.preventDefault()}};return i!=="get"&&(r="button"),He(r,{...t,...{a:{href:a},button:{type:"button"}}[r]||{},ref:u,...(()=>I.includes("hover")?ge:I.includes("click")?Pe:Q)(),"data-loading":o>0?"":void 0},p)});ne.displayName="InertiaLink";var Ue=ne;import{router as se}from"@inertiajs/core";import We from"lodash.isequal";import{useCallback as Ke,useEffect as _e,useRef as K,useState as C}from"react";import{router as oe}from"@inertiajs/core";import{useEffect as $e,useState as je}from"react";function D(p,r){let[s,a]=je(()=>{let i=oe.restore(r);return i!==void 0?i:p});return $e(()=>{oe.remember(s,r)},[s,r]),[s,a]}function ae(p,r){let s=K(null),a=typeof p=="string"?p:null,[i,P]=C((typeof p=="string"?r:p)||{}),l=K(null),m=K(null),[g,y]=a?D(i,`${a}:data`):C(i),[f,e]=a?D({},`${a}:errors`):C({}),[c,n]=C(!1),[h,S]=C(!1),[R,x]=C(null),[B,L]=C(!1),[N,A]=C(!1),v=t=>t;_e(()=>(s.current=!0,()=>{s.current=!1}),[]);let F=Ke((t,u,o={})=>{let b={...o,onCancelToken:d=>{if(l.current=d,o.onCancelToken)return o.onCancelToken(d)},onBefore:d=>{if(L(!1),A(!1),clearTimeout(m.current),o.onBefore)return o.onBefore(d)},onStart:d=>{if(S(!0),o.onStart)return o.onStart(d)},onProgress:d=>{if(x(d),o.onProgress)return o.onProgress(d)},onSuccess:d=>{if(s.current&&(S(!1),x(null),e({}),n(!1),L(!0),A(!0),m.current=setTimeout(()=>{s.current&&A(!1)},2e3)),o.onSuccess)return o.onSuccess(d)},onError:d=>{if(s.current&&(S(!1),x(null),e(d),n(!0)),o.onError)return o.onError(d)},onCancel:()=>{if(s.current&&(S(!1),x(null)),o.onCancel)return o.onCancel()},onFinish:d=>{if(s.current&&(S(!1),x(null)),l.current=null,o.onFinish)return o.onFinish(d)}};t==="delete"?se.delete(u,{...b,data:v(g)}):se[t](u,v(g),b)},[g,e,v]);return{data:g,setData(t,u){y(typeof t=="string"?o=>({...o,[t]:u}):typeof t=="function"?o=>t(o):t)},isDirty:!We(g,i),errors:f,hasErrors:c,processing:h,progress:R,wasSuccessful:B,recentlySuccessful:N,transform(t){v=t},setDefaults(t,u){P(typeof t>"u"?()=>g:o=>({...o,...typeof t=="string"?{[t]:u}:t}))},reset(...t){t.length===0?y(i):y(Object.keys(i).filter(u=>t.includes(u)).reduce((u,o)=>(u[o]=i[o],u),{...g}))},setError(t,u){e(o=>{let b={...o,...typeof t=="string"?{[t]:u}:t};return n(Object.keys(b).length>0),b})},clearErrors(...t){e(u=>{let o=Object.keys(u).reduce((b,d)=>({...b,...t.length>0&&!t.includes(d)?{[d]:u[d]}:{}}),{});return n(Object.keys(o).length>0),o})},submit:F,get(t,u){F("get",t,u)},post(t,u){F("post",t,u)},put(t,u){F("put",t,u)},patch(t,u){F("patch",t,u)},delete(t,u){F("delete",t,u)},cancel(){l.current&&l.current.cancel()}}}import{router as qe}from"@inertiajs/core";import{useEffect as Je,useRef as Qe}from"react";function ie(p,r={},s={keepAlive:!1,autoStart:!0}){let a=Qe(qe.poll(p,r,{...s,autoStart:!1}));return Je(()=>((s.autoStart??!0)&&a.current.start(),()=>a.current.stop()),[]),{stop:a.current.stop,start:a.current.start}}import{router as M}from"@inertiajs/core";import{useEffect as Ye,useState as _}from"react";function pe(p={}){let r=typeof window>"u"?null:M.getCached(window.location.pathname,p),s=typeof window>"u"?null:M.getPrefetching(window.location.pathname,p),[a,i]=_(r?.staleTimestamp||null),[P,l]=_(s!==null),[m,g]=_(r!==null);return Ye(()=>{let y=M.on("prefetching",e=>{e.detail.visit.url.pathname===window.location.pathname&&l(!0)}),f=M.on("prefetched",e=>{e.detail.visit.url.pathname===window.location.pathname&&(l(!1),g(!0),i(e.detail.fetchedAt))});return()=>{f(),y()}},[]),{lastUpdatedAt:a,isPrefetching:P,isPrefetched:m,flush:()=>M.flush(window.location.pathname,p)}}import{router as ze}from"@inertiajs/core";import{createElement as Ge,useEffect as Xe,useRef as ue,useState as le}from"react";var ce=({children:p,data:r,params:s,buffer:a,as:i,always:P,fallback:l})=>{P=P??!1,i=i??"div",l=l??null;let[m,g]=le(!1),[y,f]=le(!1),e=ue(null),c=ue(null),n=()=>{if(r)return{only:Array.isArray(r)?r:[r]};if(!s)throw new Error("You must provide either a `data` or `params` prop.");return s};return Xe(()=>{if(c.current)return e.current=new IntersectionObserver(h=>{if(!h[0].isIntersecting||(P||e.current?.disconnect(),y))return;f(!0);let S=n();ze.reload({...S,onStart:R=>{f(!0),S.onStart?.(R)},onFinish:R=>{g(!0),f(!1),S.onFinish?.(R)}})},{rootMargin:`${a||0}px`}),e.current.observe(c.current),()=>{e.current?.disconnect()}},[c]),P||!m?Ge(i,{props:null,ref:c},m?p:l):m?p:null};ce.displayName="InertiaWhenVisible";var Ze=ce;var hr=et;export{Ee as Deferred,Me as Head,Ue as Link,Ze as WhenVisible,X as createInertiaApp,hr as router,ae as useForm,V as usePage,ie as usePoll,pe as usePrefetch,D as useRemember};
//# sourceMappingURL=index.esm.js.map
