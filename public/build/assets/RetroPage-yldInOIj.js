import{V as R,r as m,j as e,M as A,h as f}from"./app-C_ClQmDY.js";import{A as E}from"./AuthenticatedLayout-3cR_usYW.js";import{S as O}from"./Sidebar-Bhx-DaaE.js";import L from"./RetroList-B9Q2hC5d.js";import q from"./RetroForm-Do1ZImTP.js";import{y as o,L as D}from"./index-CBJp45S4.js";/* empty css                      */import{P as M}from"./plus-D1sl-ovH.js";import{L as P}from"./list-filter-BHZxFC6E.js";import"./ApplicationLogo-BORf3137.js";import"./Dropdown-CHXQRgIL.js";import"./transition-0ACRCynB.js";import"./search-BDKFcNkb.js";import"./createLucideIcon-D1ADp28Z.js";import"./x-Q1lJB2Tb.js";/* empty css                */import"./users-Dr4YdQlV.js";import"./file-text-DMC5LN9m.js";import"./calendar-B28JSqfz.js";import"./RetroStatusBadge-CbyPEb6M.js";import"./RetroDetailModal-DyT0ixdO.js";import"./dollar-sign-EMsHpLE5.js";import"./user-CzeVpIfb.js";import"./clock-CtBUUqYK.js";import"./circle-check-big-CRb1LywB.js";import"./circle-x-CQhehAg2.js";import"./RetroBulkActionModal-B5e_okoM.js";import"./RetroForceApproveButton-5Co5-lzj.js";import"./zap-BqYNij_k.js";import"./loader-circle-OBm8GvlE.js";import"./download-BQI3-SNa.js";import"./format-Ur_Fko9Q.js";import"./clsx-B-dksMZM.js";const de=()=>{const{props:h}=R(),{auth:b,flash:t={},userRoles:g={},retros:j=[],employees:y=[],departments:v=[]}=h,[x,c]=m.useState(j),[p,u]=m.useState("create"),[n,i]=m.useState(!1);m.useEffect(()=>{t&&t.message&&o.success(t.message),t&&t.error&&o.error(t.error),t&&t.errors&&Object.keys(t.errors).forEach(a=>{Array.isArray(t.errors[a])?t.errors[a].forEach(r=>o.error(r)):o.error(t.errors[a])})},[t]);const w=a=>{i(!0),f.post(route("retro.store"),a,{onSuccess:r=>{r.props.retros&&c(r.props.retros),o.success("Retro requests created successfully"),u("list"),i(!1)},onError:r=>{console.error("Submission errors:",r),r&&typeof r=="object"?Object.keys(r).forEach(s=>{Array.isArray(r[s])?r[s].forEach(l=>o.error(l)):o.error(r[s])}):o.error("An error occurred while submitting form"),i(!1)}})},S=(a,r)=>{n||(i(!0),f.post(route("retro.updateStatus",a),r,{preserveScroll:!0,onSuccess:s=>{s.props.retros?c(s.props.retros):c(l=>l.map(d=>d.id===a?{...d,status:r.status,remarks:r.remarks,approved_at:new Date().toISOString()}:d)),o.success("Retro status updated successfully"),i(!1)},onError:s=>{console.error("Status update errors:",s);let l="An error occurred while updating status";s&&typeof s=="object"&&(l=Object.values(s).join(", ")),o.error(l),i(!1)}}))},N=a=>{n||confirm("Are you sure you want to delete this retro request?")&&(i(!0),f.delete(route("retro.destroy",a),{preserveScroll:!0,onSuccess:r=>{r.props.retros?c(r.props.retros):c(s=>s.filter(l=>l.id!==a)),o.success("Retro request deleted successfully"),i(!1)},onError:r=>{console.error("Delete errors:",r),o.error("Failed to delete retro request"),i(!1)}}))};return e.jsxs(E,{user:b.user,children:[e.jsx(A,{title:"Retro Management"}),e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsx(O,{}),e.jsx("div",{className:"flex-1 p-8 ml-0",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"â‚± Retro Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage retrospective adjustments and corrections"})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{className:`${p==="create"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,onClick:()=>u("create"),children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"New Retro Request"]}),e.jsxs("button",{className:`${p==="list"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,onClick:()=>u("list"),children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"View Retro Requests",e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs",children:x.length})]})]})})}),p==="list"?e.jsx(L,{retros:x,onStatusUpdate:S,onDelete:N,userRoles:g,processing:n}):e.jsx(q,{employees:y,departments:v,onSubmit:w,processing:n})]})})]})})]}),e.jsx(D,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})};export{de as default};
