import{r as x,j as e}from"./app-7K62fd2B.js";import{f as K}from"./format-Bw_hER4B.js";const V=({employees:p,departments:M,onSubmit:P})=>{const f=K(new Date,"yyyy-MM-dd"),[a,y]=x.useState({employee_ids:[],original_date:f,requested_date:f,reason:""}),[u,F]=x.useState(p||[]),[h,q]=x.useState(""),[N,D]=x.useState("");x.useEffect(()=>{let s=[],t=[],n=[],r=[],l=[],S=[];p.forEach(i=>{var b;const g=a.employee_ids.includes(i.id);let c=!0,o=!1;if(h){const d=h.toLowerCase().trim(),w=(i.Fname||"").toLowerCase(),v=(i.Lname||"").toLowerCase(),z=(i.MName||"").toLowerCase(),G=`${w} ${v}`.trim(),H=`${v} ${w}`.trim(),_=(b=i.idno)==null?void 0:b.toString().toLowerCase(),L=(i.name||"").toLowerCase();w===d||v===d||G===d||H===d||L===d||_===d?(o=!0,c=!0):c=w.includes(d)||v.includes(d)||z.includes(d)||L.includes(d)||(_==null?void 0:_.includes(d))}let j=!0;N&&(j=(i.department||i.Department||"")===N),j&&(g&&o?s.push(i):g&&c?t.push(i):g?n.push(i):o?r.push(i):c?l.push(i):h||S.push(i))});const m=(i,g)=>{const c=o=>{if(o.name)return o.name.toLowerCase();const j=o.Lname||"",b=o.Fname||"";return`${j}, ${b}`.toLowerCase()};return c(i).localeCompare(c(g))};s.sort(m),t.sort(m),n.sort(m),r.sort(m),l.sort(m),S.sort(m);const O=[...s,...t,...n,...r,...l,...S];F(O)},[h,N,p,a.employee_ids]);const C=s=>{const{name:t,value:n}=s.target;y({...a,[t]:n})},k=s=>{const t=parseInt(s,10);y(n=>n.employee_ids.includes(t)?{...n,employee_ids:n.employee_ids.filter(r=>r!==t)}:{...n,employee_ids:[...n.employee_ids,t]})},$=(s,t)=>{s.stopPropagation(),k(t)},A=()=>{y(s=>{const t=u.map(r=>r.id);if(t.every(r=>s.employee_ids.includes(r)))return{...s,employee_ids:s.employee_ids.filter(r=>!t.includes(r))};{const r=s.employee_ids.filter(l=>!t.includes(l));return{...s,employee_ids:[...r,...t]}}})},I=s=>{if(s.preventDefault(),a.employee_ids.length===0){alert("Please select at least one employee");return}if(!a.original_date||!a.requested_date){alert("Please fill in all required date fields");return}if(a.original_date===a.requested_date){alert("Requested date must be different from original date");return}if(!a.reason.trim()){alert("Please provide a reason for the rest day change");return}P(a),y({employee_ids:[],original_date:f,requested_date:f,reason:""}),q(""),D(""),window.scrollTo({top:0,behavior:"smooth"})},E=s=>{if(s.name)return s.name;const t=s.Fname||"",n=s.Lname||"",r=s.MName||"";let l=n;return t&&(l+=l?", "+t:t),r&&(l+=" "+r),l||`Employee #${s.id}`},T=s=>s.department||s.Department||"",B=s=>s.position||s.Jobtitle||"",R=u.length>0&&u.every(s=>a.employee_ids.includes(s.id)),J=p.filter(s=>a.employee_ids.includes(s.id));return e.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"File Change Rest Day Request"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Create rest day change request for one or multiple employees"})]}),e.jsxs("form",{onSubmit:I,children:[e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Select Employees"}),e.jsxs("div",{className:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2 mb-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by name or ID",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:h,onChange:s=>q(s.target.value)})}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:N,onChange:s=>D(s.target.value),children:[e.jsx("option",{value:"",children:"All Departments"}),M.map((s,t)=>e.jsx("option",{value:s,children:s},t))]})}),e.jsx("div",{className:"md:flex-initial",children:e.jsx("button",{type:"button",className:`w-full px-4 py-2 rounded-md ${R?"bg-indigo-700 hover:bg-indigo-800":"bg-indigo-500 hover:bg-indigo-600"} text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`,onClick:A,children:R?"Deselect All":"Select All"})})]}),e.jsx("div",{className:"border rounded-md overflow-hidden max-h-60 overflow-y-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12",children:"Select"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:u.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-4 py-3 text-center text-sm text-gray-500",children:"No employees match your search criteria"})}):u.map(s=>e.jsxs("tr",{className:`hover:bg-gray-50 cursor-pointer ${a.employee_ids.includes(s.id)?"bg-indigo-50":""}`,onClick:()=>k(s.id),children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",checked:a.employee_ids.includes(s.id),onChange:t=>$(t,s.id),onClick:t=>t.stopPropagation()})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:s.idno||""}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:E(s)})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:T(s)}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:B(s)})]},s.id))})]})}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:a.employee_ids.length>0?e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium",children:[a.employee_ids.length," employee(s) selected"]}),a.employee_ids.length<=5&&e.jsxs("span",{className:"ml-2",children:["(",J.map(s=>E(s).split(",")[0]).join(", "),")"]})]}):e.jsx("span",{className:"text-yellow-600",children:"No employees selected"})})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Rest Day Change Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"original_date",className:"block text-sm font-medium text-gray-700 mb-1",children:["Original Rest Day ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"date",id:"original_date",name:"original_date",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:a.original_date,onChange:C,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"requested_date",className:"block text-sm font-medium text-gray-700 mb-1",children:["Requested Rest Day ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"date",id:"requested_date",name:"requested_date",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:a.requested_date,onChange:C,required:!0})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Reason for Change"}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-1",children:["Reason ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("textarea",{id:"reason",name:"reason",rows:"5",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",placeholder:"Provide a detailed reason for the rest day change request",value:a.reason,onChange:C,required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Please provide a clear justification for changing the rest day."})]})]})]}),e.jsx("div",{className:"px-4 py-3 bg-gray-50 text-right sm:px-6 border-t",children:e.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Submit Change Rest Day Request"})})]})]})};export{V as default};
