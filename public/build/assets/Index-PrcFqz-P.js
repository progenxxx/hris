import{j as e,a as je,r as m,H as fe,c as D}from"./app-D-TNKEQL.js";import{A as Ne,S as ve}from"./AuthenticatedLayout-PCqsYVxf.js";import{S as be}from"./Sidebar-Cg7Kwp5t.js";import{c as we,a as Se,B as b}from"./Button-SjHtsDzU.js";import{C as E,c as T,a as re,b as le}from"./card-qhIlbjIo.js";import"./alert-ttcl-5kV.js";import{T as _e,a as Ce,b as w,c as R}from"./tabs-o250_RDq.js";import{l as ke}from"./lodash-BVV6_chf.js";import{D as Ee}from"./download-Dnq6PCPG.js";import{F as Te}from"./file-text-QjoOwKBJ.js";import{c as ne}from"./createLucideIcon-DEWnkTLV.js";import{U as $}from"./users-Cw0U-ZsC.js";import{C as V}from"./circle-check-big-BKozuvyq.js";import{C as F}from"./circle-x-Ty60vMKt.js";import{C as Fe}from"./clock-D8g538AG.js";import{S as Le}from"./search-DZDiwkir.js";import{R as H}from"./refresh-cw-BgXuErF8.js";import{C as De}from"./calendar-DhTYrr3L.js";import{E as Oe}from"./eye-Do6ZODZZ.js";import{T as Pe}from"./trending-up-B4smPj0N.js";import{C as Ae}from"./circle-alert-DRTaAOqF.js";import"./ApplicationLogo-Cn-MbvX-.js";import"./Dropdown-BOoMuW7P.js";import"./transition-DeCEAfJ2.js";import"./x-fQrOvEob.js";/* empty css                */import"./clsx-B-dksMZM.js";import"./index-CC88eXid.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=ne("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=ne("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Me=Se("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function P({className:y,variant:c,...i}){return e.jsx("div",{className:we(Me({variant:c}),y),...i})}const Re=({message:y,type:c,onClose:i})=>{m.useEffect(()=>{const j=setTimeout(()=>{i()},5e3);return()=>clearTimeout(j)},[i]);const a=c==="success"?"bg-green-50 border-green-200":c==="error"?"bg-red-50 border-red-200":"bg-yellow-50 border-yellow-200",x=c==="success"?"text-green-700":c==="error"?"text-red-700":"text-yellow-700",d=c==="success"?e.jsx(V,{className:"h-5 w-5 text-green-500"}):c==="error"?e.jsx(F,{className:"h-5 w-5 text-red-500"}):e.jsx(Ae,{className:"h-5 w-5 text-yellow-500"});return e.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-center p-4 mb-4 rounded-lg shadow-md border ${a}`,children:[e.jsx("div",{className:"inline-flex items-center justify-center flex-shrink-0 w-8 h-8 rounded-lg",children:d}),e.jsx("div",{className:`ml-3 text-sm font-normal ${x}`,children:y}),e.jsx("button",{type:"button",className:`ml-auto -mx-1.5 -my-1.5 rounded-lg focus:ring-2 p-1.5 inline-flex h-8 w-8 ${x} hover:bg-gray-100`,onClick:i,children:e.jsx(F,{className:"w-5 h-5"})})]})},O=({icon:y,title:c,value:i,subtitle:a,trend:x,color:d="indigo"})=>e.jsx(E,{className:"border-t-4",style:{borderTopColor:`var(--${d}-500)`},children:e.jsxs(T,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 mb-1",children:c}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i}),a&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:a})]}),e.jsx("div",{className:`p-3 rounded-full bg-${d}-100`,children:y})]}),x&&e.jsxs("div",{className:"flex items-center mt-4",children:[x.direction==="up"?e.jsx(Pe,{className:"h-4 w-4 text-green-500 mr-1"}):e.jsx(Ie,{className:"h-4 w-4 text-red-500 mr-1"}),e.jsxs("span",{className:`text-sm ${x.direction==="up"?"text-green-700":"text-red-700"}`,children:[x.value," from last period"]})]})]})}),$e=({isOpen:y,onClose:c,onSync:i,employees:a,isLoading:x})=>{const[d,j]=m.useState({create_missing:!0,update_existing:!1,include_schedules:!0,include_attendance:!0}),[u,p]=m.useState([]),f=()=>{u.length===a.length?p([]):p(a.map(l=>l.id))},z=l=>{p(n=>n.includes(l)?n.filter(U=>U!==l):[...n,l])},A=()=>{if(u.length===0){alert("Please select at least one employee to sync.");return}i(u,d)};return console.log("SyncOptionsModal render:",{isOpen:y,employeesLength:a.length,isLoading:x}),y?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Sync Payroll Data"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Sync Options"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.create_missing,onChange:l=>j(n=>({...n,create_missing:l.target.checked})),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("span",{className:"text-sm",children:"Create missing payroll summaries"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.update_existing,onChange:l=>j(n=>({...n,update_existing:l.target.checked})),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("span",{className:"text-sm",children:"Update existing summaries"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.include_schedules,onChange:l=>j(n=>({...n,include_schedules:l.target.checked})),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("span",{className:"text-sm",children:"Include schedule data"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.include_attendance,onChange:l=>j(n=>({...n,include_attendance:l.target.checked})),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("span",{className:"text-sm",children:"Include enhanced attendance data"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Select Employees"}),e.jsx(b,{type:"button",variant:"outline",size:"sm",onClick:f,children:u.length===a.length?"Deselect All":"Select All"})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg max-h-60 overflow-y-auto",children:a.length===0?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No employees found"}):e.jsx("div",{className:"p-2",children:a.map(l=>{var n;return e.jsxs("label",{className:"flex items-center space-x-3 py-2 px-2 hover:bg-gray-50 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.includes(l.id),onChange:()=>z(l.id),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[l.Fname," ",l.Lname]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[l.idno," - ",l.Department]})]}),e.jsxs("div",{className:"text-xs text-gray-400",children:[((n=l.employeeSchedules)==null?void 0:n.length)||0," schedules"]})]},l.id)})})}),u.length>0&&e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[u.length," employee",u.length!==1?"s":""," selected"]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(b,{type:"button",variant:"outline",onClick:c,disabled:x,children:"Cancel"}),e.jsx(b,{onClick:A,disabled:u.length===0||x,className:"bg-indigo-600 hover:bg-indigo-700",children:x?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-4 w-4 mr-2 animate-spin"}),"Syncing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Sync Data"]})})]})]})]})}):null},Ve=({isOpen:y,onClose:c,employee:i,employeeDetails:a,isLoading:x})=>{var d,j,u;return!y||!i?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold",children:["Employee Sync Details: ",i.Fname," ",i.Lname]}),e.jsx(b,{variant:"outline",onClick:c,children:e.jsx(F,{className:"h-4 w-4"})})]}),x?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(H,{className:"h-8 w-8 animate-spin text-indigo-600 mr-3"}),e.jsx("span",{className:"text-gray-600",children:"Loading employee details..."})]}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(E,{children:[e.jsx(re,{children:e.jsx(le,{className:"text-lg",children:"Employee Information"})}),e.jsx(T,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"ID:"}),e.jsx("p",{className:"font-medium",children:i.idno})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Department:"}),e.jsx("p",{className:"font-medium",children:i.Department})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Job Title:"}),e.jsx("p",{className:"font-medium",children:i.Jobtitle||"N/A"})]})]})})]}),e.jsxs(E,{children:[e.jsx(re,{children:e.jsx(le,{className:"text-lg",children:"Payroll Summary"})}),e.jsx(T,{children:a.payroll_summary?e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Days Worked:"}),e.jsx("p",{className:"font-medium",children:a.payroll_summary.days_worked})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"OT Hours:"}),e.jsx("p",{className:"font-medium",children:a.payroll_summary.ot_hours})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"SLVL Days:"}),e.jsx("p",{className:"font-medium",children:a.payroll_summary.slvl_days})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Status:"}),e.jsx(P,{variant:a.payroll_summary.status==="posted"?"success":"default",children:a.payroll_summary.status})]})]}):e.jsx("p",{className:"text-gray-500 italic",children:"No payroll summary found for this period"})})]}),e.jsxs(_e,{defaultValue:"schedules",className:"space-y-4",children:[e.jsxs(Ce,{className:"grid w-full grid-cols-8",children:[e.jsx(w,{value:"schedules",children:"Schedules"}),e.jsx(w,{value:"overtime",children:"Overtime"}),e.jsx(w,{value:"slvl",children:"SLVL"}),e.jsx(w,{value:"offsets",children:"Offsets"}),e.jsx(w,{value:"travel",children:"Travel Orders"}),e.jsx(w,{value:"retros",children:"Retros"}),e.jsx(w,{value:"schedule_changes",children:"Schedule Changes"}),e.jsx(w,{value:"attendance",children:"Attendance"})]}),e.jsx(R,{value:"schedules",className:"space-y-4",children:((d=a.employee.employeeSchedules)==null?void 0:d.length)>0?e.jsx("div",{className:"grid gap-4",children:a.employee.employeeSchedules.map((p,f)=>e.jsx(E,{children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:p.formatted_work_day}),e.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",p.shift_type_label,")"]})]}),e.jsx("div",{className:"text-sm",children:p.formatted_work_time})]})})},f))}):e.jsx("p",{className:"text-gray-500 italic",children:"No schedules found for this period"})}),e.jsx(R,{value:"overtime",className:"space-y-4",children:((u=(j=a.related_data)==null?void 0:j.overtime)==null?void 0:u.length)>0?e.jsx("div",{className:"space-y-4",children:a.related_data.overtime.map((p,f)=>e.jsx(E,{children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:p.date}),e.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:[p.total_hours," hours"]})]}),e.jsx(P,{variant:p.status==="approved"?"success":p.status==="rejected"?"destructive":"default",children:p.status})]})})},f))}):e.jsx("p",{className:"text-gray-500 italic",children:"No overtime records found for this period"})}),e.jsx(R,{value:"attendance",className:"space-y-4",children:a.attendance_summary?e.jsx(E,{children:e.jsx(T,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Total Records:"}),e.jsx("p",{className:"text-2xl font-bold",children:a.attendance_summary.total_records})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Days Present:"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:a.attendance_summary.days_present})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Days Absent:"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:a.attendance_summary.days_absent})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Hours Worked:"}),e.jsx("p",{className:"text-2xl font-bold",children:a.attendance_summary.total_hours_worked})]})]})})}):e.jsx("p",{className:"text-gray-500 italic",children:"No attendance data found for this period"})})]})]}):e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Failed to load employee details"})]})})},js=()=>{var Y,Q,Z,ee,se,te;const{auth:y,employees:c,payrollSummaries:i,syncStats:a,departments:x,filters:d,periodInfo:j,availableYears:u,availableMonths:p}=je().props,[f,z]=m.useState(c||[]),[A,l]=m.useState(i||{}),[n,U]=m.useState(a||{}),[r,He]=m.useState(d),[_,C]=m.useState(!1);console.log("PayrollScheduleIntegration Debug:",{initialEmployees:c,employeesCount:(c||[]).length,employeesWithSchedules:(c||[]).filter(s=>{var t;return((t=s.employeeSchedules)==null?void 0:t.length)>0}).length,sampleEmployee:(c||[])[0],filters:d});const[ie,I]=m.useState(!1),[q,B]=m.useState(!1),[de,oe]=m.useState(null),[G,W]=m.useState(null),[ze,Ue]=m.useState(!1),[X,K]=m.useState(d.search||""),[M,J]=m.useState({visible:!1,message:"",type:"success"}),N=(s,t="success")=>{J({visible:!0,message:s,type:t})},me=()=>{J(s=>({...s,visible:!1}))},S=m.useCallback(s=>{try{C(!0);const t=Object.fromEntries(Object.entries(s).filter(([g,o])=>o!=null&&o!==""));window.location.href=`/payroll-schedule-integration?${new URLSearchParams(t).toString()}`}catch(t){console.error("Error applying filters:",t),N("Failed to apply filters","error"),C(!1)}},[]),xe=m.useCallback(ke.debounce(s=>{const t={...r,search:s||null};S(t)},500),[r,S]),he=s=>{const t=s.target.value;K(t),xe(t)},pe=async(s,t)=>{var g,o,h,v,ae;console.log("handleSyncData called:",{employeeIds:s,syncOptions:t,filters:r});try{C(!0);const L=(g=document.querySelector('meta[name="csrf-token"]'))==null?void 0:g.getAttribute("content"),k=await D.post("/payroll-schedule-integration/sync",{year:parseInt(r.year),month:parseInt(r.month),period_type:r.period_type,employee_ids:s,sync_options:t},{headers:{"X-CSRF-TOKEN":L,"Content-Type":"application/json",Accept:"application/json"}});console.log("Sync response:",k.data),k.data.success?(N(k.data.message,"success"),I(!1),window.location.reload()):N(k.data.message||"Sync failed","error")}catch(L){console.error("Error syncing data:",L);const k=((h=(o=L.response)==null?void 0:o.data)==null?void 0:h.message)||((ae=(v=L.response)==null?void 0:v.data)==null?void 0:ae.errors)||"Failed to sync data";N(k,"error")}finally{C(!1)}},ue=async s=>{var t,g,o;try{oe(s),B(!0),W(null);const h=(t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"),v=await D.get(`/payroll-schedule-integration/employee/${s.id}/details`,{params:{year:parseInt(r.year),month:parseInt(r.month),period_type:r.period_type},headers:{"X-CSRF-TOKEN":h,Accept:"application/json"}});console.log("Employee details response:",v.data),v.data.success?W(v.data.data):N("Failed to load employee details","error")}catch(h){console.error("Error loading employee details:",h);const v=((o=(g=h.response)==null?void 0:g.data)==null?void 0:o.message)||"Failed to load employee details";N(v,"error")}},ge=async()=>{var s,t,g;if(confirm("Generate payroll summaries for all employees without existing records?"))try{C(!0);const o=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"),h=await D.post("/payroll-schedule-integration/generate",{year:parseInt(r.year),month:parseInt(r.month),period_type:r.period_type,department:r.department||null,force_regenerate:!1},{headers:{"X-CSRF-TOKEN":o,"Content-Type":"application/json",Accept:"application/json"}});h.data.success?(N(h.data.message,"success"),window.location.reload()):N(h.data.message||"Generation failed","error")}catch(o){console.error("Error generating payroll:",o);const h=((g=(t=o.response)==null?void 0:t.data)==null?void 0:g.message)||"Failed to generate payroll summaries";N(h,"error")}finally{C(!1)}},ye=async()=>{try{(await D.post("/payroll-schedule-integration/export",{year:r.year,month:r.month,period_type:r.period_type,department:r.department,format:"xlsx"})).data.success&&N("Export completed successfully","success")}catch(s){console.error("Error exporting data:",s),N("Failed to export data","error")}};return e.jsxs(Ne,{user:y.user,children:[e.jsx(fe,{title:"Payroll Schedule Integration"}),e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsx(be,{}),e.jsx("div",{className:"flex-1 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[M.visible&&e.jsx(Re,{message:M.message,type:M.type,onClose:me}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 mb-1 flex items-center",children:[e.jsx(ve,{className:"h-6 w-6 mr-2 text-indigo-600"}),"Payroll Schedule Integration"]}),e.jsxs("p",{className:"text-gray-600",children:["Sync employee schedules with payroll data for ",j.month_name," (",j.label,")"]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(b,{onClick:ye,variant:"outline",className:"shadow-sm",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsxs(b,{onClick:ge,variant:"outline",className:"shadow-sm",disabled:_,children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Generate Payroll"]}),e.jsxs(b,{onClick:()=>{console.log("Sync Data button clicked",{employeesLength:f.length,isLoading:_}),I(!0)},className:"bg-indigo-600 hover:bg-indigo-700 shadow-sm",disabled:_||f.length===0,children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Sync Data"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsx(O,{icon:e.jsx($,{className:"h-5 w-5 text-indigo-600"}),title:"Total Employees",value:((Y=n.employees)==null?void 0:Y.total)||0,subtitle:`${((Q=n.employees)==null?void 0:Q.with_schedules)||0} with schedules`,color:"indigo"}),e.jsx(O,{icon:e.jsx(V,{className:"h-5 w-5 text-green-600"}),title:"With Payroll Data",value:((Z=n.employees)==null?void 0:Z.with_payroll)||0,subtitle:`${((((ee=n.employees)==null?void 0:ee.with_payroll)||0)/(((se=n.employees)==null?void 0:se.total)||1)*100).toFixed(1)}% coverage`,color:"green"}),e.jsx(O,{icon:e.jsx(F,{className:"h-5 w-5 text-red-600"}),title:"Missing Payroll",value:((te=n.employees)==null?void 0:te.missing_payroll)||0,subtitle:"Need generation",color:"red"}),e.jsx(O,{icon:e.jsx(Fe,{className:"h-5 w-5 text-yellow-600"}),title:"Related Records",value:Object.values(n.related_data||{}).reduce((s,t)=>s+t,0),subtitle:"OT, SLVL, Travel, etc.",color:"yellow"})]}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 mb-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Search employees by name, ID, department, or job title...",value:X,onChange:he,className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}),X&&e.jsx("button",{onClick:()=>{K("");const s={...r,search:null};S(s)},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(F,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("select",{value:r.year,onChange:s=>S({...r,year:s.target.value}),className:"px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",children:u.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("select",{value:r.month,onChange:s=>S({...r,month:s.target.value}),className:"px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",children:p.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),e.jsxs("select",{value:r.period_type,onChange:s=>S({...r,period_type:s.target.value}),className:"px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"1st_half",children:"1st Half (1-15)"}),e.jsx("option",{value:"2nd_half",children:"2nd Half (16-End)"})]})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{value:r.department||"",onChange:s=>S({...r,department:s.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"All Departments"}),x.map(s=>e.jsx("option",{value:s,children:s},s))]})}),e.jsxs(b,{variant:"outline",onClick:()=>window.location.reload(),disabled:_,children:[e.jsx(H,{className:`h-4 w-4 mr-2 ${_?"animate-spin":""}`}),"Refresh"]})]})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Employee Schedule & Payroll Status"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Schedules"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payroll Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Sync"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:"6",className:"px-6 py-12 text-center text-gray-500",children:[e.jsx($,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium",children:"No employees found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters"})]})}):f.map(s=>{var o,h,v;const t=A[s.id],g=s.schedule_count||((o=s.employeeSchedules)==null?void 0:o.length)||((h=s.employee_schedules)==null?void 0:h.length)||((v=s.schedules)==null?void 0:v.length)||0;return console.log("Employee Debug:",{id:s.id,name:`${s.Fname} ${s.Lname}`,employeeSchedules:s.employeeSchedules,scheduleCount:g,allProperties:Object.keys(s)}),e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:e.jsx($,{className:"h-5 w-5 text-indigo-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.Fname," ",s.Lname]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",s.idno]})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:s.Department}),e.jsx("div",{className:"text-sm text-gray-500",children:s.Line})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(De,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[g," schedule",g!==1?"s":""]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t?e.jsxs(P,{variant:"success",children:[e.jsx(V,{className:"h-3 w-3 mr-1"}),t.status]}):e.jsxs(P,{variant:"destructive",children:[e.jsx(F,{className:"h-3 w-3 mr-1"}),"Missing"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t!=null&&t.updated_at?new Date(t.updated_at).toLocaleDateString():"Never"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>ue(s),className:"mr-2",children:[e.jsx(Oe,{className:"h-4 w-4 mr-1"}),"View"]})})]},s.id)})})]})})]}),e.jsx($e,{isOpen:ie,onClose:()=>I(!1),onSync:pe,employees:f,isLoading:_}),e.jsx(Ve,{isOpen:q,onClose:()=>B(!1),employee:de,employeeDetails:G,isLoading:!G&&q})]})})]})]})};export{js as default};
