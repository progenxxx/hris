import{a as pe,r as o,c as B,j as e,H as he}from"./app-7K62fd2B.js";import{A as ge}from"./AuthenticatedLayout-DQzQmHv9.js";import{S as fe}from"./Sidebar-Bpho9Ubl.js";import{B as P}from"./Button-B-ixrUdq.js";import"./alert-Cw6Swk3l.js";import{l as be}from"./lodash-DtN3SqvZ.js";import{M as ee}from"./Modal-Cmmxf1Wx.js";import{C as je}from"./ConfirmModal-C6XdrbgL.js";import{P as ve}from"./plus-DDuyej1g.js";import{S as J}from"./search-BmV-knWW.js";import{X as Q}from"./x-4sBMcqny.js";import{C as K}from"./circle-check-big-CdHds-fH.js";import{C as ye}from"./clock-r6FcyLKi.js";import{T as Ne}from"./triangle-alert-BFKAbd31.js";import{F as we}from"./file-text-B0cEX_Vi.js";import{S as se}from"./save-BqIq9Yvz.js";import{C as Ce}from"./check-BTfeYE2Q.js";import{C as Se}from"./circle-x-2rCUmP_B.js";import"./ApplicationLogo-IpRttWhS.js";import"./Dropdown-Yo6Rw43S.js";import"./transition-Di9UDWSH.js";import"./createLucideIcon-BK5csKvN.js";/* empty css                */import"./users-D-OfZtV9.js";import"./calendar-CWo9dUpk.js";import"./clsx-B-dksMZM.js";import"./index-DnL5dnpl.js";const ke=({message:u,type:N,onClose:a})=>{o.useEffect(()=>{const y=setTimeout(()=>{a()},3e3);return()=>clearTimeout(y)},[a]);const t=N==="success"?"bg-green-50 border-green-200":"bg-red-50 border-red-200",h=N==="success"?"text-green-700":"text-red-700",m=N==="success"?e.jsx(Ce,{className:"h-5 w-5 text-green-500"}):e.jsx(Se,{className:"h-5 w-5 text-red-500"});return e.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-center p-4 mb-4 rounded-lg shadow-md border ${t}`,role:"alert",children:[e.jsx("div",{className:"inline-flex items-center justify-center flex-shrink-0 w-8 h-8 rounded-lg",children:m}),e.jsx("div",{className:`ml-3 text-sm font-normal ${h}`,children:u}),e.jsx("button",{type:"button",className:`ml-auto -mx-1.5 -my-1.5 rounded-lg focus:ring-2 p-1.5 inline-flex h-8 w-8 ${h} hover:bg-gray-100`,onClick:a,"aria-label":"Close",children:e.jsx(Q,{className:"w-5 h-5"})})]})},te=({status:u})=>u==="resolved"||u==="closed"?e.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(K,{className:"w-3 h-3 mr-1"}),u.charAt(0).toUpperCase()+u.slice(1)]}):u==="investigation"?e.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[e.jsx(ye,{className:"w-3 h-3 mr-1"}),"Investigation"]}):e.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[e.jsx(Ne,{className:"w-3 h-3 mr-1"}),"Open"]}),X=({isOpen:u,onClose:N,title:a,complaint:t,employees:h,users:m,onChange:y,onFileChange:V,onSubmit:I,mode:R="create",errorMessages:d={}})=>{const g=R==="view",[_,C]=o.useState(""),[S,O]=o.useState(""),[x,$]=o.useState([]),[n,k]=o.useState([]);return o.useEffect(()=>{if(!Array.isArray(h)){$([]);return}if(!_.trim()){$(h);return}const s=_.toLowerCase(),j=h.filter(f=>{const i=(f.Fname||"").toLowerCase(),p=(f.Lname||"").toLowerCase(),L=(f.idno||"").toLowerCase(),U=`${i} ${p}`.toLowerCase(),D=`${p} ${i}`.toLowerCase();return i.includes(s)||p.includes(s)||L.includes(s)||U.includes(s)||D.includes(s)});$(j)},[_,h]),o.useEffect(()=>{if(!_.trim()||!Array.isArray(x)||x.length===0)return;const s=_.toLowerCase(),j=x.find(f=>{const i=(f.Fname||"").toLowerCase(),p=(f.Lname||"").toLowerCase(),L=(f.idno||"").toLowerCase(),U=`${i} ${p}`.toLowerCase(),D=`${p} ${i}`.toLowerCase(),q=`${p}, ${i} (${L})`.toLowerCase();return i===s||p===s||L===s||U===s||D===s||q===s});j&&j.id!==t.employee_id&&y({...t,employee_id:j.id})},[_,x,t.employee_id,y]),o.useEffect(()=>{if(!Array.isArray(h)){k([]);return}if(!S.trim()){k(h);return}const s=S.toLowerCase(),j=h.filter(f=>{const i=(f.Fname||"").toLowerCase(),p=(f.Lname||"").toLowerCase(),L=(f.idno||"").toLowerCase(),U=`${i} ${p}`.toLowerCase(),D=`${p} ${i}`.toLowerCase();return i.includes(s)||p.includes(s)||L.includes(s)||U.includes(s)||D.includes(s)});k(j)},[S,h]),o.useEffect(()=>{if(!S.trim()||!Array.isArray(n)||n.length===0)return;const s=S.toLowerCase(),j=n.find(f=>{const i=(f.Fname||"").toLowerCase(),p=(f.Lname||"").toLowerCase(),L=(f.idno||"").toLowerCase(),U=`${i} ${p}`.toLowerCase(),D=`${p} ${i}`.toLowerCase(),q=`${p}, ${i} (${L})`.toLowerCase();return i===s||p===s||L===s||U===s||D===s||q===s});j&&j.id!==t.complainant_id&&y({...t,complainant_id:j.id})},[S,n,t.complainant_id,y]),o.useEffect(()=>{u&&(C(""),O(""),$(h||[]),k(h||[]))},[u,h]),e.jsx(ee,{show:u,onClose:N,maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:a}),e.jsx("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-gray-500",children:e.jsx(Q,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee (Against)"}),g?e.jsx("div",{className:"p-2 border rounded bg-gray-50",children:t.employee?`${t.employee.Lname||""}, ${t.employee.Fname||""} ${t.employee.idno?`(${t.employee.idno})`:""}`:"Unknown Employee"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(J,{className:"h-4 w-4 text-gray-400"})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Search employee by name or ID...",value:_,onChange:s=>C(s.target.value)}),t.employee_id&&x.length>0&&x.find(s=>s.id===t.employee_id)&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx(K,{className:"h-4 w-4 text-green-500"})})]}),e.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[x.length===0?"No matching employees found":x.length===1?"1 employee found":`${x.length} employees found`,t.employee_id&&x.find(s=>s.id===t.employee_id)&&" - Employee selected"]}),e.jsxs("select",{className:`w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent ${d.employee_id?"border-red-500":""}`,value:t.employee_id||"",onChange:s=>y({...t,employee_id:s.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select Employee"}),Array.isArray(x)&&x.length>0?x.map(s=>e.jsxs("option",{value:s.id,children:[s.Lname||"",", ",s.Fname||""," ",s.idno?`(${s.idno})`:""]},s.id||`emp-${Math.random()}`)):_?e.jsx("option",{value:"",disabled:!0,children:"No matching employees found"}):e.jsx("option",{value:"",disabled:!0,children:"No employees available"})]})]}),d.employee_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.employee_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complainant (Filed By)"}),g?e.jsx("div",{className:"p-2 border rounded bg-gray-50",children:t.complainant?`${t.complainant.Lname||""}, ${t.complainant.Fname||""} ${t.complainant.idno?`(${t.complainant.idno})`:""}`:"Unknown Employee"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(J,{className:"h-4 w-4 text-gray-400"})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Search complainant by name or ID...",value:S,onChange:s=>O(s.target.value)}),t.complainant_id&&n.length>0&&n.find(s=>s.id===t.complainant_id)&&e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx(K,{className:"h-4 w-4 text-green-500"})})]}),e.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[n.length===0?"No matching employees found":n.length===1?"1 employee found":`${n.length} employees found`,t.complainant_id&&n.find(s=>s.id===t.complainant_id)&&" - Complainant selected"]}),e.jsxs("select",{className:`w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent ${d.complainant_id?"border-red-500":""}`,value:t.complainant_id||"",onChange:s=>y({...t,complainant_id:s.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select Complainant"}),Array.isArray(n)&&n.length>0?n.map(s=>e.jsxs("option",{value:s.id,children:[s.Lname||"",", ",s.Fname||""," ",s.idno?`(${s.idno})`:""]},s.id||`emp-${Math.random()}`)):S?e.jsx("option",{value:"",disabled:!0,children:"No matching employees found"}):e.jsx("option",{value:"",disabled:!0,children:"No employees available"})]})]}),d.complainant_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.complainant_id})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complaint Title"}),g?e.jsx("div",{className:"p-2 border rounded bg-gray-50",children:t.complaint_title||""}):e.jsx("input",{type:"text",className:`w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent ${d.complaint_title?"border-red-500":""}`,value:t.complaint_title||"",onChange:s=>y({...t,complaint_title:s.target.value}),placeholder:"e.g. Unprofessional Behavior",required:!0}),d.complaint_title&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.complaint_title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complaint Description"}),g?e.jsx("div",{className:"p-2 border rounded bg-gray-50 whitespace-pre-line min-h-[100px]",children:t.complaint_description||""}):e.jsx("textarea",{className:`w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent ${d.complaint_description?"border-red-500":""}`,value:t.complaint_description||"",onChange:s=>y({...t,complaint_description:s.target.value}),placeholder:"Detailed description of the complaint...",rows:"4",required:!0}),d.complaint_description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.complaint_description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complaint Date"}),g?e.jsx("div",{className:"p-2 border rounded bg-gray-50",children:t.complaint_date?new Date(t.complaint_date).toLocaleDateString():""}):e.jsx("input",{type:"date",className:`w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent ${d.complaint_date?"border-red-500":""}`,value:t.complaint_date||"",onChange:s=>y({...t,complaint_date:s.target.value}),required:!0}),d.complaint_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.complaint_date})]}),!g&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supporting Document"}),e.jsx("input",{type:"file",className:`w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent ${d.document?"border-red-500":""}`,onChange:s=>V(s.target.files[0])}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Upload supporting documents (PDF, DOC, JPG, PNG)"}),d.document&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.document})]}),g&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("div",{className:"mt-1",children:e.jsx(te,{status:t.status})})]}),t.assigned_to&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned To"}),e.jsx("div",{className:"mt-1 text-sm text-gray-900",children:t.assignedTo?t.assignedTo.name:"Not Assigned"})]}),t.document_path&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supporting Document"}),e.jsxs("a",{href:`/storage/${t.document_path}`,target:"_blank",className:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"View Document"]})]}),t.resolution&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Resolution"}),e.jsx("div",{className:"mt-1 text-sm text-gray-900 whitespace-pre-line p-2 border rounded bg-gray-50",children:t.resolution})]}),t.resolution_date&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Resolution Date"}),e.jsx("div",{className:"mt-1 text-sm text-gray-900",children:new Date(t.resolution_date).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx(P,{type:"button",variant:"outline",onClick:()=>N(!1),className:"mr-2",children:g?"Close":"Cancel"}),!g&&e.jsxs(P,{type:"submit",className:"bg-blue-600 text-white hover:bg-blue-700",children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),R==="create"?"Save Complaint":"Update Complaint"]})]})]})]})})},_e=({isOpen:u,onClose:N,complaint:a,users:t,onSubmit:h})=>{var S,O,x,$;const[m,y]=o.useState((a==null?void 0:a.status)||"open"),[V,I]=o.useState((a==null?void 0:a.assigned_to)||""),[R,d]=o.useState((a==null?void 0:a.resolution)||""),[g,_]=o.useState((a==null?void 0:a.resolution_date)||"");o.useEffect(()=>{u&&(y((a==null?void 0:a.status)||"open"),I((a==null?void 0:a.assigned_to)||""),d((a==null?void 0:a.resolution)||""),_((a==null?void 0:a.resolution_date)||""))},[u,a]);const C=n=>{n.preventDefault(),h({status:m,assigned_to:V,resolution:m==="resolved"||m==="closed"?R:"",resolution_date:m==="resolved"||m==="closed"?g:null})};return e.jsx(ee,{show:u,onClose:N,maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Update Complaint Status"}),e.jsx("button",{onClick:N,className:"text-gray-400 hover:text-gray-500",children:e.jsx(Q,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complaint Title"}),e.jsx("div",{className:"p-2 border rounded bg-gray-50",children:a==null?void 0:a.complaint_title})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee"}),e.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[(S=a==null?void 0:a.employee)==null?void 0:S.Fname," ",(O=a==null?void 0:a.employee)==null?void 0:O.Lname]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complainant"}),e.jsxs("div",{className:"p-2 border rounded bg-gray-50",children:[(x=a==null?void 0:a.complainant)==null?void 0:x.Fname," ",($=a==null?void 0:a.complainant)==null?void 0:$.Lname]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:m,onChange:n=>y(n.target.value),required:!0,children:[e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"investigation",children:"Under Investigation"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"closed",children:"Closed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned To"}),e.jsxs("select",{className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:V,onChange:n=>I(n.target.value),children:[e.jsx("option",{value:"",children:"Not Assigned"}),t.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),(m==="resolved"||m==="closed")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Resolution"}),e.jsx("textarea",{className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:R,onChange:n=>d(n.target.value),placeholder:"Describe how the complaint was resolved...",rows:"3",required:m==="resolved"||m==="closed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Resolution Date"}),e.jsx("input",{type:"date",className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:g,onChange:n=>_(n.target.value),required:m==="resolved"||m==="closed"})]})]}),e.jsxs("div",{className:"flex justify-end mt-6",children:[e.jsx(P,{type:"button",variant:"outline",onClick:N,className:"mr-2",children:"Cancel"}),e.jsxs(P,{type:"submit",className:"bg-blue-600 text-white hover:bg-blue-700",children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Update Status"]})]})]})]})})},ss=()=>{const{auth:u}=pe().props;u!=null&&u.user;const[N,a]=o.useState([]),[t,h]=o.useState([]),[m,y]=o.useState([]),[V,I]=o.useState(!0),[R,d]=o.useState(""),[g,_]=o.useState("all"),[C,S]=o.useState({from:"",to:""}),[O,x]=o.useState({visible:!1,message:"",type:"success"}),$={employee_id:"",complainant_id:"",complaint_title:"",complaint_description:"",complaint_date:"",document_path:null},[n,k]=o.useState($),[s,j]=o.useState(null),[f,i]=o.useState({}),[p,L]=o.useState(!1),[U,D]=o.useState(!1),[q,Y]=o.useState(!1),[ae,H]=o.useState(!1),[M,z]=o.useState({isOpen:!1,title:"",message:"",confirmText:"",confirmVariant:"destructive",onConfirm:()=>{}}),W=o.useCallback(async()=>{var r,c,v,b,F,A;I(!0);try{let w=[],l=[],G=[];try{w=(await B.get("/complaints/list",{params:{search:R,status:g!=="all"?g:null,date_from:C.from||null,date_to:C.to||null}})).data.data||[]}catch(E){console.error("Error loading complaints:",E),T("Error loading complaints: "+(((c=(r=E.response)==null?void 0:r.data)==null?void 0:c.message)||E.message),"error")}try{l=(await B.get("/employees/list",{params:{active_only:!0}})).data.data||[]}catch(E){console.error("Error loading employees:",E),T("Error loading employees: "+(((b=(v=E.response)==null?void 0:v.data)==null?void 0:b.message)||E.message),"error")}try{G=(await B.get("/users/list")).data.data||[]}catch(E){console.error("Error loading users:",E),console.warn("Users data not available. Some features may be limited."),G=[]}a(w),h(l),y(G)}catch(w){console.error("Error in loadData:",w),T("Error loading data: "+(((A=(F=w.response)==null?void 0:F.data)==null?void 0:A.message)||w.message),"error")}finally{I(!1)}},[R,g,C]);o.useEffect(()=>{W()},[W]);const T=(r,c="success")=>{x({visible:!0,message:r,type:c})},re=()=>{x({...O,visible:!1})},ne=be.debounce(r=>{d(r)},300),oe=()=>{k($),j(null),i({}),L(!0)},le=r=>{k({...r}),j(null),i({}),D(!0)},ie=r=>{k({...r}),Y(!0)},de=r=>{k({...r}),H(!0)},Z=r=>{j(r)},ce=async r=>{var v,b,F,A,w;r.preventDefault(),i({});const c=new FormData;for(const l in n)n[l]!==null&&n[l]!==void 0&&c.append(l,n[l]);s&&c.append("document",s);try{const l=await B.post("/complaints",c,{headers:{"Content-Type":"multipart/form-data"}});await W(),k($),j(null),L(!1),T("Complaint created successfully")}catch(l){console.error("Error creating complaint:",l),((v=l.response)==null?void 0:v.status)===422&&((F=(b=l.response)==null?void 0:b.data)!=null&&F.errors)?i(l.response.data.errors):T(((w=(A=l.response)==null?void 0:A.data)==null?void 0:w.message)||"Error creating complaint","error")}},me=async r=>{var v,b,F,A,w;r.preventDefault(),i({});const c=new FormData;for(const l in n)n[l]!==null&&n[l]!==void 0&&c.append(l,n[l]);s&&c.append("document",s),c.append("_method","PUT");try{const l=await B.post(`/complaints/${n.id}`,c,{headers:{"Content-Type":"multipart/form-data"}});await W(),k($),j(null),D(!1),T("Complaint updated successfully")}catch(l){console.error("Error updating complaint:",l),((v=l.response)==null?void 0:v.status)===422&&((F=(b=l.response)==null?void 0:b.data)!=null&&F.errors)?i(l.response.data.errors):T(((w=(A=l.response)==null?void 0:A.data)==null?void 0:w.message)||"Error updating complaint","error")}},ue=async r=>{var c,v;try{const b=await B.post(`/complaints/${n.id}/status`,r);await W(),H(!1),T("Complaint status updated successfully")}catch(b){console.error("Error updating complaint status:",b),T(((v=(c=b.response)==null?void 0:c.data)==null?void 0:v.message)||"Error updating complaint status","error")}},xe=r=>{z({isOpen:!0,title:"Delete Complaint",message:`Are you sure you want to delete this complaint "${r.complaint_title}"? This action cannot be undone.`,confirmText:"Delete",confirmVariant:"destructive",onConfirm:async()=>{var c,v;try{await B.delete(`/complaints/${r.id}`),await W(),z({...M,isOpen:!1}),T("Complaint deleted successfully")}catch(b){console.error("Error deleting complaint:",b),z({...M,isOpen:!1}),T(((v=(c=b.response)==null?void 0:c.data)==null?void 0:v.message)||"Error deleting complaint","error")}}})};return e.jsxs(ge,{children:[e.jsx(he,{title:"Complaints Management"}),e.jsxs("div",{className:"flex min-h-screen bg-gray-50/50",children:[e.jsx(fe,{}),e.jsx("div",{className:"flex-1 p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[O.visible&&e.jsx(ke,{message:O.message,type:O.type,onClose:re}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Complaints Management"}),e.jsx("p",{className:"text-gray-600",children:"Track and manage employee complaints and grievances."})]}),e.jsxs(P,{onClick:oe,className:"px-6 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200 flex items-center",children:[e.jsx(ve,{className:"w-5 h-5 mr-2"}),"New Complaint"]})]}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(J,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Search by title or description...",onChange:r=>ne(r.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:g,onChange:r=>_(r.target.value),children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"investigation",children:"Under Investigation"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"closed",children:"Closed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complaint Date"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{children:e.jsx("input",{type:"date",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:C.from,onChange:r=>S({...C,from:r.target.value}),placeholder:"From"})}),e.jsx("div",{children:e.jsx("input",{type:"date",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:C.to,onChange:r=>S({...C,to:r.target.value}),placeholder:"To"})})]})]})]})}),e.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-7 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:[e.jsx("div",{className:"px-6 py-3 col-span-1",children:"Actions"}),e.jsx("div",{className:"px-6 py-3 col-span-1",children:"Status"}),e.jsx("div",{className:"px-6 py-3 col-span-1",children:"Date"}),e.jsx("div",{className:"px-6 py-3 col-span-1",children:"Employee"}),e.jsx("div",{className:"px-6 py-3 col-span-1",children:"Complainant"}),e.jsx("div",{className:"px-6 py-3 col-span-1",children:"Title"}),e.jsx("div",{className:"px-6 py-3 col-span-1",children:"Assigned To"})]}),V&&e.jsx("div",{className:"py-16 text-center text-gray-500",children:"Loading..."}),!V&&N.length===0&&e.jsx("div",{className:"py-16 text-center text-gray-500",children:R||g!=="all"||C.from||C.to?"No complaints found matching your filters.":"No complaints found. Create a new complaint to get started."}),!V&&N.length>0&&e.jsx("div",{className:"divide-y divide-gray-200",children:N.map(r=>{var c,v,b,F,A,w;return e.jsxs("div",{className:"grid grid-cols-7 items-center hover:bg-gray-50",children:[e.jsx("div",{className:"px-6 py-4 col-span-1 whitespace-nowrap",children:e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>ie(r),className:"text-gray-400 hover:text-gray-500",title:"View",type:"button",children:e.jsxs("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),e.jsx("button",{onClick:()=>le(r),className:"text-gray-400 hover:text-gray-500",title:"Edit",type:"button",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>de(r),className:"text-gray-400 hover:text-gray-500",title:"Update Status",type:"button",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("button",{onClick:()=>xe(r),className:"text-gray-400 hover:text-red-500",title:"Delete",type:"button",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})}),e.jsx("div",{className:"px-6 py-4 col-span-1 whitespace-nowrap",children:e.jsx(te,{status:r.status})}),e.jsx("div",{className:"px-6 py-4 col-span-1 whitespace-nowrap text-sm text-gray-500",children:new Date(r.complaint_date).toLocaleDateString()}),e.jsxs("div",{className:"px-6 py-4 col-span-1 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[(c=r.employee)==null?void 0:c.Lname,", ",(v=r.employee)==null?void 0:v.Fname]}),e.jsx("div",{className:"text-xs text-gray-500",children:(b=r.employee)==null?void 0:b.idno})]}),e.jsxs("div",{className:"px-6 py-4 col-span-1 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[(F=r.complainant)==null?void 0:F.Lname,", ",(A=r.complainant)==null?void 0:A.Fname]}),e.jsx("div",{className:"text-xs text-gray-500",children:(w=r.complainant)==null?void 0:w.idno})]}),e.jsx("div",{className:"px-6 py-4 col-span-1 whitespace-nowrap text-sm text-gray-900",children:r.complaint_title}),e.jsx("div",{className:"px-6 py-4 col-span-1 whitespace-nowrap text-sm text-gray-500",children:r.assignedTo?r.assignedTo.name:e.jsx("span",{className:"italic text-gray-400",children:"Not Assigned"})})]},r.id)})})]})]})})]}),e.jsx(X,{isOpen:p,onClose:()=>L(!1),title:"Create New Complaint",complaint:n,employees:t,users:m,onChange:k,onFileChange:Z,onSubmit:ce,mode:"create",errorMessages:f}),e.jsx(X,{isOpen:U,onClose:()=>D(!1),title:"Edit Complaint",complaint:n,employees:t,users:m,onChange:k,onFileChange:Z,onSubmit:me,mode:"edit",errorMessages:f}),e.jsx(X,{isOpen:q,onClose:()=>Y(!1),title:"View Complaint Details",complaint:n,employees:t,users:m,onChange:k,onFileChange:()=>{},onSubmit:()=>{},mode:"view",errorMessages:{}}),e.jsx(_e,{isOpen:ae,onClose:()=>H(!1),complaint:n,users:m,onSubmit:ue}),e.jsx(je,{isOpen:M.isOpen,onClose:()=>z({...M,isOpen:!1}),title:M.title,message:M.message,confirmText:M.confirmText,confirmVariant:M.confirmVariant,onConfirm:M.onConfirm})]})};export{ss as default};
