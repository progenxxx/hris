import{a as Os,r as i,j as e,H as Us}from"./app-D-TNKEQL.js";import{A as Hs}from"./AuthenticatedLayout-PCqsYVxf.js";import{S as qs}from"./Sidebar-Cg7Kwp5t.js";import{A as he,a as fe}from"./alert-ttcl-5kV.js";import{B as m}from"./Button-SjHtsDzU.js";import{C as $,a as Ls,b as Is,c as z}from"./card-qhIlbjIo.js";import Xs from"./AttendanceEditModal-kPZCNTpG.js";import $s from"./AttendanceInfoModal-DBK4kpRZ.js";import{R as j}from"./refresh-cw-BgXuErF8.js";import{S as Ce}from"./send-BfFEKpTB.js";import{C as Xe}from"./calculator-CPOjIyxz.js";import{D as zs}from"./download-Dnq6PCPG.js";import{U as $e}from"./upload-Cz6lxnvX.js";import{T as ze}from"./target-VztaiuYU.js";import{F as We}from"./file-text-QjoOwKBJ.js";import{T as Te}from"./trash-2-CDm128Nv.js";import{T as ge}from"./triangle-alert-CxlByYdl.js";import{C as ye}from"./circle-check-big-BKozuvyq.js";import{S as Ws}from"./search-DZDiwkir.js";import{C as Bs}from"./calendar-DhTYrr3L.js";import{M as Pe,S as Vs}from"./sun-C8qLRgC1.js";import{U as Js}from"./users-Cw0U-ZsC.js";import{S as Be}from"./square-pen-CNScrVsF.js";import{C as Ve}from"./clock-D8g538AG.js";import{C as Je}from"./car-Ul5GVFP6.js";import{I as Ks}from"./info-CEwrAHp7.js";import{X as je}from"./x-fQrOvEob.js";import{C as Ys}from"./circle-check-0ZaRqU1Q.js";import{C as Gs}from"./circle-alert-DRTaAOqF.js";import"./ApplicationLogo-Cn-MbvX-.js";import"./Dropdown-BOoMuW7P.js";import"./transition-DeCEAfJ2.js";import"./createLucideIcon-DEWnkTLV.js";/* empty css                */import"./clsx-B-dksMZM.js";import"./loader-circle-D5iasq1K.js";import"./save-DYdKxaX2.js";import"./user-DhodrGY1.js";import"./building-DXwlrib0.js";const Ht=()=>{const{auth:Ke,attendances:Ye=[],pagination:ee={},recalculated_count:W=0}=Os().props,[F,we]=i.useState(Ye),[Ge,De]=i.useState(!1),[be,Re]=i.useState(!1),[se,Ee]=i.useState(!1),[te,ae]=i.useState(!1),[B,Fe]=i.useState(!1),[M,Ne]=i.useState(!1),[w,V]=i.useState(!1),[O,r]=i.useState(""),[U,f]=i.useState(""),[p,S]=i.useState(ee.current_page||1),[y,Qe]=i.useState(ee.last_page||1),[Ze,Qs]=i.useState(ee.per_page||25),[N,es]=i.useState(""),[u,ss]=i.useState(""),[h,ts]=i.useState(""),[_,as]=i.useState(!1),[C,rs]=i.useState(!1),[T,ls]=i.useState(""),[re,ns]=i.useState([]),[P,le]=i.useState(null),[is,ne]=i.useState(!1),[ie,J]=i.useState(null),[Me,K]=i.useState(!1),[Ae,oe]=i.useState(!1),[v,H]=i.useState([]),[os,ve]=i.useState(!1),[cs,Y]=i.useState(!1),[A,ce]=i.useState("selected"),[b,q]=i.useState({start_date:"",end_date:"",employee_id:"",department:""}),[D,Oe]=i.useState(!1),[ds,de]=i.useState(!1),[ke,me]=i.useState(null),[ms,xe]=i.useState(!1),[g,L]=i.useState({date:"",multiplier:"2.0",department:"",employee_ids:[]}),[Se,pe]=i.useState(!1),[o,G]=i.useState({year:new Date().getFullYear(),month:new Date().getMonth()+1,period_type:"1st_half",department:"",employee_ids:[]}),[I,ue]=i.useState(null),[Q,Ue]=i.useState(!1),k=i.useRef(null),R=i.useRef(!1),xs=s=>s.map(t=>({...t,employee_name:t.employee_name||"Unknown Employee",idno:t.idno||"N/A",department:t.department||"N/A",line:t.line||"N/A",hours_worked:t.hours_worked||0,late_minutes:t.late_minutes||0,undertime_minutes:t.undertime_minutes||0,overtime:t.overtime||0,travel_order:t.travel_order||0,slvl:t.slvl||0,trip:t.trip||0,ct:t.ct||!1,cs:t.cs||!1,holiday:t.holiday||0,ot_reg_holiday:t.ot_reg_holiday||0,ot_special_holiday:t.ot_special_holiday||0,retromultiplier:t.retromultiplier||1,restday:t.restday||!1,offset:t.offset||0,ob:t.ob||!1,is_nightshift:t.is_nightshift||!1,source:t.source||"unknown",posting_status:t.posting_status||"not_posted"})),E=async(s=!1)=>{De(!0),r("");try{const t=new URLSearchParams;t.append("page",p),t.append("per_page",Ze),N&&t.append("search",N),u&&t.append("date",u),h&&t.append("department",h),_&&t.append("edits_only","true"),C&&t.append("night_shift_only","true"),T&&t.append("posting_status",T);const n=await(await fetch("/attendance/list?"+t.toString(),{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}})).json();if(n.success){const l=xs(n.data);we(l),Qe(n.pagination.last_page),S(n.pagination.current_page),s&&n.recalculated_count>0&&f(`Loaded data and recalculated ${n.recalculated_count} attendance records`),H([]),ve(!1)}else r("Failed to load attendance data")}catch(t){console.error("Error loading attendance data:",t),r("Error loading attendance data: "+(t.message||"Unknown error"))}finally{De(!1)}},ps=async()=>{var s;if(!(!o.year||!o.month||!o.period_type)){Ue(!0),r("");try{const t=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"),a=await fetch("/attendance/posting-preview",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:JSON.stringify({year:o.year,month:o.month,period_type:o.period_type,department:o.department||null,employee_ids:o.employee_ids.length>0?o.employee_ids:null})});if(!a.ok)throw new Error(`Preview failed with status: ${a.status}`);const n=await a.json();n.success?ue(n):r("Failed to load posting preview: "+(n.message||"Unknown error"))}catch(t){console.error("Error loading post preview:",t),r("Failed to load posting preview: "+(t.message||"Unknown error"))}finally{Ue(!1)}}},us=async()=>{var s;if(!I||I.totals.employees===0){r("No employees to post");return}V(!0),r("");try{const t=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content");if(!t){r("Session expired. Please refresh the page and try again."),V(!1);return}const a={year:parseInt(o.year),month:parseInt(o.month),period_type:o.period_type,department:o.department||null,employee_ids:Array.isArray(o.employee_ids)&&o.employee_ids.length>0?o.employee_ids.map(c=>parseInt(c)):[]};if(!a.year||!a.month||!a.period_type){r("Year, Month, and Period Type are required for posting"),V(!1);return}console.log("Sending POST to payroll request:",a);const n=await fetch("/attendance/post-to-payroll",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:JSON.stringify(a)});if(!n.ok){let c=`Posting failed with status: ${n.status}`;try{const d=await n.json();console.error("Response error data:",d),n.status===422?d.errors?c="Validation failed: "+Object.values(d.errors).flat().join(", "):c="Validation failed: "+(d.message||"Invalid data provided"):n.status===404?c=d.message||"No eligible attendance records found for the specified criteria":n.status>=500?c="Server error occurred. Please try again later.":c=d.message||c}catch(d){console.error("Error parsing response:",d),c=`Request failed with status ${n.status}. Please check the server logs.`}r(c),V(!1);return}const l=await n.json();console.log("POST response data:",l),l.success?(f(l.message||"Posted to payroll successfully"),pe(!1),ue(null),G({year:new Date().getFullYear(),month:new Date().getMonth()+1,period_type:"1st_half",department:"",employee_ids:[]}),await E(!1)):(r("Posting failed: "+(l.message||"Unknown error occurred")),l.errors&&l.errors.length>0&&r(l.message+`

Errors:
`+l.errors.slice(0,3).join(`
`)))}catch(t){console.error("Posting error:",t),t.name==="TypeError"&&t.message.includes("Failed to fetch")?r("Network error. Please check your internet connection and try again."):t.message.includes("JSON")?r("Invalid response from server. Please try again."):r("Failed to post to payroll: "+(t.message||"Unknown error occurred"))}finally{V(!1)}},He=async()=>{S(1),await E(!0)},hs=async()=>{ae(!0),r("");try{const s=new URLSearchParams;N&&s.append("search",N),u&&s.append("date",u),h&&s.append("department",h),_&&s.append("edits_only","true"),C&&s.append("night_shift_only","true"),T&&s.append("posting_status",T);const t=await fetch("/attendance/download-template?"+s.toString(),{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/octet-stream"}});if(!t.ok)throw new Error(`Download failed with status: ${t.status}`);const a=await t.blob(),n=window.URL.createObjectURL(a),l=document.createElement("a");l.href=n;let x=`attendance_data_${new Date().toISOString().split("T")[0]}`;u&&(x+=`_${u}`),h&&(x+=`_${h.replace(/\s+/g,"_")}`),_&&(x+="_edited_only"),C&&(x+="_night_shift"),l.download=`${x}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(n),f("Attendance data downloaded successfully")}catch(s){console.error("Download error:",s),r("Failed to download attendance data: "+(s.message||"Unknown error"))}finally{ae(!1)}},fs=async()=>{ae(!0),r("");try{const s=new URLSearchParams;N&&s.append("search",N),u&&s.append("date",u),h&&s.append("department",h),_&&s.append("edits_only","true"),C&&s.append("night_shift_only","true"),T&&s.append("posting_status",T);const t=await fetch("/attendance/export?"+s.toString(),{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/octet-stream"}});if(!t.ok)throw new Error(`Export failed with status: ${t.status}`);const a=await t.blob(),n=window.URL.createObjectURL(a),l=document.createElement("a");l.href=n;let x=`attendance_export_${new Date().toISOString().split("T")[0]}`;u&&(x+=`_${u}`),h&&(x+=`_${h.replace(/\s+/g,"_")}`),_&&(x+="_edited_only"),C&&(x+="_night_shift"),l.download=`${x}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(n),f("Attendance data exported successfully")}catch(s){console.error("Export error:",s),r("Failed to export attendance data: "+(s.message||"Unknown error"))}finally{ae(!1)}},gs=async()=>{var s;if(!ke){r("Please select a file to import");return}Fe(!0),r("");try{const t=new FormData;t.append("file",ke);const a=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"),n=await fetch("/attendance/import",{method:"POST",headers:{"X-CSRF-TOKEN":a,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:t});if(!n.ok)throw new Error(`Import failed with status: ${n.status}`);const l=await n.json();l.success?(f(l.message||"Import completed successfully"),de(!1),me(null),await E(!1)):(r("Import failed: "+(l.message||"Unknown error")),l.errors&&l.errors.length>0&&r(l.message+`

Errors:
`+l.errors.slice(0,5).join(`
`)))}catch(t){console.error("Import error:",t),r("Failed to import attendance data: "+(t.message||"Unknown error"))}finally{Fe(!1)}},ys=async()=>{var t;if(!g.date){r("Please select a holiday date");return}if(!g.multiplier||isNaN(parseFloat(g.multiplier))){r("Please provide a valid holiday multiplier");return}const s=parseFloat(g.multiplier);if(s<.1||s>10){r("Holiday multiplier must be between 0.1 and 10");return}Ne(!0),r("");try{const a=(t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content");if(!a){r("Session expired. Please refresh the page and try again."),Ne(!1);return}const n={date:g.date,multiplier:s,department:g.department||null,employee_ids:Array.isArray(g.employee_ids)&&g.employee_ids.length>0?g.employee_ids:[]};console.log("Sending holiday request:",n);const l=await fetch("/attendance/set-holiday",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":a,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:JSON.stringify(n)});if(!l.ok)if(l.status===422){const d=await l.json();if(d.errors){const x=Object.values(d.errors).flat();r("Validation failed: "+x.join(", "))}else r("Validation failed: "+(d.message||"Invalid data provided"));return}else if(l.status===404){const d=await l.json();r(d.message||"No eligible attendance records found for the specified criteria");return}else if(l.status>=500){r("Server error occurred. Please try again later.");return}else throw new Error(`Request failed with status: ${l.status}`);const c=await l.json();c.success?(f(c.message||"Holiday set successfully"),xe(!1),L({date:"",multiplier:"2.0",department:"",employee_ids:[]}),await E(!1)):r("Set holiday failed: "+(c.message||"Unknown error occurred"))}catch(a){console.error("Set holiday error:",a),a.name==="TypeError"&&a.message.includes("Failed to fetch")?r("Network error. Please check your internet connection and try again."):a.message.includes("JSON")?r("Invalid response from server. Please try again."):r("Failed to set holiday: "+(a.message||"Unknown error occurred"))}finally{Ne(!1)}},qe=async(s=!1)=>{var t;if(!se){Ee(!0),r("");try{const a=new URLSearchParams;u&&a.append("date",u),h&&a.append("department",h);const n=(t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"),l=await fetch("/attendance/recalculate-all",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":n,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:JSON.stringify({date:u,department:h})});if(!l.ok)throw new Error(`Recalculation failed with status: ${l.status}`);const c=await l.json();c.success?(s&&c.recalculated_count>0&&f(`Recalculated ${c.recalculated_count} attendance records`),await E(!1)):r("Recalculation failed: "+(c.message||"Unknown error"))}catch(a){console.error("Recalculation error:",a),r("Failed to recalculate attendance data: "+(a.message||"Unknown error"))}finally{Ee(!1)}}},js=async()=>{var s;if(!be){Re(!0),r("");try{const t=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"),a=await fetch("/attendance/sync",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});if(!a.ok)throw new Error(`Sync failed with status: ${a.status}`);const n=await a.json();n.success?(f(n.message||"Sync completed successfully"),await E(!1)):r("Sync failed: "+(n.message||"Unknown error"))}catch(t){console.error("Sync error:",t),r("Failed to sync attendance data: "+(t.message||"Unknown error"))}finally{Re(!1)}}},ws=async s=>{var t;try{r("");const a=(t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"),n=await fetch(`/attendance/${s}/sync`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":a,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});if(!n.ok)throw new Error(`Individual sync failed with status: ${n.status}`);const l=await n.json();l.success?(f(l.message||"Record synced successfully"),l.data&&we(c=>c.map(d=>d.id===s?{...d,...l.data}:d))):r("Individual sync failed: "+(l.message||"Unknown error"))}catch(a){console.error("Individual sync error:",a),r("Failed to sync individual record: "+(a.message||"Unknown error"))}},bs=async s=>{var t;try{r(""),f("");const a=(t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content");if(!a){r("Session expired. Please refresh the page and try again.");return}const n={id:s.id,time_in:s.time_in,break_in:s.break_in,break_out:s.break_out,time_out:s.time_out,next_day_timeout:s.next_day_timeout,is_nightshift:s.is_nightshift,trip:s.trip},l=await fetch(`/attendance/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":a,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:JSON.stringify(n)});if(l.status===401){r("Session expired. Please refresh the page and login again.");return}if(l.status===419){r("Security token expired. Please refresh the page and try again.");return}if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const c=l.headers.get("content-type");if(!c||!c.includes("application/json")){f("Update completed successfully!"),window.location.reload();return}const d=await l.json();if(d.success){f("Attendance record updated successfully");const x={...d.data,source:"manual_edit",is_edited:!0};we(As=>As.map(Ie=>Ie.id===s.id?x:Ie)),K(!1)}else d.redirect?(r("Session expired. Redirecting to login..."),setTimeout(()=>{window.location.href=d.redirect},2e3)):r("Failed to update attendance: "+(d.message||"Unknown error"))}catch(a){console.error("Error updating attendance:",a),a.name==="TypeError"&&a.message.includes("Failed to fetch")?r("Network error. Please check your internet connection and try again."):a.message.includes("non-JSON response")?(f("Update completed successfully!"),window.location.reload()):a.message.includes("HTTP error")?r(`Server error (${a.message}). Please try again or contact support.`):r("Error updating attendance: "+(a.message||"Unknown error"))}},Ns=(s,t)=>{s.stopPropagation(),s.target.checked?H(a=>[...a,t]):H(a=>a.filter(n=>n!==t))},vs=s=>{ve(s),H(s?F.map(t=>t.id):[])},ks=(s,t)=>{s.preventDefault(),ne(!0);const a=setTimeout(()=>{J(t),oe(!0),ne(!1)},1e3);le(a)},Ss=()=>{P&&(clearTimeout(P),le(null)),ne(!1)},_s=()=>{P&&(clearTimeout(P),le(null)),ne(!1)},Cs=(s,t)=>{s.preventDefault(),s.stopPropagation(),P&&(clearTimeout(P),le(null)),!R.current&&(k.current&&clearTimeout(k.current),R.current=!0,J(t),K(!0),k.current=setTimeout(()=>{R.current=!1},500))},Ts=(s,t)=>{s.preventDefault(),s.stopPropagation(),!R.current&&(k.current&&clearTimeout(k.current),R.current=!0,J(t),K(!0),k.current=setTimeout(()=>{R.current=!1},500))},Le=()=>{K(!1),oe(!1),J(null),R.current=!1,k.current&&clearTimeout(k.current)},Ps=async()=>{var s;try{Oe(!0),r("");const t=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content");let a={};if(A==="selected"){if(v.length===0){r("Please select attendance records to delete");return}a={ids:v}}else{if(!b.start_date||!b.end_date){r("Please provide both start and end dates");return}a={start_date:b.start_date,end_date:b.end_date,employee_id:b.employee_id||null,department:b.department||null}}const n=await fetch("/attendance/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:JSON.stringify(a)});if(!n.ok)throw new Error(`Delete failed with status: ${n.status}`);const l=await n.json();l.success?(f(l.message||`Deleted ${l.deleted_count} records successfully`),await E(!1),H([]),ve(!1),Y(!1),q({start_date:"",end_date:"",employee_id:"",department:""})):r("Delete failed: "+(l.message||"Unknown error"))}catch(t){console.error("Bulk delete error:",t),r("Failed to delete records: "+(t.message||"Unknown error"))}finally{Oe(!1)}},Ds=async()=>{try{const s=await fetch("/attendance/departments",{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});if(s.ok){const t=await s.json();t.success&&ns(t.data)}}catch(s){console.error("Error loading departments:",s)}},Rs=s=>{if(!s)return"N/A";try{return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"Invalid Date"}},Z=s=>{if(!s)return"-";try{let t;if(s.includes("T")){const[,x]=s.split("T");t=x.slice(0,5)}else{const x=s.split(" ");t=x[x.length-1].slice(0,5)}const[a,n]=t.split(":"),l=parseInt(a,10),c=l>=12?"PM":"AM";return`${l%12||12}:${n} ${c}`}catch(t){return console.error("Time formatting error:",t),"-"}},X=(s,t=2)=>{if(s==null||s==="")return"-";const a=parseFloat(s);return isNaN(a)?"-":a.toFixed(t)},Es=s=>{const t=parseFloat(s.late_minutes||0),a=parseFloat(s.undertime_minutes||0);return t===0&&a===0?e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ye,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-xs text-green-600 font-medium",children:"On Time"})]}):e.jsxs("div",{className:"space-y-1",children:[t>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ve,{className:"h-3 w-3 text-red-500"}),e.jsxs("span",{className:"text-xs text-red-600",children:[Math.floor(t/60)>0?`${Math.floor(t/60)}h `:"",Math.round(t%60),"m late"]})]}),a>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ge,{className:"h-3 w-3 text-orange-500"}),e.jsxs("span",{className:"text-xs text-orange-600",children:[Math.floor(a/60)>0?`${Math.floor(a/60)}h `:"",Math.round(a%60),"m under"]})]})]})},Fs=s=>s.is_nightshift?e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs",children:[e.jsx(Pe,{className:"h-3 w-3"}),e.jsx("span",{children:"Night"})]}):e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs",children:[e.jsx(Vs,{className:"h-3 w-3"}),e.jsx("span",{children:"Day"})]}),_e=(s,t="boolean")=>{if(t==="source"){const a={manual_edit:"bg-red-100 text-red-800",slvl_sync:"bg-indigo-100 text-indigo-800",import:"bg-blue-100 text-blue-800",biometric:"bg-green-100 text-green-800",unknown:"bg-gray-100 text-gray-800"},n=a[s]||a.unknown,l=s==="manual_edit"?"Edited":s==="slvl_sync"?"SLVL":s==="import"?"Import":s==="biometric"?"Bio":"Unknown";return e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${n}`,children:l})}return s?e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"✓"}):e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"-"})},Ms=s=>s.posting_status==="posted"?e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(Ys,{className:"h-3 w-3 mr-1"}),"Posted"]}):e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[e.jsx(Gs,{className:"h-3 w-3 mr-1"}),"Not Posted"]});return i.useEffect(()=>{if(Se&&o.year&&o.month&&o.period_type){const s=setTimeout(()=>{ps()},300);return()=>clearTimeout(s)}},[Se,o.year,o.month,o.period_type,o.department,o.employee_ids]),i.useEffect(()=>{W>0&&f(`Auto-recalculated ${W} attendance records for accurate display`)},[W]),i.useEffect(()=>{if(U){const s=setTimeout(()=>f(""),5e3);return()=>clearTimeout(s)}},[U]),i.useEffect(()=>{if(O){const s=setTimeout(()=>r(""),1e4);return()=>clearTimeout(s)}},[O]),i.useEffect(()=>()=>{k.current&&clearTimeout(k.current),P&&clearTimeout(P)},[P]),i.useEffect(()=>{F.length>0&&qe()},[N,u,h,_,C]),i.useEffect(()=>{Ds()},[]),i.useEffect(()=>{p!==ee.current_page&&E(!1)},[p]),i.useEffect(()=>{const s=setTimeout(()=>{(N!==""||u!==""||h!==""||_!==!1||C!==!1||T!=="")&&He()},500);return()=>clearTimeout(s)},[N]),i.useEffect(()=>{He()},[u,h,_,C,T]),e.jsxs(Hs,{user:Ke.user,children:[e.jsx(Us,{title:"Processed Attendance List"}),e.jsxs("div",{className:"flex min-h-screen bg-gray-50/50",children:[e.jsx(qs,{}),e.jsx("div",{className:"flex-1 p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-1",children:"Processed Attendance Records (Non-Posted Only)"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600",children:"View and manage non-posted attendance records with automatic recalculation and payroll posting."}),e.jsx("p",{className:"text-xs sm:text-sm text-blue-600 mt-1",children:"💡 Tip: Hold any row for 1 second to view details, double-click to edit attendance times"}),W>0&&e.jsxs("p",{className:"text-xs sm:text-sm text-green-600 mt-1",children:["✅ Auto-recalculated ",W," records for accurate display"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(m,{onClick:()=>pe(!0),disabled:w,size:"sm",className:"bg-green-600 hover:bg-green-700 text-white border-green-600 text-xs sm:text-sm",children:w?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Posting..."}),e.jsx("span",{className:"sm:hidden",children:"Post..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"POST to Payroll"}),e.jsx("span",{className:"sm:hidden",children:"POST"})]})}),e.jsx(m,{onClick:()=>qe(!0),disabled:se,variant:"outline",size:"sm",className:"bg-purple-600 hover:bg-purple-700 text-white border-purple-600 text-xs sm:text-sm",title:"Manually recalculate late/undertime for current view",children:se?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Recalculating..."}),e.jsx("span",{className:"sm:hidden",children:"Calc..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Xe,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Recalculate"}),e.jsx("span",{className:"sm:hidden",children:"Calc"})]})}),e.jsx(m,{onClick:hs,disabled:te,variant:"outline",size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white border-blue-600 text-xs sm:text-sm",children:te?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Downloading..."}),e.jsx("span",{className:"sm:hidden",children:"Down..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(zs,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Download"}),e.jsx("span",{className:"sm:hidden",children:"Down"})]})}),e.jsxs(m,{onClick:()=>de(!0),variant:"outline",size:"sm",className:"bg-indigo-600 hover:bg-indigo-700 text-white border-indigo-600 text-xs sm:text-sm",children:[e.jsx($e,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),"Import"]}),e.jsxs(m,{onClick:()=>xe(!0),variant:"outline",size:"sm",className:"bg-orange-600 hover:bg-orange-700 text-white border-orange-600 text-xs sm:text-sm",children:[e.jsx(ze,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Set Holiday"}),e.jsx("span",{className:"sm:hidden",children:"Holiday"})]}),e.jsx(m,{onClick:fs,disabled:te,variant:"outline",size:"sm",className:"bg-green-600 hover:bg-green-700 text-white border-green-600 text-xs sm:text-sm",children:te?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Exporting..."}),e.jsx("span",{className:"sm:hidden",children:"Exp..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),"Export"]})}),v.length>0&&e.jsxs(m,{onClick:()=>{ce("selected"),Y(!0)},variant:"outline",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white border-red-600 text-xs sm:text-sm",children:[e.jsx(Te,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.jsxs("span",{className:"hidden sm:inline",children:["Delete (",v.length,")"]}),e.jsxs("span",{className:"sm:hidden",children:["Del (",v.length,")"]})]}),e.jsxs(m,{onClick:()=>{ce("range"),Y(!0)},variant:"outline",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white border-red-600 text-xs sm:text-sm",children:[e.jsx(Te,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Delete Range"}),e.jsx("span",{className:"sm:hidden",children:"Del Range"})]}),e.jsx(m,{onClick:js,disabled:be,size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white text-xs sm:text-sm",children:be?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Syncing..."}),e.jsx("span",{className:"sm:hidden",children:"Sync..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Sync Data"}),e.jsx("span",{className:"sm:hidden",children:"Sync"})]})})]})]}),O&&e.jsxs(he,{variant:"destructive",className:"mb-4",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),e.jsx(fe,{children:O})]}),U&&e.jsxs(he,{className:"mb-4 border-green-200 bg-green-50",children:[e.jsx(ye,{className:"h-4 w-4 mr-2 text-green-600"}),e.jsx(fe,{className:"text-green-800",children:U})]}),se&&e.jsxs(he,{className:"mb-4 border-purple-200 bg-purple-50",children:[e.jsx(Xe,{className:"h-4 w-4 mr-2 text-purple-600 animate-pulse"}),e.jsx(fe,{className:"text-purple-800",children:"Recalculating attendance metrics for accurate late/undertime display..."})]}),w&&e.jsxs(he,{className:"mb-4 border-green-200 bg-green-50",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2 text-green-600 animate-pulse"}),e.jsx(fe,{className:"text-green-800",children:"Posting attendance records to payroll summaries..."})]}),e.jsxs($,{className:"mb-4",children:[e.jsx(Ls,{className:"pb-3",children:e.jsxs(Is,{className:"text-lg flex items-center justify-between",children:[e.jsx("span",{children:"Filters"}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx("span",{children:"Auto-recalculation: Enabled"}),e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"})]})]})}),e.jsxs(z,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Search by ID or Name...",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:N,onChange:s=>es(s.target.value)})]}),e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsx(Bs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"date",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:u,onChange:s=>ss(s.target.value)})]})}),e.jsx("div",{children:e.jsxs("select",{className:"w-full pl-4 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:h,onChange:s=>ts(s.target.value),children:[e.jsx("option",{value:"",children:"All Departments"}),re.map(s=>e.jsx("option",{value:s,children:s},s))]})}),e.jsx("div",{children:e.jsxs("select",{className:"w-full pl-4 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:T,onChange:s=>ls(s.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"posted",children:"Posted"}),e.jsx("option",{value:"not_posted",children:"Not Posted"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500",checked:_,onChange:s=>as(s.target.checked)}),e.jsx("span",{className:"text-gray-700",children:"Edited Records Only"})]})}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox h-5 w-5 text-purple-600 rounded focus:ring-purple-500",checked:C,onChange:s=>rs(s.target.checked)}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Pe,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"text-gray-700",children:"Night Shift Only"})]})]})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-4",children:[e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Js,{className:"h-8 w-8 text-blue-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Records"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:F.length})]})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Be,{className:"h-8 w-8 text-orange-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Edited Records"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:F.filter(s=>s.source==="manual_edit").length})]})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Pe,{className:"h-8 w-8 text-purple-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Night Shifts"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:F.filter(s=>s.is_nightshift).length})]})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ye,{className:"h-8 w-8 text-green-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Selected"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.length})]})]})})}),e.jsx($,{children:e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(We,{className:"h-8 w-8 text-purple-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Current Page"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[p," of ",y]})]})]})})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow h-[70vh] flex flex-col w-full",children:Ge?e.jsxs("div",{className:"flex justify-center items-center h-full",children:[e.jsx(j,{className:"h-8 w-8 animate-spin text-blue-500"}),e.jsx("span",{className:"ml-2 text-lg",children:"Loading..."})]}):F.length===0?e.jsxs("div",{className:"text-center py-12 flex-1 flex flex-col justify-center",children:[e.jsx(Ve,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"No attendance records found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your filters or adding new attendance data."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:e.jsx("div",{className:"overflow-x-auto flex-1",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 h-full",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500",checked:os,onChange:s=>vs(s.target.checked)})}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dept"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time In"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Break Out"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Break In"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time Out"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Late/Under"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Night Shift"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hours"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"OT"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Travel"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SLVL"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CT"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CS"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Holiday"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsx("span",{children:"Trip"})]})}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Source"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-2 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 overflow-y-auto",children:F.map(s=>e.jsxs("tr",{className:`hover:bg-blue-50 cursor-pointer transition-colors select-none ${s.source==="manual_edit"?"bg-red-50":""} ${is?"bg-blue-100":""}`,onMouseDown:t=>ks(t,s),onMouseUp:Ss,onMouseLeave:_s,onDoubleClick:t=>Cs(t,s),title:"Hold for 1 second to view details, double-click to edit attendance times",children:[e.jsx("td",{className:"px-2 py-4 whitespace-nowrap",onClick:t=>t.stopPropagation(),children:e.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500",checked:v.includes(s.id),onChange:t=>Ns(t,s.id)})}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.employee_name||"Unknown Employee"}),e.jsx("div",{className:"text-xs text-gray-500",children:s.idno||"N/A"})]})})}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:s.department||"N/A"}),e.jsxs("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:[Rs(s.attendance_date),s.day&&e.jsx("span",{className:"block text-xs mt-1 text-gray-400",children:s.day})]}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:Z(s.time_in)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:Z(s.break_out)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:Z(s.break_in)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:s.is_nightshift&&s.next_day_timeout?Z(s.next_day_timeout):Z(s.time_out)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap",children:Es(s)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap",children:Fs(s)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:X(s.hours_worked)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:X(s.overtime)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:X(s.travel_order,1)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:X(s.slvl,1)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:_e(s.ct)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:_e(s.cs)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:X(s.holiday)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Je,{className:"h-3 w-3 text-blue-500"}),e.jsx("span",{children:X(s.trip,1)})]})}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap",children:_e(s.source,"source")}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap",children:Ms(s)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"flex justify-end space-x-1",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:t=>{t.stopPropagation(),J(s),oe(!0)},className:"text-blue-600 hover:text-blue-900",type:"button",title:"View Details",children:e.jsx(Ks,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:t=>Ts(t,s),disabled:R.current,className:"text-blue-600 hover:text-blue-900 disabled:opacity-50 disabled:cursor-not-allowed",type:"button",title:"Edit Attendance",children:e.jsx(Be,{className:"h-4 w-4"})})]})})]},s.id))})]})})}),e.jsxs("div",{className:"px-6 py-4 flex items-center justify-between border-t border-gray-200 bg-white",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx(m,{onClick:()=>S(Math.max(1,p-1)),disabled:p===1,variant:"outline",size:"sm",children:"Previous"}),e.jsx(m,{onClick:()=>S(Math.min(y,p+1)),disabled:p===y,variant:"outline",size:"sm",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing page ",e.jsx("span",{className:"font-medium",children:p})," of"," ",e.jsx("span",{className:"font-medium",children:y})]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx(m,{onClick:()=>S(1),disabled:p===1,variant:"outline",size:"sm",className:"rounded-l-md",children:"First"}),e.jsx(m,{onClick:()=>S(Math.max(1,p-1)),disabled:p===1,variant:"outline",size:"sm",children:"Previous"}),Array.from({length:Math.min(5,y)},(s,t)=>{const a=p<=3?t+1:p>=y-2?y-4+t:p-2+t;return a>0&&a<=y?e.jsx(m,{onClick:()=>S(a),variant:p===a?"default":"outline",size:"sm",className:p===a?"bg-blue-500 text-white":"",children:a},a):null}),e.jsx(m,{onClick:()=>S(Math.min(y,p+1)),disabled:p===y,variant:"outline",size:"sm",children:"Next"}),e.jsx(m,{onClick:()=>S(y),disabled:p===y,variant:"outline",size:"sm",className:"rounded-r-md",children:"Last"})]})})]})]})]})})]})})]}),Me&&ie&&e.jsx(Xs,{isOpen:Me,attendance:ie,onClose:Le,onSave:bs,onSync:ws}),Ae&&ie&&e.jsx($s,{isOpen:Ae,attendance:ie,onClose:Le,onEdit:()=>{oe(!1),K(!0)}}),Se&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"POST to Payroll"}),e.jsx("button",{onClick:()=>{pe(!1),ue(null),r("")},className:"text-gray-500 hover:text-gray-700","aria-label":"Close",disabled:w,children:e.jsx(je,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6",children:[O&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(ge,{className:"h-5 w-5 text-red-600 mt-0.5 mr-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-800",children:"Error"}),e.jsx("div",{className:"mt-1 text-sm text-red-700",children:O.split(`
`).map((s,t)=>e.jsx("div",{children:s},t))})]})]})}),U&&e.jsx("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(ye,{className:"h-5 w-5 text-green-600 mt-0.5 mr-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-800",children:"Success"}),e.jsx("p",{className:"mt-1 text-sm text-green-700",children:U})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Year *"}),e.jsx("input",{type:"number",min:"2020",max:"2030",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",value:o.year,onChange:s=>{r(""),G(t=>({...t,year:parseInt(s.target.value)||new Date().getFullYear()}))},disabled:w||Q})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Month *"}),e.jsx("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",value:o.month,onChange:s=>{r(""),G(t=>({...t,month:parseInt(s.target.value)}))},disabled:w||Q,children:Array.from({length:12},(s,t)=>e.jsx("option",{value:t+1,children:new Date(2024,t,1).toLocaleString("default",{month:"long"})},t+1))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Period *"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",value:o.period_type,onChange:s=>{r(""),G(t=>({...t,period_type:s.target.value}))},disabled:w||Q,children:[e.jsx("option",{value:"1st_half",children:"1st Half (1-15)"}),e.jsx("option",{value:"2nd_half",children:"2nd Half (16-30/31)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department (Optional)"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",value:o.department,onChange:s=>{r(""),G(t=>({...t,department:s.target.value}))},disabled:w||Q,children:[e.jsx("option",{value:"",children:"All Departments"}),re.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]}),Q&&e.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(j,{className:"h-5 w-5 text-blue-600 animate-spin mr-2"}),e.jsx("span",{className:"text-blue-800",children:"Loading preview..."})]})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[e.jsx(m,{variant:"outline",onClick:()=>{pe(!1),ue(null),r("")},disabled:w,children:"Cancel"}),e.jsx(m,{onClick:us,disabled:w||!I||I.totals.employees===0||!o.year||!o.month||!o.period_type,className:"bg-green-600 hover:bg-green-700 text-white",children:w?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4 mr-2 animate-spin"}),"Posting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Confirm POST (",I?I.totals.employees:0," employees)"]})})]})]})]})}),ds&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Import Attendance Data"}),e.jsx("button",{onClick:()=>{de(!1),me(null)},className:"text-gray-500 hover:text-gray-700","aria-label":"Close",disabled:B,children:e.jsx(je,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select CSV File"}),e.jsx("input",{type:"file",accept:".csv,.txt",onChange:s=>me(s.target.files[0]),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:B}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Upload a CSV file with attendance data. Maximum size: 10MB"})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Required CSV Format:"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Employee Number, Employee Name, Department, Date, Day, Time In, Break Out, Break In, Time Out, Next Day Timeout, Hours Worked, Night Shift, Trip"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(m,{variant:"outline",onClick:()=>{de(!1),me(null)},disabled:B,children:"Cancel"}),e.jsx(m,{onClick:gs,disabled:B||!ke,className:"bg-indigo-600 hover:bg-indigo-700",children:B?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4 mr-2 animate-spin"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),"Import Data"]})})]})]})]})}),ms&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Set Holiday"}),e.jsx("button",{onClick:()=>{xe(!1),L({date:"",multiplier:"2.0",department:"",employee_ids:[]})},className:"text-gray-500 hover:text-gray-700","aria-label":"Close",disabled:M,children:e.jsx(je,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Holiday Date *"}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",value:g.date,onChange:s=>L(t=>({...t,date:s.target.value})),disabled:M})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Holiday Multiplier *"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",value:g.multiplier,onChange:s=>L(t=>({...t,multiplier:s.target.value})),disabled:M,children:[e.jsx("option",{value:"1.3",children:"1.3 (Special Holiday)"}),e.jsx("option",{value:"2.0",children:"2.0 (Regular Holiday)"}),e.jsx("option",{value:"2.6",children:"2.6 (Regular Holiday + OT)"}),e.jsx("option",{value:"1.69",children:"1.69 (Special Holiday + OT)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department (Optional)"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",value:g.department,onChange:s=>L(t=>({...t,department:s.target.value})),disabled:M,children:[e.jsx("option",{value:"",children:"All Departments"}),re.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Leave empty to apply to all departments"})]})]}),e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mt-4",children:[e.jsx("h4",{className:"font-medium text-orange-800 mb-2",children:"Note:"}),e.jsx("p",{className:"text-sm text-orange-700",children:"This will set the holiday multiplier for all eligible attendance records on the selected date. Records with existing overtime will be excluded."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx(m,{variant:"outline",onClick:()=>{xe(!1),L({date:"",multiplier:"2.0",department:"",employee_ids:[]})},disabled:M,children:"Cancel"}),e.jsx(m,{onClick:ys,disabled:M||!g.date||!g.multiplier,className:"bg-orange-600 hover:bg-orange-700",children:M?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4 mr-2 animate-spin"}),"Setting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Set Holiday"]})})]})]})]})}),cs&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Delete Attendance Records"}),e.jsx("button",{onClick:()=>{Y(!1),q({start_date:"",end_date:"",employee_id:"",department:""})},className:"text-gray-500 hover:text-gray-700","aria-label":"Close",disabled:D,children:e.jsx(je,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"deleteMode",value:"selected",checked:A==="selected",onChange:s=>ce(s.target.value),disabled:D,className:"form-radio h-4 w-4 text-red-600"}),e.jsxs("span",{className:"ml-2 text-sm text-gray-700",children:["Delete Selected (",v.length," records)"]})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"deleteMode",value:"range",checked:A==="range",onChange:s=>ce(s.target.value),disabled:D,className:"form-radio h-4 w-4 text-red-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Delete by Date Range"})]})]})}),A==="range"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date *"}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",value:b.start_date,onChange:s=>q(t=>({...t,start_date:s.target.value})),disabled:D})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date *"}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",value:b.end_date,onChange:s=>q(t=>({...t,end_date:s.target.value})),disabled:D})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department (Optional)"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",value:b.department,onChange:s=>q(t=>({...t,department:s.target.value})),disabled:D,children:[e.jsx("option",{value:"",children:"All Departments"}),re.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mt-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(ge,{className:"h-5 w-5 text-red-600 mt-0.5 mr-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-800",children:"Warning"}),e.jsxs("p",{className:"text-sm text-red-700 mt-1",children:["This action cannot be undone. ",A==="selected"?`${v.length} selected records will be permanently deleted.`:"All attendance records in the specified date range will be permanently deleted."]})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx(m,{variant:"outline",onClick:()=>{Y(!1),q({start_date:"",end_date:"",employee_id:"",department:""})},disabled:D,children:"Cancel"}),e.jsx(m,{onClick:Ps,disabled:D||A==="selected"&&v.length===0||A==="range"&&(!b.start_date||!b.end_date),className:"bg-red-600 hover:bg-red-700 text-white",children:D?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4 mr-2 animate-spin"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Confirm Delete"]})})]})]})]})})]})};export{Ht as default};
