import{r as u,j as e}from"./app-D-TNKEQL.js";import ie from"./OvertimeRateHelpModal-ZSVUP3CJ.js";import{L as A}from"./loader-circle-D5iasq1K.js";import{C as q}from"./clock-D8g538AG.js";import{I as W}from"./info-CEwrAHp7.js";import{c as ae}from"./createLucideIcon-DEWnkTLV.js";import{f as ne}from"./format-Bw_hER4B.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=ae("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),pe=({employees:v,departments:B,rateMultipliers:N,onSubmit:z})=>{const M=ne(new Date,"yyyy-MM-dd"),[i,h]=u.useState({employee_ids:[],date:M,start_time:"17:00",end_time:"20:00",overtime_hours:"3.00",reason:"",rate_multiplier:N.length>0?N[0].value:1.25,overtime_type:"regular_weekday",has_night_differential:!1}),[n,T]=u.useState(!1),[G,_]=u.useState(""),[f,J]=u.useState(v||[]),[y,O]=u.useState(""),[w,R]=u.useState(""),[Q,P]=u.useState(!1),[k,b]=u.useState({start_time:"5:00 PM",end_time:"8:00 PM"}),K={regular_weekday:"Regular Weekday Overtime",rest_day:"Rest Day Work",scheduled_rest_day:"Scheduled Rest Day Work",regular_holiday:"Regular Holiday Work",special_holiday:"Special Holiday Work",emergency_work:"Emergency Work",extended_shift:"Extended Shift",weekend_work:"Weekend Work",night_shift:"Night Shift Work",other:"Other"},U=t=>{if(t.length===1){const s=parseInt(t);if(s>=0&&s<=9)return`0${s}:00`}else if(t.length===2){const s=parseInt(t);if(s>=0&&s<=23)return`${t}:00`}else if(t.length===3){const s=parseInt(t.substring(0,1)),r=parseInt(t.substring(1,3));if(s>=0&&s<=9&&r>=0&&r<=59)return`0${s}:${t.substring(1,3)}`}else if(t.length>=4){const s=parseInt(t.substring(0,2)),r=parseInt(t.substring(2,4));if(s>=0&&s<=23&&r>=0&&r<=59)return`${t.substring(0,2)}:${t.substring(2,4)}`}return null},D=t=>{if(!t||!t.includes(":"))return t;try{const[s,r]=t.split(":"),a=parseInt(s),d=parseInt(r);if(a>=0&&a<=23&&d>=0&&d<=59){const o=a>=12?"PM":"AM";return`${a===0?12:a>12?a-12:a}:${r} ${o}`}}catch(s){console.error("Error formatting display time:",s)}return t},C=(t,s)=>{const r=s.target.value;if(r.includes(":")){h(o=>({...o,[t]:r})),b(o=>({...o,[t]:D(r)}));return}const a=r.replace(/\D/g,"");if(a.length===0){h(o=>({...o,[t]:""})),b(o=>({...o,[t]:""}));return}const d=U(a);d&&(h(o=>({...o,[t]:d})),b(o=>({...o,[t]:D(d)})))},L=(t,s)=>{const r=s.target.value;r&&r.includes(":")&&b(a=>({...a,[t]:D(r)}))},V=()=>{new Date(i.date);const t=i.start_time,s=i.end_time,r=parseInt(t.split(":")[0]),a=parseInt(s.split(":")[0]),d=r>=22||a<=6||r>a,o="regular_weekday";h(c=>({...c,overtime_type:o,has_night_differential:d}))};u.useEffect(()=>{let t=[],s=[],r=[],a=[],d=[],o=[];v.forEach(l=>{var H,I;const p=i.employee_ids.includes(l.id);let g=!0,j=!1;if(y){const m=y.toLowerCase().trim(),se=`${l.Fname} ${l.Lname}`.toLowerCase(),re=`${l.Lname} ${l.Fname}`.toLowerCase(),S=(H=l.idno)==null?void 0:H.toString().toLowerCase();l.Lname.toLowerCase()===m||l.Fname.toLowerCase()===m||se===m||re===m||S===m?(j=!0,g=!0):g=l.Fname.toLowerCase().includes(m)||l.Lname.toLowerCase().includes(m)||(S==null?void 0:S.includes(m))}let F=!0;w&&(F=(((I=l.department)==null?void 0:I.name)||l.Department)===w),F&&(p&&j?t.push(l):p&&g?s.push(l):p?r.push(l):j?a.push(l):g?d.push(l):y||o.push(l))});const c=(l,p)=>{const g=`${l.Lname}, ${l.Fname}`.toLowerCase(),j=`${p.Lname}, ${p.Fname}`.toLowerCase();return g.localeCompare(j)};t.sort(c),s.sort(c),r.sort(c),a.sort(c),d.sort(c),o.sort(c);const te=[...t,...s,...r,...a,...d,...o];J(te)},[y,w,v,i.employee_ids]);const x=t=>{const{name:s,value:r,type:a,checked:d}=t.target;if(s==="start_time"||s==="end_time"){C(s,t);return}h({...i,[s]:a==="checkbox"?d:r})},$=t=>{const s=parseInt(t,10);h(r=>r.employee_ids.includes(s)?{...r,employee_ids:r.employee_ids.filter(a=>a!==s)}:{...r,employee_ids:[...r.employee_ids,s]})},X=(t,s)=>{t.stopPropagation(),$(s)},Y=()=>{h(t=>{const s=f.map(a=>a.id);if(s.every(a=>t.employee_ids.includes(a)))return{...t,employee_ids:t.employee_ids.filter(a=>!s.includes(a))};{const a=t.employee_ids.filter(d=>!s.includes(d));return{...t,employee_ids:[...a,...s]}}})},Z=async t=>{if(t.preventDefault(),n)return;if(i.employee_ids.length===0){alert("Please select at least one employee");return}if(!i.date||!i.start_time||!i.end_time){alert("Please fill in all required fields");return}if(!i.reason.trim()){alert("Please provide a reason for the overtime");return}const s=parseFloat(i.overtime_hours);if(isNaN(s)||s<=0){alert("Please enter a valid number of overtime hours");return}if(s>24){alert("Overtime hours cannot exceed 24 hours");return}T(!0),_(`Processing overtime for ${i.employee_ids.length} employee${i.employee_ids.length>1?"s":""}...`);try{await z(i),h({employee_ids:[],date:M,start_time:"17:00",end_time:"20:00",overtime_hours:"3.00",reason:"",rate_multiplier:N.length>0?N[0].value:1.25,overtime_type:"regular_weekday",has_night_differential:!1}),b({start_time:"5:00 PM",end_time:"8:00 PM"}),O(""),R(""),_("Overtime requests submitted successfully!"),window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{_("")},2e3)}catch(r){console.error("Error submitting overtime:",r),_("")}finally{T(!1)}},E=f.length>0&&f.every(t=>i.employee_ids.includes(t.id)),ee=v.filter(t=>i.employee_ids.includes(t.id));return e.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"File New Overtime"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Create overtime request for one or multiple employees"})]}),n&&e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50 rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx(A,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-indigo-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:G})]})}),e.jsxs("form",{onSubmit:Z,className:"relative",children:[e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Select Employees"}),e.jsxs("div",{className:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2 mb-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by name or ID",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:y,onChange:t=>O(t.target.value),disabled:n})}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:w,onChange:t=>R(t.target.value),disabled:n,children:[e.jsx("option",{value:"",children:"All Departments"}),B.map((t,s)=>e.jsx("option",{value:t,children:t},s))]})}),e.jsx("div",{className:"md:flex-initial",children:e.jsx("button",{type:"button",className:`w-full px-4 py-2 rounded-md ${E?"bg-indigo-700 hover:bg-indigo-800":"bg-indigo-500 hover:bg-indigo-600"} text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50`,onClick:Y,disabled:n,children:E?"Deselect All":"Select All"})})]}),e.jsx("div",{className:"border rounded-md overflow-hidden max-h-60 overflow-y-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12",children:"Select"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-4 py-3 text-center text-sm text-gray-500",children:"No employees match your search criteria"})}):f.map(t=>{var s;return e.jsxs("tr",{className:`hover:bg-gray-50 cursor-pointer ${i.employee_ids.includes(t.id)?"bg-indigo-50":""} ${n?"opacity-50":""}`,onClick:()=>!n&&$(t.id),children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",checked:i.employee_ids.includes(t.id),onChange:r=>X(r,t.id),onClick:r=>r.stopPropagation(),disabled:n})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:t.idno}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[t.Lname,", ",t.Fname," ",t.MName||""]})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:((s=t.department)==null?void 0:s.name)||t.Department||"No Department"}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:t.Jobtitle})]},t.id)})})]})}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:i.employee_ids.length>0?e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium",children:[i.employee_ids.length," employee(s) selected"]}),i.employee_ids.length<=5&&e.jsxs("span",{className:"ml-2",children:["(",ee.map(t=>t.Lname).join(", "),")"]})]}):e.jsx("span",{className:"text-yellow-600",children:"No employees selected"})})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Overtime Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 mb-1",children:["Date ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"date",id:"date",name:"date",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:i.date,onChange:x,disabled:n,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"start_time",className:"block text-sm font-medium text-gray-700 mb-1",children:["Start Time ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",id:"start_time_military",name:"start_time_military",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 pr-8",placeholder:"Type: 22, 0800, 1430...",onChange:t=>{t.target.value,C("start_time",t)},disabled:n}),e.jsx(q,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]}),e.jsx("input",{type:"time",id:"start_time",name:"start_time",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:i.start_time,onChange:x,onBlur:t=>L("start_time",t),disabled:n,required:!0})]}),e.jsx("div",{className:"mt-1 text-xs text-gray-500",children:k.start_time&&i.start_time?e.jsx("span",{className:"text-blue-600 font-medium",children:k.start_time}):"Type 22 for 10:00 PM, 0800 for 8:00 AM"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"end_time",className:"block text-sm font-medium text-gray-700 mb-1",children:["End Time ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",id:"end_time_military",name:"end_time_military",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 pr-8",placeholder:"Type: 02, 1600, 2300...",onChange:t=>{t.target.value,C("end_time",t)},disabled:n}),e.jsx(q,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]}),e.jsx("input",{type:"time",id:"end_time",name:"end_time",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:i.end_time,onChange:x,onBlur:t=>L("end_time",t),disabled:n,required:!0})]}),e.jsx("div",{className:"mt-1 text-xs text-gray-500",children:k.end_time&&i.end_time?e.jsx("span",{className:"text-blue-600 font-medium",children:k.end_time}):"Type 2 for 2:00 AM, 1430 for 2:30 PM"})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(W,{className:"h-5 w-5 text-blue-600 mt-0.5 mr-2 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Military Time Quick Entry:"}),e.jsxs("ul",{className:"text-xs space-y-1",children:[e.jsxs("li",{children:["• Type ",e.jsx("strong",{children:"22"})," in text field → 22:00 (10:00 PM)"]}),e.jsxs("li",{children:["• Type ",e.jsx("strong",{children:"0800"})," → 08:00 (8:00 AM)"]}),e.jsxs("li",{children:["• Type ",e.jsx("strong",{children:"1430"})," → 14:30 (2:30 PM)"]}),e.jsxs("li",{children:["• Type ",e.jsx("strong",{children:"2"})," → 02:00 (2:00 AM)"]}),e.jsx("li",{children:"• Or use the time picker below for manual selection"})]})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"button",onClick:V,className:"text-xs text-indigo-600 hover:text-indigo-800 flex items-center disabled:opacity-50",disabled:n,children:[e.jsx(W,{className:"h-3 w-3 mr-1"}),"Auto-detect overtime type"]})}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"overtime_hours",className:"block text-sm font-medium text-gray-700 mb-1",children:["Overtime Hours ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"number",id:"overtime_hours",name:"overtime_hours",step:"0.25",min:"0.25",max:"24",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:i.overtime_hours,onChange:x,disabled:n,required:!0,placeholder:"Enter overtime hours (e.g., 3.5)"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter the actual overtime hours worked (0.25 to 24 hours, in 15-minute increments)."})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"overtime_type",className:"block text-sm font-medium text-gray-700 mb-1",children:["Overtime Type ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("select",{id:"overtime_type",name:"overtime_type",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:i.overtime_type,onChange:x,disabled:n,required:!0,children:Object.entries(K).map(([t,s])=>e.jsx("option",{value:t,children:s},t))}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Select the category that best describes this overtime work."})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"has_night_differential",name:"has_night_differential",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",checked:i.has_night_differential,onChange:x,disabled:n}),e.jsx("label",{htmlFor:"has_night_differential",className:"ml-2 block text-sm text-gray-700",children:"Night Differential (10PM - 6AM)"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Check this if any part of the overtime work falls between 10PM and 6AM."})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{htmlFor:"rate_multiplier",className:"block text-sm font-medium text-gray-700 mb-1",children:["Rate Type ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("button",{type:"button",onClick:()=>P(!0),className:"text-indigo-600 hover:text-indigo-800 flex items-center text-xs focus:outline-none disabled:opacity-50",disabled:n,children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),"Rate Guide"]})]}),e.jsxs("select",{id:"rate_multiplier",name:"rate_multiplier",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:i.rate_multiplier,onChange:x,disabled:n,required:!0,children:[e.jsx("optgroup",{label:"Regular Work Hours",children:e.jsx("option",{value:"1.25",children:"Ordinary Weekday Overtime (125%)"})}),e.jsxs("optgroup",{label:"Special Days - Regular Hours",children:[e.jsx("option",{value:"1.30",children:"Rest Day/Special Day (130%)"}),e.jsx("option",{value:"1.50",children:"Scheduled Rest Day (150%)"}),e.jsx("option",{value:"2.00",children:"Regular Holiday (200%)"})]}),e.jsxs("optgroup",{label:"Special Days - Overtime",children:[e.jsx("option",{value:"1.69",children:"Rest Day/Special Day Overtime (169%)"}),e.jsx("option",{value:"1.95",children:"Scheduled Rest Day Overtime (195%)"}),e.jsx("option",{value:"2.60",children:"Regular Holiday Overtime (260%)"})]}),e.jsxs("optgroup",{label:"Night Shift Differential",children:[e.jsx("option",{value:"1.375",children:"Ordinary Weekday Overtime + Night Differential (137.5%)"}),e.jsx("option",{value:"1.43",children:"Rest Day/Special Day + Night Differential (143%)"}),e.jsx("option",{value:"1.65",children:"Scheduled Rest Day + Night Differential (165%)"}),e.jsx("option",{value:"2.20",children:"Regular Holiday + Night Differential (220%)"}),e.jsx("option",{value:"1.859",children:"Rest Day/Special Day Overtime + Night Differential (185.9%)"}),e.jsx("option",{value:"2.145",children:"Scheduled Rest Day Overtime + Night Differential (214.5%)"}),e.jsx("option",{value:"2.86",children:"Regular Holiday Overtime + Night Differential (286%)"})]})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Select the appropriate rate type based on when the overtime was performed."})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Reason for Overtime"}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-1",children:["Reason ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("textarea",{id:"reason",name:"reason",rows:"5",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",placeholder:"Provide a detailed reason for the overtime request",value:i.reason,onChange:x,disabled:n,required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Please provide a clear justification for the overtime work."})]})]})]}),e.jsx("div",{className:"px-4 py-3 bg-gray-50 text-right sm:px-6 border-t",children:e.jsx("button",{type:"submit",className:"inline-flex justify-center items-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):"Submit Overtime Request"})})]}),e.jsx(ie,{isOpen:Q&&!n,onClose:()=>P(!1)})]})};export{pe as default};
