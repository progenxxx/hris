import{r as c,j as e,b as y}from"./app-D-TNKEQL.js";import{y as g}from"./index-D8OgU6sH.js";import{L as u}from"./loader-circle-D5iasq1K.js";import{M as w}from"./map-pin-CjLaSfKC.js";import{C as k}from"./clock-D8g538AG.js";import{C as m}from"./circle-check-big-BKozuvyq.js";import{C as f}from"./circle-x-Ty60vMKt.js";import"./clsx-B-dksMZM.js";import"./createLucideIcon-DEWnkTLV.js";const T=({selectedCount:r,onClose:x,onSubmit:A,userRoles:p={}})=>{const[s,l]=c.useState("approved"),[i,v]=c.useState(""),[a,n]=c.useState(!1),[h,j]=c.useState(!1),b=()=>{if(a)return;if(s==="rejected"&&!i.trim()){alert("Please provide remarks for rejection");return}if(s==="force_approved"&&!i.trim()){alert("Please provide remarks for force approval");return}n(!0);const t=Array.isArray(r)?r:typeof r=="string"&&r.startsWith("[")?JSON.parse(r):[r];y.post(route("travel-orders.bulkUpdateStatus"),{travel_order_ids:t,status:s,remarks:i},{preserveScroll:!0,onSuccess:()=>{const d=s==="rejected"?"rejected":s==="force_approved"?"force approved":s==="completed"?"marked as completed":s==="cancelled"?"cancelled":"approved";j(!0),g.success(`Successfully ${d} ${Array.isArray(t)?t.length:1} travel order${Array.isArray(t)&&t.length!==1?"s":""}`),setTimeout(()=>{x(),n(!1),window.location.reload()},2e3)},onError:d=>{console.error("Error in bulk action:",d),g.error("Failed to process bulk action. Please try again."),n(!1)}})},o=(()=>{switch(s){case"approved":return{className:"bg-green-600 hover:bg-green-700 focus:ring-green-500",text:"Approve All",icon:m};case"rejected":return{className:"bg-red-600 hover:bg-red-700 focus:ring-red-500",text:"Reject All",icon:f};case"completed":return{className:"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500",text:"Mark All Completed",icon:m};case"cancelled":return{className:"bg-gray-600 hover:bg-gray-700 focus:ring-gray-500",text:"Cancel All",icon:f};case"force_approved":return{className:"bg-purple-600 hover:bg-purple-700 focus:ring-purple-500",text:"Force Approve All",icon:m};default:return{className:"bg-indigo-600 hover:bg-indigo-700 focus:ring-indigo-500",text:"Update All",icon:k}}})(),N=o.icon;return e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"â€‹"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full relative",children:[a&&!h&&e.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx(u,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-indigo-600"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Processing bulk action..."}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Please wait, this may take a moment."})]})}),h?e.jsxs("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 text-center",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-24 w-24 rounded-full bg-green-100 mb-4",children:e.jsx("svg",{className:"h-16 w-16 text-green-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Bulk Action Successful!"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"The selected travel orders have been processed."}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:e.jsx("p",{className:"text-sm text-green-700",children:"Refreshing the travel order list..."})})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-indigo-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx(w,{className:"h-6 w-6 text-indigo-600"})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[e.jsxs("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:["Bulk Update ",Array.isArray(r)?r.length:typeof r=="string"&&r.startsWith("[")?JSON.parse(r).length:r," Travel Order",r!==1?"s":""]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Action to Perform"}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",className:"form-radio text-green-600",name:"status",value:"approved",checked:s==="approved",onChange:()=>l("approved"),disabled:a}),e.jsx("span",{className:"ml-2 text-gray-700",children:"Approve"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",className:"form-radio text-red-600",name:"status",value:"rejected",checked:s==="rejected",onChange:()=>l("rejected"),disabled:a}),e.jsx("span",{className:"ml-2 text-gray-700",children:"Reject"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",className:"form-radio text-blue-600",name:"status",value:"completed",checked:s==="completed",onChange:()=>l("completed"),disabled:a}),e.jsx("span",{className:"ml-2 text-gray-700",children:"Mark as Completed"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",className:"form-radio text-gray-600",name:"status",value:"cancelled",checked:s==="cancelled",onChange:()=>l("cancelled"),disabled:a}),e.jsx("span",{className:"ml-2 text-gray-700",children:"Cancel"})]}),p&&p.isSuperAdmin&&e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",className:"form-radio text-purple-600",name:"status",value:"force_approved",checked:s==="force_approved",onChange:()=>l("force_approved"),disabled:a}),e.jsx("span",{className:"ml-2 text-gray-700",children:"Force Approve (Admin Override)"})]})]})]}),s==="force_approved"&&e.jsx("div",{className:"mb-4 bg-yellow-50 p-3 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-yellow-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-yellow-700",children:"Force approving will bypass normal approval workflow. This action will be logged."})})]})}),s==="cancelled"&&e.jsx("div",{className:"mb-4 bg-red-50 p-3 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:"Cancelling travel orders cannot be undone. Please ensure this is the correct action."})})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Remarks ",(s==="rejected"||s==="force_approved"||s==="cancelled")&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",rows:3,value:i,onChange:t=>v(t.target.value),placeholder:`Enter remarks for travel order ${s==="rejected"?"rejection":s==="cancelled"?"cancellation":"update"}`,disabled:a}),s==="rejected"&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Remarks are required when rejecting travel orders"}),s==="force_approved"&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Please provide a reason for the administrative override"}),s==="cancelled"&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Please provide a reason for cancelling these travel orders"})]})]})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",className:`w-full inline-flex justify-center items-center rounded-md border border-transparent shadow-sm px-4 py-2 ${o.className} text-base font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed`,onClick:b,disabled:a||(s==="rejected"||s==="force_approved"||s==="cancelled")&&!i.trim(),children:a?e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),o.text]})}),e.jsx("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50",onClick:x,disabled:a,children:"Cancel"})]})]})]})]})})};export{T as default};
