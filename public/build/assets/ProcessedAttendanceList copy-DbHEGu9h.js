import{a as Me,r as a,j as e,H as Ue}from"./app-7K62fd2B.js";import{A as Oe}from"./AuthenticatedLayout-DQzQmHv9.js";import{S as Le}from"./Sidebar-Bpho9Ubl.js";import{A as oe,a as de}from"./alert-Cw6Swk3l.js";import{B as d}from"./Button-B-ixrUdq.js";import{C as R,a as qe,b as Xe,c as P}from"./card-Bd2He_oM.js";import He from"./AttendanceEditModal-cKqLB9-6.js";import{R as A}from"./refresh-cw-DqcGqKqT.js";import{D as $e}from"./download-DiYogtYp.js";import{T as Y}from"./trash-2-CLTfogtc.js";import{T as me}from"./triangle-alert-BFKAbd31.js";import{C as xe}from"./circle-check-big-CdHds-fH.js";import{S as ze}from"./search-BmV-knWW.js";import{C as Ie}from"./calendar-CWo9dUpk.js";import{F as Be}from"./filter-XhO_ib2u.js";import{U as We}from"./users-D-OfZtV9.js";import{S as pe}from"./square-pen-BeqsqNZt.js";import{F as Je}from"./file-text-B0cEX_Vi.js";import{C as Ke}from"./clock-r6FcyLKi.js";import{X as Ve}from"./x-4sBMcqny.js";import"./ApplicationLogo-IpRttWhS.js";import"./Dropdown-Yo6Rw43S.js";import"./transition-Di9UDWSH.js";import"./createLucideIcon-BK5csKvN.js";/* empty css                */import"./clsx-B-dksMZM.js";import"./sun-DGcVySav.js";import"./car-HfwOmSbn.js";import"./info-CNKW5Dcc.js";import"./loader-circle-CCcIPQox.js";import"./save-BqIq9Yvz.js";const Tt=()=>{const{auth:ue,attendances:z=[],pagination:F={}}=Me().props,[j,M]=a.useState(z),[he,G]=a.useState(!1),[I,Q]=a.useState(!1),[B,Z]=a.useState(!1),[U,n]=a.useState(""),[O,x]=a.useState(""),[c,u]=a.useState(F.current_page||1),[p,ge]=a.useState(F.last_page||1),[fe,Ye]=a.useState(F.per_page||25),[S,ee]=a.useState(""),[_,te]=a.useState(""),[C,se]=a.useState(""),[W,re]=a.useState(!1),[ae,ye]=a.useState([]),[ne,J]=a.useState(null),[le,L]=a.useState(!1),[f,b]=a.useState([]),[je,q]=a.useState(!1),[Ne,T]=a.useState(!1),[D,X]=a.useState("selected"),[k,H]=a.useState({start_date:"",end_date:"",employee_id:"",department:""}),[ie,K]=a.useState(!1),h=a.useRef(null),y=a.useRef(!1);a.useEffect(()=>{if(O){const t=setTimeout(()=>x(""),5e3);return()=>clearTimeout(t)}},[O]),a.useEffect(()=>{if(U){const t=setTimeout(()=>n(""),1e4);return()=>clearTimeout(t)}},[U]),a.useEffect(()=>()=>{h.current&&clearTimeout(h.current)},[]);const we=t=>{if(!t)return"-";try{const s=new Date(t);return isNaN(s.getTime())?"-":s.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})}catch(s){return console.error("Date formatting error:",s),"-"}},E=t=>{if(!t)return"-";try{let s;if(t.includes("T")){const[,w]=t.split("T");s=w.slice(0,5)}else if(t.includes(" ")&&t.includes(":")){const w=t.split(" ");s=w[w.length-1].slice(0,5)}else if(t.includes(":"))s=t.slice(0,5);else return console.log("Unrecognized time format:",t),"-";const r=s.split(":");if(r.length<2)return console.log("Invalid time format, missing colon:",t),"-";const i=r[0],l=r[1],o=parseInt(i,10),m=parseInt(l,10);if(isNaN(o)||isNaN(m))return console.log("Invalid hour or minute values:",i,l),"-";const v=o>=12?"PM":"AM";return`${o%12||12}:${l.padStart(2,"0")} ${v}`}catch(s){return console.error("Time formatting error:",s,"for timeString:",t),"-"}},V=a.useCallback(t=>t.map(s=>{if(!s.employee_name&&s.employee?s.employee_name=`${s.employee.Fname||""} ${s.employee.Lname||""}`.trim():s.employee_name||(s.employee_name="Unknown Employee"),!s.department&&s.employee?s.department=s.employee.Department||"N/A":s.department||(s.department="N/A"),!s.idno&&s.employee?s.idno=s.employee.idno||"N/A":s.idno||(s.idno="N/A"),!s.day&&s.attendance_date){const r=new Date(s.attendance_date);isNaN(r.getTime())||(s.day=r.toLocaleDateString("en-US",{weekday:"long"}))}return s}),[]),be=async()=>{try{const s=await(await fetch("/attendance/departments",{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}})).json();s.success&&ye(s.data)}catch(t){console.error("Error loading departments:",t)}},N=async()=>{G(!0),n("");try{const t=new URLSearchParams;t.append("page",c),t.append("per_page",fe),S&&t.append("search",S),_&&t.append("date",_),C&&t.append("department",C),W&&t.append("edits_only","true");const r=await(await fetch("/attendance/list?"+t.toString(),{headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}})).json();if(r.success){const i=V(r.data);M(i),ge(r.pagination.last_page),u(r.pagination.current_page),b([]),q(!1)}else n("Failed to load attendance data")}catch(t){console.error("Error loading attendance data:",t),n("Error loading attendance data: "+(t.message||"Unknown error"))}finally{G(!1)}},ke=async()=>{Z(!0),n("");try{const t=new URLSearchParams;S&&t.append("search",S),_&&t.append("date",_),C&&t.append("department",C),W&&t.append("edits_only","true");const s="/attendance/export?"+t.toString(),r=document.createElement("a");r.href=s,r.download="attendance_export.csv",document.body.appendChild(r),r.click(),document.body.removeChild(r),x("Export started. Check your downloads folder.")}catch(t){console.error("Error exporting attendance data:",t),n("Error exporting attendance data: "+(t.message||"Unknown error"))}finally{Z(!1)}},ve=async()=>{Q(!0),n(""),x("");try{const t=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),s=new Date;s.setDate(1);const r=new Date;r.setMonth(r.getMonth()+1,0);const l=await(await fetch("/attendance/sync",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:JSON.stringify({start_date:s.toISOString().split("T")[0],end_date:r.toISOString().split("T")[0]})})).json();if(l.success){if(x(l.message),l.details){const o=l.details;let m=`Sync completed: ${o.synced_count} records updated`;o.created_records>0&&(m+=`, ${o.created_records} new records created`),o.error_count>0&&(m+=`, ${o.error_count} errors occurred`),m+=` (Total processed: ${o.total_processed})`,x(m)}await N()}else n("Sync failed: "+(l.message||"Unknown error"))}catch(t){console.error("Error syncing attendance data:",t),n("Error syncing attendance data: "+(t.message||"Unknown error"))}finally{Q(!1)}},Se=(t,s)=>{t.stopPropagation(),t.target.checked?b(i=>[...i,s]):(b(i=>i.filter(l=>l!==s)),q(!1))},_e=t=>{q(t),b(t?j.map(s=>s.id):[])},Ce=async()=>{if(f.length===0&&D==="selected"){n("Please select at least one record to delete");return}K(!0),n("");try{const t=document.querySelector('meta[name="csrf-token"]').getAttribute("content");let s={};if(D==="selected")s.ids=f;else{if(!k.start_date||!k.end_date){n("Please specify both start and end dates for range delete"),K(!1);return}s={...k}}const i=await(await fetch("/attendance/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:JSON.stringify(s)})).json();i.success?(x(i.message),T(!1),b([]),q(!1),H({start_date:"",end_date:"",employee_id:"",department:""}),await N()):n("Delete failed: "+(i.message||"Unknown error"))}catch(t){console.error("Error deleting attendance data:",t),n("Error deleting attendance data: "+(t.message||"Unknown error"))}finally{K(!1)}};a.useEffect(()=>{if(be(),z.length>0){const t=V(z);M(t)}else N()},[]),a.useEffect(()=>{c!==F.current_page&&N()},[c]);const Te=()=>{u(1),N()},De=()=>{ee(""),te(""),se(""),re(!1),u(1),setTimeout(()=>{N()},0)},Ee=a.useCallback((t,s)=>{if(t.stopPropagation(),t.preventDefault(),y.current){console.log("Edit already in progress, ignoring click");return}h.current&&clearTimeout(h.current),y.current=!0,console.log("Edit clicked for:",s.id),J(s),L(!0),h.current=setTimeout(()=>{y.current=!1},1e3)},[]),Re=a.useCallback((t,s)=>{if(t.preventDefault(),t.stopPropagation(),y.current){console.log("Edit already in progress, ignoring double-click");return}h.current&&clearTimeout(h.current),y.current=!0,console.log("Row double-clicked for:",s.id,s.employee_name),J(s),L(!0),h.current=setTimeout(()=>{y.current=!1},1e3)},[]),Pe=()=>{L(!1),J(null),n(""),x(""),y.current=!1,h.current&&clearTimeout(h.current)},Ae=async t=>{var s;try{n(""),x("");const r=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content");if(!r){n("Session expired. Please refresh the page and try again.");return}const i={id:t.id,time_in:t.time_in,break_in:t.break_in,break_out:t.break_out,time_out:t.time_out,next_day_timeout:t.next_day_timeout,is_nightshift:t.is_nightshift},l=await fetch(`/attendance/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":r,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"},body:JSON.stringify(i)});if(l.status===401){n("Session expired. Please refresh the page and login again.");return}if(l.status===419){n("Security token expired. Please refresh the page and try again.");return}if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const o=l.headers.get("content-type");if(!o||!o.includes("application/json")){x("Update completed successfully!"),window.location.reload();return}const m=await l.json();if(m.success){x("Attendance record updated successfully");const v={...m.data,source:"manual_edit",is_edited:!0};M(ce=>ce.map(w=>w.id===t.id?v:w)),L(!1)}else m.redirect?(n("Session expired. Redirecting to login..."),setTimeout(()=>{window.location.href=m.redirect},2e3)):n("Failed to update attendance: "+(m.message||"Unknown error"))}catch(r){console.error("Error updating attendance:",r),r.name==="TypeError"&&r.message.includes("Failed to fetch")?n("Network error. Please check your internet connection and try again."):r.message.includes("non-JSON response")?(x("Update completed successfully!"),window.location.reload()):r.message.includes("HTTP error")?n(`Server error (${r.message}). Please try again or contact support.`):n("Error updating attendance: "+(r.message||"Unknown error"))}},Fe=async t=>{var s;try{n(""),x("");const r=(s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content");if(!r){n("Session expired. Please refresh the page and try again.");return}const i=await fetch(`/attendance/${t}/sync`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":r,"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const l=await i.json();if(l.success){if(x(l.message),l.updated&&l.data){const o=V([l.data])[0];M(m=>m.map(v=>v.id===t?o:v))}await N()}else n("Sync failed: "+(l.message||"Unknown error"))}catch(r){console.error("Error syncing individual attendance record:",r),n("Error syncing attendance record: "+(r.message||"Unknown error"))}};j.length>0&&j.every(t=>f.includes(t.id));const g=(t,s=2)=>t==null||t===""||isNaN(Number(t))?"-":Number(t).toFixed(s),$=(t,s="boolean")=>{if(s==="boolean")return t?e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Yes"}):e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-500",children:"No"});if(s==="source"){const r={import:"bg-blue-100 text-blue-800",manual:"bg-yellow-100 text-yellow-800",biometric:"bg-green-100 text-green-800",manual_edit:"bg-red-100 text-red-800",slvl_sync:"bg-indigo-100 text-indigo-800"},i={manual_edit:"Edited",slvl_sync:"SLVL"},l=r[t]||"bg-gray-100 text-gray-800",o=i[t]||(t?t.charAt(0).toUpperCase()+t.slice(1):"Unknown");return e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${l}`,children:o})}return t||"-"};return e.jsxs(Oe,{user:ue.user,children:[e.jsx(Ue,{title:"Processed Attendance List"}),e.jsxs("div",{className:"flex min-h-screen bg-gray-50/50",children:[e.jsx(Le,{}),e.jsx("div",{className:"flex-1 p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Processed Attendance Records"}),e.jsx("p",{className:"text-gray-600",children:"View and manage processed attendance records with edit history tracking."}),e.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"ðŸ’¡ Tip: Double-click any row to quickly edit attendance times"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(d,{onClick:ke,disabled:B,variant:"outline",className:"bg-green-600 hover:bg-green-700 text-white border-green-600",children:[B?e.jsx(A,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx($e,{className:"h-4 w-4 mr-2"}),B?"Exporting...":"Export"]}),f.length>0&&e.jsxs(d,{onClick:()=>{X("selected"),T(!0)},variant:"outline",className:"bg-red-600 hover:bg-red-700 text-white border-red-600",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Delete (",f.length,")"]}),e.jsxs(d,{onClick:()=>{X("range"),T(!0)},variant:"outline",className:"bg-red-600 hover:bg-red-700 text-white border-red-600",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Delete Range"]}),e.jsxs(d,{onClick:ve,disabled:I,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[I?e.jsx(A,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(A,{className:"h-4 w-4 mr-2"}),I?"Syncing...":"Sync Data"]})]})]}),U&&e.jsxs(oe,{variant:"destructive",className:"mb-4",children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),e.jsx(de,{children:U})]}),O&&e.jsxs(oe,{className:"mb-4 border-green-200 bg-green-50",children:[e.jsx(xe,{className:"h-4 w-4 mr-2 text-green-600"}),e.jsx(de,{className:"text-green-800",children:O})]}),e.jsxs(R,{className:"mb-6",children:[e.jsx(qe,{className:"pb-3",children:e.jsx(Xe,{className:"text-lg",children:"Filters"})}),e.jsxs(P,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Search by ID or Name...",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:S,onChange:t=>ee(t.target.value)})]}),e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsx(Ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"date",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:_,onChange:t=>te(t.target.value)})]})}),e.jsx("div",{children:e.jsxs("select",{className:"w-full pl-4 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:C,onChange:t=>se(t.target.value),children:[e.jsx("option",{value:"",children:"All Departments"}),ae.map(t=>e.jsx("option",{value:t,children:t},t))]})}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500",checked:W,onChange:t=>re(t.target.checked)}),e.jsx("span",{className:"text-gray-700",children:"Edited Records Only"})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(d,{variant:"outline",onClick:De,children:"Reset"}),e.jsxs(d,{onClick:Te,children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Apply Filters"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(R,{children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(We,{className:"h-8 w-8 text-blue-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Records"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.length})]})]})})}),e.jsx(R,{children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(pe,{className:"h-8 w-8 text-orange-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Edited Records"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.filter(t=>t.source==="manual_edit").length})]})]})})}),e.jsx(R,{children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(xe,{className:"h-8 w-8 text-green-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Selected"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:f.length})]})]})})}),e.jsx(R,{children:e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Je,{className:"h-8 w-8 text-purple-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Current Page"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[c," of ",p]})]})]})})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow h-[60vh] flex flex-col",children:he?e.jsxs("div",{className:"flex justify-center items-center h-full",children:[e.jsx(A,{className:"h-8 w-8 animate-spin text-blue-500"}),e.jsx("span",{className:"ml-2 text-lg",children:"Loading..."})]}):j.length===0?e.jsxs("div",{className:"text-center py-12 flex-1 flex flex-col justify-center",children:[e.jsx(Ke,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:"No attendance records found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your filters or adding new attendance data."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:e.jsx("div",{className:"overflow-x-auto flex-1",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 h-full",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500",checked:je,onChange:t=>_e(t.target.checked)})}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dept"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time In"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Break Out"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Break In"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time Out"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Next Day"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hours"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"OT"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Travel"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SLVL"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CT"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CS"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Holiday"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"OT Reg"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"OT Spl"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Retro"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rest Day"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Offset"}),e.jsx("th",{className:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Source"}),e.jsx("th",{className:"px-2 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 overflow-y-auto",children:j.map(t=>e.jsxs("tr",{className:`hover:bg-gray-50 cursor-pointer transition-colors ${t.source==="manual_edit"?"bg-red-50":""}`,onDoubleClick:s=>Re(s,t),title:"Double-click to edit attendance times",children:[e.jsx("td",{className:"px-2 py-4 whitespace-nowrap",onClick:s=>s.stopPropagation(),children:e.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500",checked:f.includes(t.id),onChange:s=>Se(s,t.id)})}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.employee_name||"Unknown Employee"}),e.jsx("div",{className:"text-xs text-gray-500",children:t.idno||"N/A"})]})})}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:t.department||"N/A"}),e.jsxs("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:[we(t.attendance_date),t.day&&e.jsx("span",{className:"block text-xs mt-1 text-gray-400",children:t.day})]}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:E(t.time_in)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:E(t.break_out)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:E(t.break_in)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:E(t.time_out)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:t.is_nightshift&&t.next_day_timeout?e.jsx("span",{className:"text-purple-600 font-medium",children:E(t.next_day_timeout)}):"-"}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:g(t.hours_worked)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:g(t.overtime)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:g(t.travel_order,1)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:g(t.slvl,1)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:$(t.ct)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:$(t.cs)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:g(t.holiday)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:g(t.ot_reg_holiday)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:g(t.ot_special_holiday)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:g(t.retromultiplier)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:$(t.restday)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-500",children:g(t.offset)}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap",children:$(t.source,"source")}),e.jsx("td",{className:"px-2 py-4 whitespace-nowrap text-right text-sm font-medium",onClick:s=>s.stopPropagation(),children:e.jsxs(d,{variant:"ghost",size:"sm",onClick:s=>Ee(s,t),disabled:y.current,className:"text-blue-600 hover:text-blue-900 disabled:opacity-50 disabled:cursor-not-allowed",type:"button",children:[e.jsx(pe,{className:"h-4 w-4 mr-1"}),"Edit"]})})]},t.id))})]})})}),e.jsxs("div",{className:"px-6 py-4 flex items-center justify-between border-t border-gray-200 bg-white",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx(d,{onClick:()=>u(Math.max(1,c-1)),disabled:c===1,variant:"outline",size:"sm",children:"Previous"}),e.jsx(d,{onClick:()=>u(Math.min(p,c+1)),disabled:c===p,variant:"outline",size:"sm",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing page ",e.jsx("span",{className:"font-medium",children:c})," of"," ",e.jsx("span",{className:"font-medium",children:p})]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx(d,{onClick:()=>u(1),disabled:c===1,variant:"outline",size:"sm",className:"rounded-l-md",children:"First"}),e.jsx(d,{onClick:()=>u(Math.max(1,c-1)),disabled:c===1,variant:"outline",size:"sm",children:"Previous"}),Array.from({length:Math.min(5,p)},(t,s)=>{const r=c<=3?s+1:c>=p-2?p-4+s:c-2+s;return r>0&&r<=p?e.jsx(d,{onClick:()=>u(r),variant:c===r?"default":"outline",size:"sm",className:c===r?"bg-blue-500 text-white":"",children:r},r):null}),e.jsx(d,{onClick:()=>u(Math.min(p,c+1)),disabled:c===p,variant:"outline",size:"sm",children:"Next"}),e.jsx(d,{onClick:()=>u(p),disabled:c===p,variant:"outline",size:"sm",className:"rounded-r-md",children:"Last"})]})})]})]})]})})]})})]}),le&&ne&&e.jsx(He,{isOpen:le,attendance:ne,onClose:Pe,onSave:Ae,onSync:Fe}),Ne&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center",children:e.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Delete Attendance Records"}),e.jsx("button",{onClick:()=>T(!1),className:"text-gray-500 hover:text-gray-700","aria-label":"Close",children:e.jsx(Ve,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delete Mode"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"deleteMode",value:"selected",checked:D==="selected",onChange:t=>X(t.target.value),className:"mr-2"}),"Delete Selected Records (",f.length," selected)"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"deleteMode",value:"range",checked:D==="range",onChange:t=>X(t.target.value),className:"mr-2"}),"Delete by Date Range"]})]})]}),D==="range"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date *"}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:k.start_date,onChange:t=>H(s=>({...s,start_date:t.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date *"}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:k.end_date,onChange:t=>H(s=>({...s,end_date:t.target.value}))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department (Optional)"}),e.jsxs("select",{className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:k.department,onChange:t=>H(s=>({...s,department:t.target.value})),children:[e.jsx("option",{value:"",children:"All Departments"}),ae.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),e.jsx("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(me,{className:"h-5 w-5 text-red-400 mt-0.5 mr-2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Warning"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:"This action cannot be undone. Are you sure you want to delete the selected attendance records?"})]})]})})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex justify-end space-x-3 border-t",children:[e.jsx(d,{variant:"outline",onClick:()=>T(!1),children:"Cancel"}),e.jsx(d,{onClick:Ce,disabled:ie,className:"bg-red-600 hover:bg-red-700 text-white",children:ie?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-4 w-4 mr-2 animate-spin"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Delete"]})})]})]})})]})};export{Tt as default};
