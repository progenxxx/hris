import{a as M,r as f,j as e,H as D,b as g}from"./app-D-TNKEQL.js";import{A as T}from"./AuthenticatedLayout-PCqsYVxf.js";import{S as B}from"./Sidebar-Cg7Kwp5t.js";import H from"./OvertimeList-Dpy_6fHE.js";import U from"./OvertimeForm-j_hgUwvj.js";import{y as i,L as R}from"./index-D8OgU6sH.js";/* empty css                      */import{L as j}from"./loader-circle-D5iasq1K.js";import{C as z}from"./clock-D8g538AG.js";import{P as G}from"./plus-DLMoKXB_.js";import{L as V}from"./list-filter-Cyyshytm.js";import"./ApplicationLogo-Cn-MbvX-.js";import"./Dropdown-BOoMuW7P.js";import"./transition-DeCEAfJ2.js";import"./search-DZDiwkir.js";import"./createLucideIcon-DEWnkTLV.js";import"./x-fQrOvEob.js";/* empty css                */import"./users-Cw0U-ZsC.js";import"./file-text-QjoOwKBJ.js";import"./calendar-DhTYrr3L.js";import"./OvertimeStatusBadge-DDyAaVuK.js";import"./OvertimeDetailModal-DntM32Lu.js";import"./format-Bw_hER4B.js";import"./OvertimeRateEditModal-DikeGtEP.js";import"./triangle-alert-CxlByYdl.js";import"./MultiBulkActionModal-DoJNcXnc.js";import"./clsx-B-dksMZM.js";import"./ForceApproveButton-C-RGP7V0.js";import"./zap-1mqeF5Zv.js";import"./download-Dnq6PCPG.js";import"./OvertimeRateHelpModal-ZSVUP3CJ.js";import"./info-CEwrAHp7.js";const Se=()=>{const{props:y}=M(),{auth:w,flash:n={},userRoles:N={},overtimes:S=[],employees:O=[],departments:P=[],rateMultipliers:L=[]}=y,[h,u]=f.useState(S),[x,A]=f.useState("create"),[a,t]=f.useState(!1),[E,c]=f.useState(!1);f.useEffect(()=>{n&&n.message&&i.success(n.message),n&&n.error&&i.error(n.error)},[n]);const $=s=>new Promise((l,p)=>{t(!0),c(!0),g.post(route("overtimes.store"),s,{preserveScroll:!0,onStart:()=>{},onSuccess:r=>{r.props.overtimes&&u(r.props.overtimes),i.success("Overtime requests created successfully"),t(!1),c(!1),l(r)},onError:r=>{t(!1),c(!1),r&&typeof r=="object"?Object.keys(r).forEach(m=>{i.error(r[m])}):i.error("An error occurred while submitting form"),p(r)},onFinish:()=>{t(!1),c(!1)}})}),k=(s,l)=>{if(a)return Promise.reject("Already processing");const p=Array.isArray(s);p?(console.log(`Batch status update for ${s.length} items`),t(!0),c(!0)):(console.log("Status update called with:",s,l),t(!0));const r=(m,o)=>new Promise((F,q)=>{g.post(route("overtimes.updateStatus",m),o,{preserveScroll:!0,onSuccess:d=>{!p&&d.props.overtimes&&u(d.props.overtimes),F(d)},onError:d=>{let b="An error occurred while updating status";d&&typeof d=="object"&&(b=Object.values(d).join(", ")),q(b)}})});if(p){const m=s.map(o=>r(o,l));return Promise.all(m).then(o=>{o.length>0&&o[o.length-1].props.overtimes&&u(o[o.length-1].props.overtimes),i.success(`Successfully updated ${s.length} overtime requests`),t(!1),c(!1)}).catch(o=>{throw i.error(`Error updating some overtime requests: ${o}`),t(!1),c(!1),o})}else return r(s,l).then(()=>{i.success("Overtime status updated successfully"),t(!1)}).catch(m=>{throw i.error(m),t(!1),m})},C=s=>{confirm("Are you sure you want to delete this overtime request?")&&(t(!0),g.post(route("overtimes.destroy.post",s),{},{preserveScroll:!0,onSuccess:l=>{l.props.overtimes?u(l.props.overtimes):u(h.filter(p=>p.id!==s)),i.success("Overtime deleted successfully"),t(!1)},onError:()=>{i.error("Failed to delete overtime"),t(!1)},onFinish:()=>{t(!1)}}))},v=s=>{a||A(s)};return e.jsxs(T,{user:w.user,children:[e.jsx(D,{title:"Overtime Management"}),e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsx(B,{}),E&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg text-center",children:[e.jsx(j,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-indigo-600"}),e.jsx("p",{className:"text-gray-700",children:"Processing overtime requests..."})]})}),e.jsx("div",{className:"flex-1 p-8 ml-0",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:[e.jsx(z,{className:"inline-block w-7 h-7 mr-2 text-indigo-600"}),"Overtime Management"]}),e.jsx("p",{className:"text-gray-600",children:"Manage employee overtime requests and approvals"})]}),a&&e.jsxs("div",{className:"flex items-center text-indigo-600",children:[e.jsx(j,{className:"h-5 w-5 animate-spin mr-2"}),e.jsx("span",{className:"text-sm",children:"Processing..."})]})]}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{className:`${x==="create"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center transition-colors ${a?"opacity-50 cursor-not-allowed":""}`,onClick:()=>v("create"),disabled:a,children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"File New Overtime"]}),e.jsxs("button",{className:`${x==="list"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center transition-colors ${a?"opacity-50 cursor-not-allowed":""}`,onClick:()=>v("list"),disabled:a,children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"View Overtimes",h.length>0&&e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs",children:h.length})]})]})})}),e.jsx("div",{className:`transition-opacity duration-200 ${a?"opacity-50":""}`,children:x==="list"?e.jsx(H,{overtimes:h,onStatusUpdate:k,onDelete:C,userRoles:N,processing:a}):e.jsx(U,{employees:O,departments:P,rateMultipliers:L,onSubmit:$,processing:a})})]})})]})})]}),e.jsx(R,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})};export{Se as default};
