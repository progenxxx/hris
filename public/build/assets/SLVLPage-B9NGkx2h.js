import{a as A,r as u,j as e,H as k,b as h}from"./app-7K62fd2B.js";import{A as P}from"./AuthenticatedLayout-DQzQmHv9.js";import{S as M}from"./Sidebar-Bpho9Ubl.js";import V from"./SLVLList-DilBpOw0.js";import $ from"./SLVLForm-C-DoE6ox.js";import{y as a,L as B}from"./index-DkMCAIk8.js";/* empty css                      */import"./ApplicationLogo-IpRttWhS.js";import"./Dropdown-Yo6Rw43S.js";import"./transition-Di9UDWSH.js";import"./search-BmV-knWW.js";import"./createLucideIcon-BK5csKvN.js";import"./x-4sBMcqny.js";/* empty css                */import"./users-D-OfZtV9.js";import"./file-text-B0cEX_Vi.js";import"./calendar-CWo9dUpk.js";import"./SLVLStatusBadge-CBHqwlix.js";import"./SLVLDetailModal-CDbdQIJG.js";import"./format-Bw_hER4B.js";import"./MultiBulkActionModal-Dwin3OrY.js";import"./download-DiYogtYp.js";import"./clsx-B-dksMZM.js";const oe=()=>{const{props:m}=A(),{auth:C,flash:o={}}=m,[x,c]=u.useState(m.leaves||[]),[p,d]=u.useState("list"),[g,v]=u.useState(!1),y=m.employees||[],j=m.departments||[],L=[{value:"sick",label:"Sick Leave"},{value:"vacation",label:"Vacation Leave"},{value:"emergency",label:"Emergency Leave"},{value:"bereavement",label:"Bereavement Leave"},{value:"maternity",label:"Maternity Leave"},{value:"paternity",label:"Paternity Leave"}];u.useEffect(()=>{o&&o.message&&a.success(o.message),o&&o.error&&a.error(o.error)},[o]);const S=t=>{h.post(route("slvl.store"),t,{onSuccess:s=>{s.props.leaves&&c(s.props.leaves),a.success("Leave requests created successfully"),d("list")},onError:s=>{s&&typeof s=="object"?Object.keys(s).forEach(l=>{a.error(s[l])}):a.error("An error occurred while submitting form")}})},w=(t,s)=>{if(g)return;const l=Array.isArray(t);l?(console.log(`Batch status update for ${t.length} items`),v(!0)):console.log("Status update called with:",t,s);const f=(n,r)=>new Promise((E,q)=>{h.post(route("slvl.updateStatus",n),r,{preserveScroll:!0,onSuccess:i=>{!l&&i.props.leaves&&c(i.props.leaves),E(i)},onError:i=>{let b="An error occurred while updating status";i&&typeof i=="object"&&(b=Object.values(i).join(", ")),q(b)}})});if(!l)f(t,s).then(()=>{a.success("Leave status updated successfully")}).catch(n=>{a.error(n)});else{const n=t.map(r=>f(r,s));Promise.all(n).then(r=>{r.length>0&&r[r.length-1].props.leaves&&c(r[r.length-1].props.leaves),a.success(`Successfully updated ${t.length} leave requests`),v(!1)}).catch(r=>{a.error(`Error updating some leave requests: ${r}`),v(!1)})}},N=t=>{confirm("Are you sure you want to delete this leave request?")&&h.delete(route("slvl.destroy",t),{preserveScroll:!0,onSuccess:s=>{s.props.leaves?c(s.props.leaves):c(x.filter(l=>l.id!==t)),a.success("Leave request deleted successfully")},onError:()=>a.error("Failed to delete leave request")})};return e.jsxs(P,{children:[e.jsx(k,{title:"Leave Management"}),e.jsxs("div",{className:"flex min-h-screen bg-gray-50/50",children:[e.jsx("div",{className:"fixed h-screen",children:e.jsx(M,{})}),e.jsx("div",{className:"flex-1 p-8 ml-64",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Leave Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage employee sick leave and vacation leave requests."})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{className:`${p==="list"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,onClick:()=>d("list"),children:"View Leave Requests"}),e.jsx("button",{className:`${p==="create"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,onClick:()=>d("create"),children:"File New Leave"})]})})}),p==="list"?e.jsx(V,{leaves:x,onStatusUpdate:w,onDelete:N}):e.jsx($,{employees:y,departments:j,leaveTypes:L,onSubmit:S})]})})]})})]}),e.jsx(B,{position:"top-right",autoClose:3e3})]})};export{oe as default};
