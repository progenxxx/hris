import{r as c,j as e}from"./app-7K62fd2B.js";import{f as D}from"./format-Bw_hER4B.js";const q=({employees:m,departments:j,leaveTypes:n,onSubmit:b})=>{const x=D(new Date,"yyyy-MM-dd"),[t,l]=c.useState({employee_ids:[],type:n.length>0?n[0].value:"sick",start_date:x,end_date:x,reason:"",half_day:!1,am_pm:"am",with_pay:!0,documents:null}),[o,N]=c.useState(m||[]),[u,g]=c.useState(""),[h,f]=c.useState("");c.useEffect(()=>{let s=m||[];if(u){const a=u.toLowerCase();s=s.filter(i=>{var d;return i.Fname.toLowerCase().includes(a)||i.Lname.toLowerCase().includes(a)||((d=i.idno)==null?void 0:d.toString().includes(a))})}h&&(s=s.filter(a=>a.Department===h)),N(s)},[u,h,m]);const r=s=>{const{name:a,value:i,type:d,checked:p}=s.target;l({...t,[a]:d==="checkbox"?p:i})},_=s=>{l({...t,documents:s.target.files[0]})},v=s=>{const a=parseInt(s,10);l(i=>i.employee_ids.includes(a)?{...i,employee_ids:i.employee_ids.filter(d=>d!==a)}:{...i,employee_ids:[...i.employee_ids,a]})},w=()=>{l(s=>{const a=o.map(d=>d.id);if(a.every(d=>s.employee_ids.includes(d)))return{...s,employee_ids:s.employee_ids.filter(d=>!a.includes(d))};{const d=s.employee_ids.filter(p=>!a.includes(p));return{...s,employee_ids:[...d,...a]}}})},k=()=>{if(!t.start_date||!t.end_date)return 0;const s=new Date(t.start_date),a=new Date(t.end_date);if(isNaN(s.getTime())||isNaN(a.getTime())||a<s)return 0;const i=Math.abs(a-s),d=Math.ceil(i/(1e3*60*60*24))+1;return t.half_day?d-.5:d},S=s=>{if(s.preventDefault(),t.employee_ids.length===0){alert("Please select at least one employee");return}if(!t.start_date||!t.end_date){alert("Please fill in all required date fields");return}if(new Date(t.end_date)<new Date(t.start_date)){alert("End date must be on or after start date");return}if(!t.reason.trim()){alert("Please provide a reason for the leave");return}const a=new FormData;for(const i in t)i==="employee_ids"?t.employee_ids.forEach(d=>{a.append("employee_ids[]",d)}):i==="documents"?t.documents&&a.append("documents",t.documents):a.append(i,t[i]);b(a),l({employee_ids:[],type:n.length>0?n[0].value:"sick",start_date:x,end_date:x,reason:"",half_day:!1,am_pm:"am",with_pay:!0,documents:null}),g(""),f("")},y=o.length>0&&o.every(s=>t.employee_ids.includes(s.id)),C=m.filter(s=>t.employee_ids.includes(s.id));return e.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"File New Leave"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Create leave request for one or multiple employees"})]}),e.jsxs("form",{onSubmit:S,children:[e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Select Employees"}),e.jsxs("div",{className:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2 mb-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by name or ID",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:u,onChange:s=>g(s.target.value)})}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:h,onChange:s=>f(s.target.value),children:[e.jsx("option",{value:"",children:"All Departments"}),j.map((s,a)=>e.jsx("option",{value:s,children:s},a))]})}),e.jsx("div",{className:"md:flex-initial",children:e.jsx("button",{type:"button",className:`w-full px-4 py-2 rounded-md ${y?"bg-indigo-700 hover:bg-indigo-800":"bg-indigo-500 hover:bg-indigo-600"} text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`,onClick:w,children:y?"Deselect All":"Select All"})})]}),e.jsx("div",{className:"border rounded-md overflow-hidden max-h-60 overflow-y-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12",children:"Select"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-4 py-3 text-center text-sm text-gray-500",children:"No employees match your search criteria"})}):o.map(s=>e.jsxs("tr",{className:`hover:bg-gray-50 cursor-pointer ${t.employee_ids.includes(s.id)?"bg-indigo-50":""}`,onClick:()=>v(s.id),children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",checked:t.employee_ids.includes(s.id),onChange:()=>{},onClick:a=>a.stopPropagation()})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:s.idno}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.Lname,", ",s.Fname," ",s.MName||""]})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:s.Department}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:s.Jobtitle})]},s.id))})]})}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:t.employee_ids.length>0?e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium",children:[t.employee_ids.length," employee(s) selected"]}),t.employee_ids.length<=5&&e.jsxs("span",{className:"ml-2",children:["(",C.map(s=>s.Lname).join(", "),")"]})]}):e.jsx("span",{className:"text-yellow-600",children:"No employees selected"})})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Leave Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700 mb-1",children:["Leave Type ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("select",{id:"type",name:"type",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:t.type,onChange:r,required:!0,children:n.map((s,a)=>e.jsx("option",{value:s.value,children:s.label},a))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"start_date",className:"block text-sm font-medium text-gray-700 mb-1",children:["Start Date ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"date",id:"start_date",name:"start_date",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:t.start_date,onChange:r,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"end_date",className:"block text-sm font-medium text-gray-700 mb-1",children:["End Date ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"date",id:"end_date",name:"end_date",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:t.end_date,onChange:r,required:!0})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"half_day",name:"half_day",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",checked:t.half_day,onChange:r}),e.jsx("label",{htmlFor:"half_day",className:"ml-2 text-sm text-gray-700",children:"Half Day"})]}),t.half_day&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Specify Half-Day"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",className:"form-radio text-indigo-600",name:"am_pm",value:"am",checked:t.am_pm==="am",onChange:r}),e.jsx("span",{className:"ml-2 text-gray-700",children:"AM"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",className:"form-radio text-indigo-600",name:"am_pm",value:"pm",checked:t.am_pm==="pm",onChange:r}),e.jsx("span",{className:"ml-2 text-gray-700",children:"PM"})]})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"with_pay",name:"with_pay",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",checked:t.with_pay,onChange:r}),e.jsx("label",{htmlFor:"with_pay",className:"ml-2 text-sm text-gray-700",children:"With Pay"})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["Total Days: ",e.jsx("span",{className:"font-bold",children:k()})]})})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Reason and Supporting Documents"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-1",children:["Reason ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("textarea",{id:"reason",name:"reason",rows:"5",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",placeholder:"Provide a detailed reason for the leave request",value:t.reason,onChange:r,required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Please provide a clear reason for your leave request."})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"documents",className:"block text-sm font-medium text-gray-700 mb-1",children:["Supporting Documents ",t.type==="sick"&&e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"file",id:"documents",name:"documents",onChange:_,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",required:t.type==="sick"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:t.type==="sick"?"Medical certificate is required for sick leave.":"Upload any relevant supporting documents."})]})]})]})]}),e.jsx("div",{className:"px-4 py-3 bg-gray-50 text-right sm:px-6 border-t",children:e.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Submit Leave Request"})})]})]})};export{q as default};
