import{r as i,j as e,h}from"./app-C_ClQmDY.js";const y=({departments:p,users:s,existingManagers:c=[]})=>{var x;const[r,l]=i.useState({department:"",manager_id:""}),[g,o]=i.useState([]),[n,m]=i.useState("");i.useEffect(()=>{if(s)if(n){const a=n.toLowerCase();o(s.filter(t=>t.name.toLowerCase().includes(a)||t.email&&t.email.toLowerCase().includes(a)))}else o(s)},[n,s]);const u=a=>{const{name:t,value:d}=a.target;l({...r,[t]:d})},f=a=>{if(a.preventDefault(),!r.department||!r.manager_id){alert("Please select both a department and a manager");return}h.post(route("department-managers.store"),r,{preserveScroll:!0,onSuccess:()=>{l({department:"",manager_id:""}),m("")},onError:t=>{if(t&&typeof t=="object"){const d=Object.values(t).join(`
`);alert(`Error: ${d}`)}else alert("An error occurred while saving department manager assignment")}})},j=a=>{confirm("Are you sure you want to remove this department manager assignment?")&&h.delete(route("department-managers.destroy",a),{preserveScroll:!0,onSuccess:()=>{},onError:()=>{alert("Failed to remove department manager assignment")}})};return i.useEffect(()=>{if(r.manager_id){const a=s.find(t=>t.id===parseInt(r.manager_id));a&&m(a.name)}},[r.manager_id,s]),e.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Department Manager Assignments"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Assign managers who will approve overtime requests for each department"})]}),e.jsxs("div",{className:"p-4 grid grid-cols-1 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Current Assignments"}),e.jsx("div",{className:"border rounded-md overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Manager"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"px-4 py-4 text-center text-sm text-gray-500",children:"No department manager assignments found"})}):c.map(a=>{var t,d;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:a.department}),e.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((t=a.manager)==null?void 0:t.name)||"Unknown"}),e.jsx("div",{className:"text-xs text-gray-500",children:((d=a.manager)==null?void 0:d.email)||""})]}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("button",{onClick:()=>j(a.id),className:"text-red-600 hover:text-red-900",children:"Remove"})})]},a.id)})})]})})]}),e.jsxs("form",{onSubmit:f,className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"New Assignment"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700 mb-1",children:["Department ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("select",{id:"department",name:"department",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:r.department,onChange:u,required:!0,children:[e.jsx("option",{value:"",children:"Select a Department"}),p.map((a,t)=>e.jsx("option",{value:a,children:a},t))]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"manager_id",className:"block text-sm font-medium text-gray-700 mb-1",children:["Manager ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search for a manager...",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:n,onChange:a=>m(a.target.value),onFocus:()=>{n||o(s)}}),n&&g.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white shadow-lg rounded-md max-h-60 overflow-y-auto",children:g.map(a=>e.jsxs("div",{className:"px-4 py-2 hover:bg-gray-100 cursor-pointer",onClick:()=>{l({...r,manager_id:a.id}),m(a.name)},children:[e.jsx("div",{className:"font-medium",children:a.name}),e.jsx("div",{className:"text-xs text-gray-500",children:a.email})]},a.id))})]}),e.jsx("input",{type:"hidden",name:"manager_id",value:r.manager_id,required:!0}),r.manager_id&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",((x=s.find(a=>a.id===parseInt(r.manager_id)))==null?void 0:x.name)||""]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Assign Manager"})})]})]})]})};export{y as default};
