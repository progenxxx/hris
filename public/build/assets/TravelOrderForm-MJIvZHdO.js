import{r as l,j as e}from"./app-D-TNKEQL.js";import{f as C}from"./format-Bw_hER4B.js";const q=({employees:c,departments:y,onSubmit:b})=>{const n=C(new Date,"yyyy-MM-dd"),[t,m]=l.useState({employee_ids:[],date:n,destination:"",purpose:"",start_date:n,end_date:n,transportation_type:"company_vehicle",accommodation_required:!1,meal_allowance:!1,other_expenses:"",estimated_cost:""}),[o,j]=l.useState(c||[]),[u,h]=l.useState(""),[x,g]=l.useState("");l.useEffect(()=>{let s=c||[];if(u){const a=u.toLowerCase();s=s.filter(i=>{var r;return i.Fname.toLowerCase().includes(a)||i.Lname.toLowerCase().includes(a)||((r=i.idno)==null?void 0:r.toString().includes(a))})}x&&(s=s.filter(a=>a.Department===x)),j(s)},[u,x,c]);const d=s=>{const{name:a,value:i,type:r,checked:p}=s.target;m({...t,[a]:r==="checkbox"?p:i})},N=s=>{const a=parseInt(s,10);m(i=>i.employee_ids.includes(a)?{...i,employee_ids:i.employee_ids.filter(r=>r!==a)}:{...i,employee_ids:[...i.employee_ids,a]})},v=()=>{m(s=>{const a=o.map(r=>r.id);if(a.every(r=>s.employee_ids.includes(r)))return{...s,employee_ids:s.employee_ids.filter(r=>!a.includes(r))};{const r=s.employee_ids.filter(p=>!a.includes(p));return{...s,employee_ids:[...r,...a]}}})},_=()=>!(new Date(t.start_date)>new Date(t.end_date)),w=s=>{if(s.preventDefault(),t.employee_ids.length===0){alert("Please select at least one employee");return}if(!t.date||!t.destination||!t.purpose){alert("Please fill in all required fields");return}if(!_()){alert("End date cannot be before start date");return}b(t),m({employee_ids:[],date:n,destination:"",purpose:"",start_date:n,end_date:n,transportation_type:"company_vehicle",accommodation_required:!1,meal_allowance:!1,other_expenses:"",estimated_cost:""}),h(""),g("")},f=o.length>0&&o.every(s=>t.employee_ids.includes(s.id)),k=c.filter(s=>t.employee_ids.includes(s.id));return e.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"File New Travel Order"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Create travel order request for one or multiple employees"})]}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Select Employees"}),e.jsxs("div",{className:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2 mb-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by name or ID",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:u,onChange:s=>h(s.target.value)})}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:x,onChange:s=>g(s.target.value),children:[e.jsx("option",{value:"",children:"All Departments"}),y.map((s,a)=>e.jsx("option",{value:s,children:s},a))]})}),e.jsx("div",{className:"md:flex-initial",children:e.jsx("button",{type:"button",className:`w-full px-4 py-2 rounded-md ${f?"bg-indigo-700 hover:bg-indigo-800":"bg-indigo-500 hover:bg-indigo-600"} text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`,onClick:v,children:f?"Deselect All":"Select All"})})]}),e.jsx("div",{className:"border rounded-md overflow-hidden max-h-60 overflow-y-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12",children:"Select"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-4 py-3 text-center text-sm text-gray-500",children:"No employees match your search criteria"})}):o.map(s=>e.jsxs("tr",{className:`hover:bg-gray-50 cursor-pointer ${t.employee_ids.includes(s.id)?"bg-indigo-50":""}`,onClick:()=>N(s.id),children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",checked:t.employee_ids.includes(s.id),onChange:()=>{},onClick:a=>a.stopPropagation()})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:s.idno}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.Lname,", ",s.Fname," ",s.MName||""]})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:s.Department}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:s.Jobtitle})]},s.id))})]})}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:t.employee_ids.length>0?e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium",children:[t.employee_ids.length," employee(s) selected"]}),t.employee_ids.length<=5&&e.jsxs("span",{className:"ml-2",children:["(",k.map(s=>s.Lname).join(", "),")"]})]}):e.jsx("span",{className:"text-yellow-600",children:"No employees selected"})})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Travel Order Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 mb-1",children:["Filing Date ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"date",id:"date",name:"date",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:t.date,onChange:d,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"start_date",className:"block text-sm font-medium text-gray-700 mb-1",children:["Start Date ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"date",id:"start_date",name:"start_date",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:t.start_date,onChange:d,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"end_date",className:"block text-sm font-medium text-gray-700 mb-1",children:["End Date ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"date",id:"end_date",name:"end_date",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:t.end_date,onChange:d,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"destination",className:"block text-sm font-medium text-gray-700 mb-1",children:["Destination ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",id:"destination",name:"destination",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",placeholder:"Enter destination of travel",value:t.destination,onChange:d,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"transportation_type",className:"block text-sm font-medium text-gray-700 mb-1",children:["Transportation Type ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("select",{id:"transportation_type",name:"transportation_type",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:t.transportation_type,onChange:d,required:!0,children:[e.jsx("option",{value:"company_vehicle",children:"Company Vehicle"}),e.jsx("option",{value:"personal_vehicle",children:"Personal Vehicle"}),e.jsx("option",{value:"public_transport",children:"Public Transport"}),e.jsx("option",{value:"plane",children:"Plane"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{className:"space-y-2 mt-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"accommodation_required",name:"accommodation_required",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",checked:t.accommodation_required,onChange:d}),e.jsx("label",{htmlFor:"accommodation_required",className:"ml-2 block text-sm text-gray-900",children:"Accommodation Required"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"meal_allowance",name:"meal_allowance",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",checked:t.meal_allowance,onChange:d}),e.jsx("label",{htmlFor:"meal_allowance",className:"ml-2 block text-sm text-gray-900",children:"Meal Allowance"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Purpose and Expenses"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"purpose",className:"block text-sm font-medium text-gray-700 mb-1",children:["Purpose ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("textarea",{id:"purpose",name:"purpose",rows:"3",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",placeholder:"Provide a detailed purpose for the travel",value:t.purpose,onChange:d,required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Please provide a clear justification for the travel order."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"other_expenses",className:"block text-sm font-medium text-gray-700 mb-1",children:"Other Expenses"}),e.jsx("textarea",{id:"other_expenses",name:"other_expenses",rows:"2",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",placeholder:"List any additional expenses",value:t.other_expenses,onChange:d})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"estimated_cost",className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Cost"}),e.jsx("input",{type:"number",id:"estimated_cost",name:"estimated_cost",step:"0.01",min:"0",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",placeholder:"Enter estimated cost for travel",value:t.estimated_cost,onChange:d})]})]})]})]}),e.jsx("div",{className:"px-4 py-3 bg-gray-50 text-right sm:px-6 border-t",children:e.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Submit Travel Order Request"})})]})]})};export{q as default};
