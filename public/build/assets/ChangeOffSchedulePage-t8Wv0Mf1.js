import{a as A,r as u,j as e,H as E,b as f}from"./app-D-TNKEQL.js";import{A as O}from"./AuthenticatedLayout-PCqsYVxf.js";import{S as P}from"./Sidebar-Cg7Kwp5t.js";import $ from"./ChangeOffScheduleList-BGKuQaP2.js";import L from"./ChangeOffScheduleForm-CHmKvg7l.js";import{y as o,L as M}from"./index-D8OgU6sH.js";/* empty css                      */import"./ApplicationLogo-Cn-MbvX-.js";import"./Dropdown-BOoMuW7P.js";import"./transition-DeCEAfJ2.js";import"./search-DZDiwkir.js";import"./createLucideIcon-DEWnkTLV.js";import"./x-fQrOvEob.js";/* empty css                */import"./users-Cw0U-ZsC.js";import"./file-text-QjoOwKBJ.js";import"./calendar-DhTYrr3L.js";import"./ChangeOffScheduleStatusBadge-PPQWi28n.js";import"./ChangeOffScheduleDetailModal-BeVtPRtv.js";import"./format-Bw_hER4B.js";import"./MultiBulkActionModal-D4ux3rVb.js";import"./download-Dnq6PCPG.js";import"./clsx-B-dksMZM.js";const oe=()=>{const{props:d}=A(),{auth:k,flash:c={}}=d,[g,i]=u.useState(d.schedules||[]),[h,m]=u.useState("list"),[y,p]=u.useState(!1),j=d.employees||[],S=d.departments||[];u.useEffect(()=>{c&&c.message&&o.success(c.message),c&&c.error&&o.error(c.error)},[c]);const v=t=>{f.post(route("change-off-schedules.store"),t,{onSuccess:s=>{s.props.schedules&&i(s.props.schedules),o.success("Schedule change requests created successfully"),m("list")},onError:s=>{s&&typeof s=="object"?Object.keys(s).forEach(a=>{o.error(s[a])}):o.error("An error occurred while submitting form")}})},w=(t,s)=>{if(y)return;const a=Array.isArray(t);a?(console.log(`Batch status update for ${t.length} items`),p(!0)):console.log("Status update called with:",t,s);const x=(n,r)=>new Promise((C,q)=>{f.post(route("change-off-schedules.updateStatus",n),r,{preserveScroll:!0,onSuccess:l=>{!a&&l.props.schedules&&i(l.props.schedules),C(l)},onError:l=>{let b="An error occurred while updating status";l&&typeof l=="object"&&(b=Object.values(l).join(", ")),q(b)}})});if(!a)x(t,s).then(()=>{o.success("Schedule change status updated successfully")}).catch(n=>{o.error(n)});else{const n=t.map(r=>x(r,s));Promise.all(n).then(r=>{r.length>0&&r[r.length-1].props.schedules&&i(r[r.length-1].props.schedules),o.success(`Successfully updated ${t.length} schedule change requests`),p(!1)}).catch(r=>{o.error(`Error updating some schedule change requests: ${r}`),p(!1)})}},N=t=>{confirm("Are you sure you want to delete this schedule change request?")&&f.delete(route("change-off-schedules.destroy",t),{preserveScroll:!0,onSuccess:s=>{s.props.schedules?i(s.props.schedules):i(g.filter(a=>a.id!==t)),o.success("Schedule change request deleted successfully")},onError:()=>o.error("Failed to delete schedule change request")})};return e.jsxs(O,{children:[e.jsx(E,{title:"Change Off Schedule Management"}),e.jsxs("div",{className:"flex min-h-screen bg-gray-50/50",children:[e.jsx("div",{className:"fixed h-screen",children:e.jsx(P,{})}),e.jsx("div",{className:"flex-1 p-8 ml-64",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Change Off Schedule Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage employee requests to change their scheduled days off."})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{className:`${h==="list"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,onClick:()=>m("list"),children:"View Requests"}),e.jsx("button",{className:`${h==="create"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,onClick:()=>m("create"),children:"File New Request"})]})})}),h==="list"?e.jsx($,{schedules:g,onStatusUpdate:w,onDelete:N}):e.jsx(L,{employees:j,departments:S,onSubmit:v})]})})]})})]}),e.jsx(M,{position:"top-right",autoClose:3e3})]})};export{oe as default};
