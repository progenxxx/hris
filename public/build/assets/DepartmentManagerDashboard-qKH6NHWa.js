import{r as n,j as e,H as $}from"./app-7K62fd2B.js";import{A as R}from"./AuthenticatedLayout-DQzQmHv9.js";import F from"./OvertimeStatusBadge-BNqqU74e.js";import{U as b}from"./users-D-OfZtV9.js";import{C as P}from"./circle-check-big-CdHds-fH.js";import{C as p}from"./clock-r6FcyLKi.js";import{C as _}from"./calendar-CWo9dUpk.js";import{f as q}from"./format-Bw_hER4B.js";import"./ApplicationLogo-IpRttWhS.js";import"./Dropdown-Yo6Rw43S.js";import"./transition-Di9UDWSH.js";import"./search-BmV-knWW.js";import"./createLucideIcon-BK5csKvN.js";import"./x-4sBMcqny.js";const V=({auth:v,pendingOvertimes:l,departmentEmployees:h,departmentStats:u,upcomingEvents:g,managedDepartments:w})=>{const[d,f]=n.useState("employees"),[k,c]=n.useState(!1),[t,A]=n.useState(null),[o,j]=n.useState(""),[i,r]=n.useState(!1),y=s=>{try{return q(new Date(s),"yyyy-MM-dd")}catch{return"Invalid date"}},m=s=>{if(!s)return"-";try{let a;if(s.includes("T")){const[,x]=s.split("T");a=x.slice(0,5)}else{const x=s.split(" ");a=x[x.length-1].slice(0,5)}const[D,S]=a.split(":"),N=parseInt(D,10),T=N>=12?"PM":"AM";return`${N%12||12}:${S} ${T}`}catch{return"-"}},C=s=>{A(s),j(""),c(!0)};return e.jsxs(R,{user:v.user,children:[e.jsx($,{title:"Department Manager Dashboard"}),e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Department Manager Dashboard"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Your Managed Departments:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:w.map((s,a)=>e.jsx("span",{className:"px-3 py-1 bg-indigo-100 text-indigo-800 rounded-full text-sm font-medium",children:s},a))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-blue-100 mr-4",children:e.jsx(b,{className:"h-6 w-6 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Total Employees"}),e.jsx("p",{className:"text-2xl font-bold",children:u.employeeCount})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-green-100 mr-4",children:e.jsx(P,{className:"h-6 w-6 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Attendance Rate"}),e.jsx("p",{className:"text-2xl font-bold",children:u.attendanceRate})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-purple-100 mr-4",children:e.jsx(p,{className:"h-6 w-6 text-purple-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Pending Approvals"}),e.jsx("p",{className:"text-2xl font-bold",children:l.length})]})]})})]}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg mb-6",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{className:`${d==="employees"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,onClick:()=>f("employees"),children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Department Employees"]}),e.jsxs("button",{className:`${d==="approvals"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,onClick:()=>f("approvals"),children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"Pending Approvals",l.length>0&&e.jsx("span",{className:"ml-2 bg-red-100 text-red-800 text-xs font-semibold px-2.5 py-0.5 rounded-full",children:l.length})]})]})})}),d==="employees"&&e.jsxs("div",{className:"overflow-x-auto",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Department Employees"}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No employees found in your department"})}):h.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.idno}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.Lname,", ",s.Fname]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.Department}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.Jobtitle}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${s.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status==="active"?"Active":"Inactive"})})]},s.id))})]})]}),d==="approvals"&&e.jsxs("div",{className:"overflow-x-auto",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Pending Overtime Approvals"}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date & Time"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hours"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No pending overtime requests"})}):l.map(s=>{var a;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.employee?`${s.employee.Lname}, ${s.employee.Fname}`:"Unknown employee"}),e.jsx("div",{className:"text-xs text-gray-500",children:((a=s.employee)==null?void 0:a.idno)||"N/A"})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:s.date?y(s.date):"N/A"}),e.jsx("div",{className:"text-xs text-gray-500",children:s.start_time&&s.end_time?`${m(s.start_time)} - ${m(s.end_time)}`:"N/A"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.total_hours!==void 0?parseFloat(s.total_hours).toFixed(2):"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(F,{status:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("button",{onClick:()=>C(s),className:"text-indigo-600 hover:text-indigo-900",children:"Review"})})]},s.id)})})]})]})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(_,{className:"h-5 w-5 text-indigo-500 mr-2"}),"Upcoming Events"]}),g.length===0?e.jsx("p",{className:"text-gray-500",children:"No upcoming events scheduled"}):e.jsx("div",{className:"space-y-4",children:g.map((s,a)=>e.jsx("div",{className:"flex items-start p-4 border rounded-lg hover:bg-gray-50",children:e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:s.title}),e.jsx("p",{className:"text-sm text-gray-500",children:s.date})]})},a))})]})})]})})}),k&&t&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"â€‹"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-indigo-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx(p,{className:"h-6 w-6 text-indigo-600"})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Review Overtime Request"}),e.jsx("div",{className:"mt-2",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["You are about to review the overtime request for",e.jsxs("span",{className:"font-medium",children:[" ",t.employee?`${t.employee.Fname} ${t.employee.Lname}`:"Unknown employee"]}),"."]})}),e.jsxs("div",{className:"mt-4 bg-gray-50 p-4 rounded-md",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Date"}),e.jsx("p",{className:"text-sm font-medium",children:y(t.date)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Time"}),e.jsxs("p",{className:"text-sm font-medium",children:[m(t.start_time)," - ",m(t.end_time)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Hours"}),e.jsx("p",{className:"text-sm font-medium",children:parseFloat(t.total_hours).toFixed(2)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Rate"}),e.jsxs("p",{className:"text-sm font-medium",children:[t.rate_multiplier,"x"]})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Reason"}),e.jsx("p",{className:"text-sm font-medium mt-1",children:t.reason})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Do you want to approve or disapprove this overtime request?"})}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{htmlFor:"remarks",className:"block text-sm font-medium text-gray-700",children:["Remarks ",e.jsx("span",{className:"text-xs text-gray-500",children:"(optional for approval, required for disapproval)"})]}),e.jsx("textarea",{id:"remarks",rows:"3",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",placeholder:"Enter your comments...",value:o,onChange:s=>j(s.target.value)})]})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>{t&&(r(!0),fetch(`/overtimes/${t.id}/status`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({status:"manager_approved",remarks:o||"Approved from dashboard"})}).then(s=>{s.ok?(c(!1),window.location.reload()):(alert("Failed to approve overtime request"),r(!1))}).catch(s=>{console.error("Error approving overtime:",s),alert("An error occurred while approving the overtime request"),r(!1)}))},disabled:i,children:i?"Processing...":"Approve"}),e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>{if(!o.trim()){alert("Please provide remarks for disapproval");return}t&&(r(!0),fetch(`/overtimes/${t.id}/status`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({status:"rejected",remarks:o})}).then(s=>{s.ok?(c(!1),window.location.reload()):(alert("Failed to reject overtime request"),r(!1))}).catch(s=>{console.error("Error rejecting overtime:",s),alert("An error occurred while rejecting the overtime request"),r(!1)}))},disabled:i,children:i?"Processing...":"Disapprove"}),e.jsx("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",onClick:()=>c(!1),disabled:i,children:"Cancel"})]})]})]})})]})};export{V as default};
