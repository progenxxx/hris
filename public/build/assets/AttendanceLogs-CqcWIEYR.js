import{a as D,r as s,j as e,H as L,c as M}from"./app-D-TNKEQL.js";import{A as I}from"./AuthenticatedLayout-PCqsYVxf.js";import{S as O}from"./Sidebar-Cg7Kwp5t.js";import{A as j,a as w}from"./alert-ttcl-5kV.js";import{B as T}from"./Button-SjHtsDzU.js";import B from"./AttendanceModal-BVKub3Iq.js";import{S as F}from"./search-DZDiwkir.js";import"./ApplicationLogo-Cn-MbvX-.js";import"./Dropdown-BOoMuW7P.js";import"./transition-DeCEAfJ2.js";import"./createLucideIcon-DEWnkTLV.js";import"./x-fQrOvEob.js";/* empty css                */import"./users-Cw0U-ZsC.js";import"./file-text-QjoOwKBJ.js";import"./calendar-DhTYrr3L.js";import"./clsx-B-dksMZM.js";const te=()=>{const{auth:h,attendances:o=[],error:u,debug:N={}}=D().props,[a,v]=s.useState(""),[r,b]=s.useState(""),[S,g]=s.useState(null),[k,d]=s.useState(!1),[A,E]=s.useState("view"),[y,p]=s.useState(""),[f,m]=s.useState(u||""),i=s.useMemo(()=>o.filter(t=>{const n=!a||String(t.idno).toLowerCase().includes(a.toLowerCase())||t.employee_name&&t.employee_name.toLowerCase().includes(a.toLowerCase()),c=!r||t.attendance_date&&t.attendance_date.includes(r);return n&&c}),[o,a,r]);s.useEffect(()=>{console.log("Component Mounted"),console.log("Initial Props:",{initialAttendances:o,auth:h,serverError:u,debug:N})},[]),s.useEffect(()=>{console.log("Filtered Attendances:",i),console.log("Search Term:",a),console.log("Date Filter:",r)},[i,a,r]);const l=t=>{if(!t)return"-";try{return new Date(t).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}catch{return"-"}},_=async t=>{var n,c;try{m(""),p(""),console.log("Saving attendance:",t),await M.put(`/attendance-logs/${t.id}`,t),p("Attendance updated successfully"),d(!1),window.location.reload()}catch(x){console.error("Save error:",x),m("Error updating attendance: "+(((c=(n=x.response)==null?void 0:n.data)==null?void 0:c.message)||x.message))}},C=()=>{d(!1),g(null),p(""),m("")};return e.jsxs(I,{user:h.user,children:[e.jsx(L,{title:"Attendance Logs"}),e.jsxs("div",{className:"flex min-h-screen bg-gray-50/50",children:[e.jsx(O,{}),e.jsx("div",{className:"flex-1 p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[y&&e.jsx(j,{className:"mb-4",children:e.jsx(w,{children:y})}),f&&e.jsx(j,{className:"mb-4",variant:"destructive",children:e.jsx(w,{children:f})}),e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Employee Attendance Checker"}),e.jsx("p",{className:"text-gray-600",children:"Easily view and manage employee attendance records."})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(F,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Search by Employee ID or Name...",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:a,onChange:t=>v(t.target.value)})]}),e.jsx("div",{className:"w-48",children:e.jsx("input",{type:"date",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:r,onChange:t=>b(t.target.value)})})]}),e.jsx("div",{className:"overflow-x-auto",children:i.length>0?e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID No."}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Line"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time In"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time Out"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Break In"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Break Out"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.idno}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.employee_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.department}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.line}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.attendance_date}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l(t.time_in)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l(t.time_out)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l(t.break_in)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l(t.break_out)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(T,{onClick:()=>{g(t),E("edit"),d(!0)},className:"text-sm",variant:"outline",children:"Edit"})})]},t.id))})]}):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-600",children:"No attendance records found."})})})]}),e.jsx(B,{isOpen:k,onClose:C,attendance:S,mode:A,onSave:_})]})})]})]})};export{te as default};
