import{V as A,r as p,j as e,M,h}from"./app-C_ClQmDY.js";import{A as k}from"./AuthenticatedLayout-3cR_usYW.js";import{S as V}from"./Sidebar-Bhx-DaaE.js";import P from"./SLVLList-DYPqkmql.js";import $ from"./SLVLForm-B84m7WdG.js";import{y as a,L as B}from"./index-CBJp45S4.js";/* empty css                      */import"./ApplicationLogo-BORf3137.js";import"./Dropdown-CHXQRgIL.js";import"./transition-0ACRCynB.js";import"./search-BDKFcNkb.js";import"./createLucideIcon-D1ADp28Z.js";import"./x-Q1lJB2Tb.js";/* empty css                */import"./users-Dr4YdQlV.js";import"./file-text-DMC5LN9m.js";import"./calendar-B28JSqfz.js";import"./SLVLStatusBadge-BHge3ilW.js";import"./SLVLDetailModal-aPYHkfyM.js";import"./format-Ur_Fko9Q.js";import"./MultiBulkActionModal-J63Uwl4j.js";import"./download-BQI3-SNa.js";import"./clsx-B-dksMZM.js";const oe=()=>{const{props:m}=A(),{auth:C,flash:o={}}=m,[x,c]=p.useState(m.leaves||[]),[u,d]=p.useState("list"),[g,v]=p.useState(!1),y=m.employees||[],j=m.departments||[],L=[{value:"sick",label:"Sick Leave"},{value:"vacation",label:"Vacation Leave"},{value:"emergency",label:"Emergency Leave"},{value:"bereavement",label:"Bereavement Leave"},{value:"maternity",label:"Maternity Leave"},{value:"paternity",label:"Paternity Leave"}];p.useEffect(()=>{o&&o.message&&a.success(o.message),o&&o.error&&a.error(o.error)},[o]);const S=t=>{h.post(route("slvl.store"),t,{onSuccess:s=>{s.props.leaves&&c(s.props.leaves),a.success("Leave requests created successfully"),d("list")},onError:s=>{s&&typeof s=="object"?Object.keys(s).forEach(l=>{a.error(s[l])}):a.error("An error occurred while submitting form")}})},w=(t,s)=>{if(g)return;const l=Array.isArray(t);l?(console.log(`Batch status update for ${t.length} items`),v(!0)):console.log("Status update called with:",t,s);const f=(n,r)=>new Promise((E,q)=>{h.post(route("slvl.updateStatus",n),r,{preserveScroll:!0,onSuccess:i=>{!l&&i.props.leaves&&c(i.props.leaves),E(i)},onError:i=>{let b="An error occurred while updating status";i&&typeof i=="object"&&(b=Object.values(i).join(", ")),q(b)}})});if(!l)f(t,s).then(()=>{a.success("Leave status updated successfully")}).catch(n=>{a.error(n)});else{const n=t.map(r=>f(r,s));Promise.all(n).then(r=>{r.length>0&&r[r.length-1].props.leaves&&c(r[r.length-1].props.leaves),a.success(`Successfully updated ${t.length} leave requests`),v(!1)}).catch(r=>{a.error(`Error updating some leave requests: ${r}`),v(!1)})}},N=t=>{confirm("Are you sure you want to delete this leave request?")&&h.delete(route("slvl.destroy",t),{preserveScroll:!0,onSuccess:s=>{s.props.leaves?c(s.props.leaves):c(x.filter(l=>l.id!==t)),a.success("Leave request deleted successfully")},onError:()=>a.error("Failed to delete leave request")})};return e.jsxs(k,{children:[e.jsx(M,{title:"Leave Management"}),e.jsxs("div",{className:"flex min-h-screen bg-gray-50/50",children:[e.jsx("div",{className:"fixed h-screen",children:e.jsx(V,{})}),e.jsx("div",{className:"flex-1 p-8 ml-64",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Leave Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage employee sick leave and vacation leave requests."})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{className:`${u==="list"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,onClick:()=>d("list"),children:"View Leave Requests"}),e.jsx("button",{className:`${u==="create"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,onClick:()=>d("create"),children:"File New Leave"})]})})}),u==="list"?e.jsx(P,{leaves:x,onStatusUpdate:w,onDelete:N}):e.jsx($,{employees:y,departments:j,leaveTypes:L,onSubmit:S})]})})]})})]}),e.jsx(B,{position:"top-right",autoClose:3e3})]})};export{oe as default};
