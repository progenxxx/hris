import{r as p,j as e}from"./app-C_ClQmDY.js";const U=({employees:y,departments:$,onSubmit:q})=>{const h=new Date().toISOString().split("T")[0],k=()=>`${h} 8AM-5PM`,[a,N]=p.useState({employee_ids:[],effective_date:h,end_date:h,current_schedule:k(),new_schedule:"",new_start_time:"",new_end_time:"",reason:""}),[x,A]=p.useState(y||[]),[g,E]=p.useState(""),[j,D]=p.useState("");p.useEffect(()=>{let t=[],s=[],r=[],i=[],l=[],C=[];y.forEach(n=>{var w;const f=a.employee_ids.includes(n.id);let o=!0,c=!1;if(g){const d=g.toLowerCase().trim(),_=(n.Fname||"").toLowerCase(),v=(n.Lname||"").toLowerCase(),G=(n.MName||"").toLowerCase(),H=`${_} ${v}`.trim(),K=`${v} ${_}`.trim(),S=(w=n.idno)==null?void 0:w.toString().toLowerCase(),T=(n.name||"").toLowerCase();_===d||v===d||H===d||K===d||T===d||S===d?(c=!0,o=!0):o=_.includes(d)||v.includes(d)||G.includes(d)||T.includes(d)||(S==null?void 0:S.includes(d))}let b=!0;j&&(b=(n.department||n.Department||"")===j),b&&(f&&c?t.push(n):f&&o?s.push(n):f?r.push(n):c?i.push(n):o?l.push(n):g||C.push(n))});const u=(n,f)=>{const o=c=>{if(c.name)return c.name.toLowerCase();const b=c.Lname||"",w=c.Fname||"";return`${b}, ${w}`.toLowerCase()};return o(n).localeCompare(o(f))};t.sort(u),s.sort(u),r.sort(u),i.sort(u),l.sort(u),C.sort(u);const z=[...t,...s,...r,...i,...l,...C];A(z)},[g,j,y,a.employee_ids]);const m=t=>{const{name:s,value:r}=t.target;N({...a,[s]:r})},P=t=>{const s=parseInt(t,10);N(r=>r.employee_ids.includes(s)?{...r,employee_ids:r.employee_ids.filter(i=>i!==s)}:{...r,employee_ids:[...r.employee_ids,s]})},I=(t,s)=>{t.stopPropagation(),P(s)},R=()=>{N(t=>{const s=x.map(i=>i.id);if(s.every(i=>t.employee_ids.includes(i)))return{...t,employee_ids:t.employee_ids.filter(i=>!s.includes(i))};{const i=t.employee_ids.filter(l=>!s.includes(l));return{...t,employee_ids:[...i,...s]}}})},F=t=>{if(t.preventDefault(),a.employee_ids.length===0){alert("Please select at least one employee");return}if(!a.effective_date){alert("Please provide an effective date");return}if(!a.new_start_time||!a.new_end_time){alert("Please provide both start and end times");return}if(!a.reason.trim()){alert("Please provide a reason for the time schedule change");return}q(a),N({employee_ids:[],effective_date:h,end_date:h,current_schedule:k(),new_schedule:"",new_start_time:"",new_end_time:"",reason:""}),E(""),D(""),window.scrollTo({top:0,behavior:"smooth"})},L=t=>{if(t.name)return t.name;const s=t.Fname||"",r=t.Lname||"",i=t.MName||"";let l=r;return s&&(l+=l?", "+s:s),i&&(l+=" "+i),l||`Employee #${t.id}`},B=t=>t.department||t.Department||"",O=t=>t.position||t.Jobtitle||"",M=x.length>0&&x.every(t=>a.employee_ids.includes(t.id)),J=y.filter(t=>a.employee_ids.includes(t.id));return e.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"File Time Schedule Change Request"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Create time schedule change request for one or multiple employees"})]}),e.jsxs("div",{onSubmit:F,children:[e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Select Employees"}),e.jsxs("div",{className:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2 mb-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by name or ID",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:g,onChange:t=>E(t.target.value)})}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:j,onChange:t=>D(t.target.value),children:[e.jsx("option",{value:"",children:"All Departments"}),$.map((t,s)=>e.jsx("option",{value:t,children:t},s))]})}),e.jsx("div",{className:"md:flex-initial",children:e.jsx("button",{type:"button",className:`w-full px-4 py-2 rounded-md ${M?"bg-indigo-700 hover:bg-indigo-800":"bg-indigo-500 hover:bg-indigo-600"} text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`,onClick:R,children:M?"Deselect All":"Select All"})})]}),e.jsx("div",{className:"border rounded-md overflow-hidden max-h-60 overflow-y-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12",children:"Select"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-4 py-3 text-center text-sm text-gray-500",children:"No employees match your search criteria"})}):x.map(t=>e.jsxs("tr",{className:`hover:bg-gray-50 cursor-pointer ${a.employee_ids.includes(t.id)?"bg-indigo-50":""}`,onClick:()=>P(t.id),children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",checked:a.employee_ids.includes(t.id),onChange:s=>I(s,t.id),onClick:s=>s.stopPropagation()})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:t.idno||""}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:L(t)})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:B(t)}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:O(t)})]},t.id))})]})}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:a.employee_ids.length>0?e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium",children:[a.employee_ids.length," employee(s) selected"]}),a.employee_ids.length<=5&&e.jsxs("span",{className:"ml-2",children:["(",J.map(t=>L(t).split(",")[0]).join(", "),")"]})]}):e.jsx("span",{className:"text-yellow-600",children:"No employees selected"})})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Schedule Change Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"effective_date",className:"block text-sm font-medium text-gray-700 mb-1",children:["Effective Date ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"date",id:"effective_date",name:"effective_date",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:a.effective_date,onChange:m,required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"The date when the new schedule will start"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"end_date",className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",id:"end_date",name:"end_date",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:a.end_date,onChange:m}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Optional: Leave blank if this is a permanent change"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Time Schedule Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"current_schedule",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Schedule"}),e.jsx("input",{type:"text",id:"current_schedule",name:"current_schedule",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:a.current_schedule,onChange:m,placeholder:"e.g., 2024-12-20 8AM-5PM"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Current date and time schedule (automatically set to today's date)"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"new_start_time",className:"block text-sm font-medium text-gray-700 mb-1",children:["Start Time ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"time",id:"new_start_time",name:"new_start_time",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:a.new_start_time,onChange:m,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"new_end_time",className:"block text-sm font-medium text-gray-700 mb-1",children:["End Time ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"time",id:"new_end_time",name:"new_end_time",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:a.new_end_time,onChange:m,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-1",children:["Reason ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("textarea",{id:"reason",name:"reason",rows:"5",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",placeholder:"Provide a detailed reason for the time schedule change request",value:a.reason,onChange:m,required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Please provide a clear justification for changing the time schedule."})]})]})]})]}),e.jsx("div",{className:"px-4 py-3 bg-gray-50 text-right sm:px-6 border-t",children:e.jsx("button",{type:"submit",onClick:F,className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Submit Time Schedule Change Request"})})]})]})};export{U as default};
