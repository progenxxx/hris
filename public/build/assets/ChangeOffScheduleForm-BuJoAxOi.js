import{r as n,j as e}from"./app-C_ClQmDY.js";import{f as x}from"./format-Ur_Fko9Q.js";const k=({employees:l,departments:y,onSubmit:j})=>{const g=x(new Date,"yyyy-MM-dd"),[a,o]=n.useState({employee_ids:[],original_date:g,requested_date:x(new Date(Date.now()+7*24*60*60*1e3),"yyyy-MM-dd"),reason:""}),[i,b]=n.useState(l||[]),[c,h]=n.useState(""),[m,f]=n.useState("");n.useEffect(()=>{let s=l||[];if(c){const t=c.toLowerCase();s=s.filter(d=>{var r;return d.Fname.toLowerCase().includes(t)||d.Lname.toLowerCase().includes(t)||((r=d.idno)==null?void 0:r.toString().includes(t))})}m&&(s=s.filter(t=>t.Department===m)),b(s)},[c,m,l]);const u=s=>{const{name:t,value:d}=s.target;o({...a,[t]:d})},N=s=>{const t=parseInt(s,10);o(d=>d.employee_ids.includes(t)?{...d,employee_ids:d.employee_ids.filter(r=>r!==t)}:{...d,employee_ids:[...d.employee_ids,t]})},w=()=>{o(s=>{const t=i.map(r=>r.id);if(t.every(r=>s.employee_ids.includes(r)))return{...s,employee_ids:s.employee_ids.filter(r=>!t.includes(r))};{const r=s.employee_ids.filter(S=>!t.includes(S));return{...s,employee_ids:[...r,...t]}}})},v=s=>{if(s.preventDefault(),a.employee_ids.length===0){alert("Please select at least one employee");return}if(!a.original_date||!a.requested_date){alert("Please select both the original and requested off dates");return}if(a.original_date===a.requested_date){alert("Original date and requested date must be different");return}if(!a.reason.trim()){alert("Please provide a reason for the schedule change");return}j(a),o({employee_ids:[],original_date:g,requested_date:x(new Date(Date.now()+7*24*60*60*1e3),"yyyy-MM-dd"),reason:""}),h(""),f("")},p=i.length>0&&i.every(s=>a.employee_ids.includes(s.id)),_=l.filter(s=>a.employee_ids.includes(s.id));return e.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Request Change Off Schedule"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Submit request to change employee's day off schedule"})]}),e.jsxs("form",{onSubmit:v,children:[e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Select Employees"}),e.jsxs("div",{className:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2 mb-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by name or ID",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:c,onChange:s=>h(s.target.value)})}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:m,onChange:s=>f(s.target.value),children:[e.jsx("option",{value:"",children:"All Departments"}),y.map((s,t)=>e.jsx("option",{value:s,children:s},t))]})}),e.jsx("div",{className:"md:flex-initial",children:e.jsx("button",{type:"button",className:`w-full px-4 py-2 rounded-md ${p?"bg-indigo-700 hover:bg-indigo-800":"bg-indigo-500 hover:bg-indigo-600"} text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`,onClick:w,children:p?"Deselect All":"Select All"})})]}),e.jsx("div",{className:"border rounded-md overflow-hidden max-h-60 overflow-y-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12",children:"Select"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Position"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-4 py-3 text-center text-sm text-gray-500",children:"No employees match your search criteria"})}):i.map(s=>e.jsxs("tr",{className:`hover:bg-gray-50 cursor-pointer ${a.employee_ids.includes(s.id)?"bg-indigo-50":""}`,onClick:()=>N(s.id),children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",checked:a.employee_ids.includes(s.id),onChange:()=>{},onClick:t=>t.stopPropagation()})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:s.idno}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.Lname,", ",s.Fname," ",s.MName||""]})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:s.Department}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500",children:s.Jobtitle})]},s.id))})]})}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:a.employee_ids.length>0?e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium",children:[a.employee_ids.length," employee(s) selected"]}),a.employee_ids.length<=5&&e.jsxs("span",{className:"ml-2",children:["(",_.map(s=>s.Lname).join(", "),")"]})]}):e.jsx("span",{className:"text-yellow-600",children:"No employees selected"})})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Schedule Change Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"original_date",className:"block text-sm font-medium text-gray-700 mb-1",children:["Original Off Date ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"date",id:"original_date",name:"original_date",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:a.original_date,onChange:u,required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"The currently scheduled day off"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"requested_date",className:"block text-sm font-medium text-gray-700 mb-1",children:["Requested Off Date ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"date",id:"requested_date",name:"requested_date",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:a.requested_date,onChange:u,required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"The new day off being requested"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Reason for Schedule Change"}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-1",children:["Reason ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("textarea",{id:"reason",name:"reason",rows:"5",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",placeholder:"Provide a detailed reason for the schedule change request",value:a.reason,onChange:u,required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Please provide a clear justification for the requested change."})]})]})]}),e.jsx("div",{className:"px-4 py-3 bg-gray-50 text-right sm:px-6 border-t",children:e.jsx("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Submit Schedule Change Request"})})]})]})};export{k as default};
