import{a as Ce,r as m,c as L,j as e,H as De}from"./app-D-TNKEQL.js";import{A as Ee}from"./AuthenticatedLayout-PCqsYVxf.js";import{S as Fe}from"./Sidebar-Cg7Kwp5t.js";import{B as D}from"./Button-SjHtsDzU.js";import{C as Te,c as Ae}from"./card-qhIlbjIo.js";import{A as ee,a as te}from"./alert-ttcl-5kV.js";import{T as $e,a as Me,b as se,c as ae}from"./tabs-o250_RDq.js";import{l as Ie}from"./lodash-BVV6_chf.js";import{u as A,w as le,r as re}from"./xlsx-BBWTpfDg.js";import{C as Pe,a as Le,F as We,i as Re,b as Be,c as Ue,d as Oe}from"./index-Cb0NO2fG.js";import{D as ne}from"./download-Dnq6PCPG.js";import{U as oe}from"./upload-Cz6lxnvX.js";import{P as qe}from"./plus-DLMoKXB_.js";import{U as He}from"./users-Cw0U-ZsC.js";import{C as J}from"./circle-check-big-BKozuvyq.js";import{C as G}from"./circle-x-Ty60vMKt.js";import{C as ie}from"./clock-D8g538AG.js";import{C as X}from"./calendar-DhTYrr3L.js";import{S as de}from"./search-DZDiwkir.js";import{F as ze}from"./filter-lTp0fuyH.js";import{c as ce}from"./createLucideIcon-DEWnkTLV.js";import{U as me}from"./user-DhodrGY1.js";import{B as Ge}from"./building-DXwlrib0.js";import{T as Ve}from"./triangle-alert-CxlByYdl.js";import{P as Xe}from"./pen-DjejlzQG.js";import{T as Je}from"./trash-2-CDm128Nv.js";import"./ApplicationLogo-Cn-MbvX-.js";import"./Dropdown-BOoMuW7P.js";import"./transition-DeCEAfJ2.js";import"./x-fQrOvEob.js";/* empty css                */import"./file-text-QjoOwKBJ.js";import"./clsx-B-dksMZM.js";import"./index-CC88eXid.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=ce("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=ce("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]),Ye=({message:j,type:g,onClose:v})=>{m.useEffect(()=>{const i=setTimeout(()=>{v()},3e3);return()=>clearTimeout(i)},[v]);const c=g==="success"?"bg-green-50 border-green-200":"bg-red-50 border-red-200",n=g==="success"?"text-green-700":"text-red-700",t=g==="success"?e.jsx(J,{className:"h-5 w-5 text-green-500"}):e.jsx(G,{className:"h-5 w-5 text-red-500"});return e.jsxs("div",{className:`fixed top-4 right-4 z-50 flex items-center p-4 mb-4 rounded-lg shadow-md border ${c}`,role:"alert",children:[e.jsx("div",{className:"inline-flex items-center justify-center flex-shrink-0 w-8 h-8 rounded-lg",children:t}),e.jsx("div",{className:`ml-3 text-sm font-normal ${n}`,children:j}),e.jsx("button",{type:"button",className:`ml-auto -mx-1.5 -my-1.5 rounded-lg focus:ring-2 p-1.5 inline-flex h-8 w-8 ${n} hover:bg-gray-100`,onClick:v,"aria-label":"Close",children:e.jsx(G,{className:"w-5 h-5"})})]})},W=({icon:j,title:g,count:v,color:c})=>e.jsx(Te,{className:"border-t-4 shadow-md hover:shadow-lg transition-shadow duration-200",style:{borderTopColor:c},children:e.jsx(Ae,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 mb-1",children:g}),e.jsx("p",{className:"text-2xl font-bold",children:v})]}),e.jsx("div",{className:"p-3 rounded-full",style:{backgroundColor:`${c}20`},children:j})]})})}),Ze=({isOpen:j,onClose:g,onImport:v})=>{const[c,n]=m.useState(null),[t,i]=m.useState([]),[l,k]=m.useState(!1),N=m.useRef(null),C=h=>{const x=h.target.files[0];x&&(n(x),u(x))},u=h=>{const x=new FileReader;x.onload=y=>{try{const f=re(y.target.result,{type:"array"}),s=f.SheetNames[0],r=f.Sheets[s],w=A.sheet_to_json(r,{header:1});i(w.slice(0,5))}catch(f){console.error("Error reading file:",f),alert("Error reading file. Please make sure it's a valid Excel file.")}},x.readAsArrayBuffer(h)},F=async()=>{if(c){k(!0);try{const h=new FileReader;h.onload=async x=>{try{const y=re(x.target.result,{type:"array"}),f=y.SheetNames[0],s=y.Sheets[f],r=A.sheet_to_json(s);await v(r),g(),n(null),i([])}catch(y){console.error("Import error:",y),alert("Error importing data: "+y.message)}k(!1)},h.readAsArrayBuffer(c)}catch(h){k(!1),alert("Error processing file: "+h.message)}}},_=()=>{const h=[["Employee ID","Shift Type","Work Days","Start Time","End Time","Break Start","Break End","Status","Notes"],["EMP001","regular","Monday,Tuesday,Wednesday,Thursday,Friday","08:00","17:00","12:00","13:00","active","Sample schedule"],["EMP002","night","Monday,Tuesday,Wednesday,Thursday,Friday","22:00","06:00","02:00","03:00","active","Night shift worker"]],x=A.aoa_to_sheet(h),y=A.book_new();A.book_append_sheet(y,x,"Template"),le(y,"employee_schedule_template.xlsx")};return j?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Import Employee Schedules"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-gray-600",children:"Upload an Excel file with employee schedule data"}),e.jsxs(D,{type:"button",variant:"outline",onClick:_,className:"text-sm",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Download Template"]})]}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:[e.jsx("input",{ref:N,type:"file",accept:".xlsx,.xls",onChange:C,className:"hidden"}),e.jsxs("div",{className:"text-center",children:[e.jsx(oe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Click to select an Excel file"}),e.jsx(D,{type:"button",variant:"outline",onClick:()=>{var h;return(h=N.current)==null?void 0:h.click()},children:"Choose File"}),c&&e.jsxs("p",{className:"text-sm text-green-600 mt-2",children:["Selected: ",c.name]})]})]}),t.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Preview (First 5 rows)"}),e.jsx("div",{className:"border rounded-lg overflow-x-auto",children:e.jsx("table",{className:"min-w-full divide-y divide-gray-200",children:e.jsx("tbody",{children:t.map((h,x)=>e.jsx("tr",{className:x===0?"bg-gray-50 font-medium":"",children:h.map((y,f)=>e.jsx("td",{className:"px-4 py-2 text-sm border-r",children:y},f))},x))})})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(D,{type:"button",variant:"outline",onClick:()=>{g(),n(null),i([])},disabled:l,children:"Cancel"}),e.jsx(D,{onClick:F,disabled:!c||l,className:"bg-green-600 hover:bg-green-700",children:l?"Processing...":"Import Data"})]})]})]})}):null},et=({isOpen:j,onClose:g,onSubmit:v,employees:c,editingSchedule:n})=>{const[t,i]=m.useState({employee_ids:[],shift_type:"regular",work_days:[],start_time:"08:00",end_time:"17:00",break_start:"12:00",break_end:"13:00",effective_date:"",end_date:"",status:"active",notes:""}),[l,k]=m.useState(""),N=[{value:"monday",label:"Monday"},{value:"tuesday",label:"Tuesday"},{value:"wednesday",label:"Wednesday"},{value:"thursday",label:"Thursday"},{value:"friday",label:"Friday"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"}],C=[{value:"regular",label:"Regular Shift"},{value:"night",label:"Night Shift"},{value:"flexible",label:"Flexible Shift"},{value:"rotating",label:"Rotating Shift"}],u=c.filter(s=>{const r=l.toLowerCase(),w=`${s.Fname||""} ${s.Lname||""}`.toLowerCase(),E=(s.idno||"").toLowerCase(),$=(s.Department||"").toLowerCase();return w.includes(r)||E.includes(r)||$.includes(r)});m.useEffect(()=>{i(n?{employee_ids:[n.employee_id],shift_type:n.shift_type||"regular",work_days:n.work_days||[],start_time:n.start_time||"08:00",end_time:n.end_time||"17:00",break_start:n.break_start||"12:00",break_end:n.break_end||"13:00",effective_date:n.effective_date||"",end_date:n.end_date||"",status:n.status||"active",notes:n.notes||""}:{employee_ids:[],shift_type:"regular",work_days:[],start_time:"08:00",end_time:"17:00",break_start:"12:00",break_end:"13:00",effective_date:"",end_date:"",status:"active",notes:""}),k("")},[n,j]);const F=s=>{i(r=>({...r,work_days:r.work_days.includes(s)?r.work_days.filter(w=>w!==s):[...r.work_days,s]}))},_=()=>{i(s=>({...s,work_days:["monday","tuesday","wednesday","thursday","friday"]}))},h=()=>{i(s=>({...s,work_days:["saturday","sunday"]}))},x=()=>{i(s=>({...s,work_days:["monday","tuesday","wednesday","thursday","friday","saturday","sunday"]}))},y=()=>{i(s=>({...s,work_days:[]}))},f=s=>{s.preventDefault(),v(t)};return j?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:n?"Edit Schedule":"Create New Schedule"}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employees *"}),e.jsxs("div",{className:"relative mb-3",children:[e.jsx(de,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Search employees by name, ID, or department...",value:l,onChange:s=>k(s.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",disabled:!!n})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsxs("button",{type:"button",onClick:()=>i(s=>({...s,employee_ids:u.map(r=>r.id)})),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",disabled:!!n,children:["Select All ",u.length!==c.length?`(${u.length})`:""]}),e.jsx("button",{type:"button",onClick:()=>i(s=>({...s,employee_ids:[]})),className:"px-3 py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200",disabled:!!n,children:"Clear All"})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg max-h-48 overflow-y-auto",children:e.jsx("div",{className:"p-2",children:u.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(me,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:l?"No employees found matching your search":"No employees available"})]}):u.map(s=>e.jsxs("label",{className:"flex items-center space-x-3 py-2 px-2 hover:bg-gray-50 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.employee_ids.includes(s.id),onChange:r=>{r.target.checked?i(w=>({...w,employee_ids:[...w.employee_ids,s.id]})):i(w=>({...w,employee_ids:w.employee_ids.filter(E=>E!==s.id)}))},className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",disabled:!!n}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.Fname," ",s.Lname]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.idno," - ",s.Department]})]})]},s.id))})}),t.employee_ids.length===0&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"Please select at least one employee"}),t.employee_ids.length>0&&e.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:[t.employee_ids.length," employee",t.employee_ids.length!==1?"s":""," selected",l&&e.jsxs("span",{className:"text-gray-400 ml-1",children:["(from ",u.length," shown)"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shift Type *"}),e.jsx("select",{value:t.shift_type,onChange:s=>i(r=>({...r,shift_type:s.target.value})),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",required:!0,children:C.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Work Days *"}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx("button",{type:"button",onClick:_,className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"Weekdays"}),e.jsx("button",{type:"button",onClick:h,className:"px-3 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200",children:"Weekends"}),e.jsx("button",{type:"button",onClick:x,className:"px-3 py-1 text-xs bg-purple-100 text-purple-700 rounded hover:bg-purple-200",children:"All Days"}),e.jsx("button",{type:"button",onClick:y,className:"px-3 py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Clear All"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:N.map(s=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.work_days.includes(s.value),onChange:()=>F(s.value),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("span",{className:"text-sm",children:s.label})]},s.value))}),t.work_days.length===0&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:"Please select at least one work day"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time *"}),e.jsx("input",{type:"time",value:t.start_time,onChange:s=>i(r=>({...r,start_time:s.target.value})),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time *"}),e.jsx("input",{type:"time",value:t.end_time,onChange:s=>i(r=>({...r,end_time:s.target.value})),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Break Start"}),e.jsx("input",{type:"time",value:t.break_start,onChange:s=>i(r=>({...r,break_start:s.target.value})),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Break End"}),e.jsx("input",{type:"time",value:t.break_end,onChange:s=>i(r=>({...r,break_end:s.target.value})),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effective Date *"}),e.jsx("input",{type:"date",value:t.effective_date,onChange:s=>i(r=>({...r,effective_date:s.target.value})),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date (Optional)"}),e.jsx("input",{type:"date",value:t.end_date,onChange:s=>i(r=>({...r,end_date:s.target.value})),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:t.status,onChange:s=>i(r=>({...r,status:s.target.value})),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"pending",children:"Pending"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:t.notes,onChange:s=>i(r=>({...r,notes:s.target.value})),className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",rows:"3",placeholder:"Additional notes or comments..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(D,{type:"button",variant:"outline",onClick:g,children:"Cancel"}),e.jsx(D,{type:"submit",className:"bg-indigo-600 hover:bg-indigo-700",disabled:t.work_days.length===0||t.employee_ids.length===0,children:n?"Update Schedule":"Create Schedule"})]})]})]})}):null},tt=({schedules:j,onScheduleClick:g,onDateClick:v})=>{const n=(t=>{const i=[];return t.forEach(l=>{l.work_days&&Array.isArray(l.work_days)&&l.work_days.forEach(k=>{var F,_,h,x,y;const N=new Date(l.effective_date),C=l.end_date?new Date(l.end_date):new Date(N.getTime()+365*24*60*60*1e3),u=new Date(N);for(;u<=C;){if(["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][u.getDay()]===k.toLowerCase()){const r=new Date(u),w=new Date(r),E=new Date(r);if(l.start_time){const[$,M]=l.start_time.split(":");w.setHours(parseInt($),parseInt(M),0)}if(l.end_time){const[$,M]=l.end_time.split(":");E.setHours(parseInt($),parseInt(M),0)}i.push({id:`${l.id}-${r.toISOString().split("T")[0]}`,title:`${(F=l.employee)==null?void 0:F.Fname} ${(_=l.employee)==null?void 0:_.Lname} - ${l.shift_type}`,start:w,end:E,backgroundColor:l.shift_type==="night"?"#8b5cf6":l.shift_type==="flexible"?"#06b6d4":l.shift_type==="rotating"?"#f59e0b":"#10b981",borderColor:"transparent",extendedProps:{schedule:l,employeeName:`${(h=l.employee)==null?void 0:h.Fname} ${(x=l.employee)==null?void 0:x.Lname}`,department:(y=l.employee)==null?void 0:y.Department,shiftType:l.shift_type,status:l.status}})}u.setDate(u.getDate()+1)}})}),i})(j);return e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:e.jsx(We,{plugins:[Re,Be,Ue,Oe],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},events:n,eventClick:t=>{g&&g(t.event.extendedProps.schedule)},dateClick:t=>{v&&v(t.date)},height:"600px",eventTextColor:"#ffffff",eventDisplay:"block",dayMaxEvents:3,moreLinkClick:"popover",eventTimeFormat:{hour:"numeric",minute:"2-digit",meridiem:"short"},slotLabelFormat:{hour:"numeric",minute:"2-digit",meridiem:"short"},eventDidMount:t=>{t.el.title=`${t.event.extendedProps.employeeName} - ${t.event.extendedProps.department}
Shift: ${t.event.extendedProps.shiftType}
Status: ${t.event.extendedProps.status}`}})})},st=({schedules:j,onEdit:g,onDelete:v,isLoading:c,formatTime:n})=>e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Employee Schedules"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Shift Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Work Time"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Work Days"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date Range"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[c&&e.jsx("tr",{children:e.jsxs("td",{colSpan:"8",className:"px-6 py-12 text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading schedules..."})]})}),!c&&j.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:"8",className:"px-6 py-12 text-center text-gray-500",children:[e.jsx(X,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium",children:"No schedules found"}),e.jsx("p",{className:"text-sm",children:"Create a new schedule to get started."})]})}),!c&&j.length>0&&j.map((t,i)=>{var l,k,N,C;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:e.jsx(me,{className:"h-5 w-5 text-indigo-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[((l=t.employee)==null?void 0:l.Fname)||"N/A"," ",((k=t.employee)==null?void 0:k.Lname)||""]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",((N=t.employee)==null?void 0:N.idno)||"N/A"]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ge,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm text-gray-900",children:((C=t.employee)==null?void 0:C.Department)||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.shift_type==="regular"?"bg-green-100 text-green-800":t.shift_type==="night"?"bg-purple-100 text-purple-800":t.shift_type==="flexible"?"bg-blue-100 text-blue-800":t.shift_type==="rotating"?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"}`,children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),t.shift_type?t.shift_type.charAt(0).toUpperCase()+t.shift_type.slice(1):"N/A"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-medium",children:[n(t.start_time)," - ",n(t.end_time)]}),t.break_start&&t.break_end&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Break: ",n(t.break_start)," - ",n(t.break_end)]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:t.work_days_formatted||"N/A"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[t.schedules_count||0," day records"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:t.effective_date?new Date(t.effective_date).toLocaleDateString():"N/A"}),t.end_date&&e.jsxs("span",{className:"text-xs text-gray-500",children:["to ",new Date(t.end_date).toLocaleDateString()]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.status==="active"?"bg-green-100 text-green-800":t.status==="inactive"?"bg-red-100 text-red-800":t.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:[t.status==="active"&&e.jsx(J,{className:"h-3 w-3 mr-1"}),t.status==="inactive"&&e.jsx(G,{className:"h-3 w-3 mr-1"}),t.status==="pending"&&e.jsx(Ve,{className:"h-3 w-3 mr-1"}),t.status?t.status.charAt(0).toUpperCase()+t.status.slice(1):"N/A"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{onClick:()=>g(t),className:"text-indigo-600 hover:text-indigo-900 p-1 rounded-md hover:bg-indigo-50",title:"Edit Schedule",children:e.jsx(Xe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>v(t),className:"text-red-600 hover:text-red-900 p-1 rounded-md hover:bg-red-50",title:"Delete Schedule",children:e.jsx(Je,{className:"h-4 w-4"})})]})})]},t.id||`schedule-${i}`)})]})]})})]})}),Wt=()=>{const{auth:j,flash:g,employees:v}=Ce().props,[c,n]=m.useState([]),[t,i]=m.useState(v||[]),[l,k]=m.useState(!0),[N,C]=m.useState(""),[u,F]=m.useState(""),[_,h]=m.useState(""),[x,y]=m.useState(""),[f,s]=m.useState(""),[r,w]=m.useState([]),[E,$]=m.useState(!1),[M,K]=m.useState(null),[xe,I]=m.useState(!1),[pe,Q]=m.useState(!1),[R,B]=m.useState(null),[he,ue]=m.useState("calendar"),[V,Y]=m.useState({visible:!1,message:"",type:"success"}),T=(a,o="success")=>{Y({visible:!0,message:a,type:o})},ge=()=>{Y(a=>({...a,visible:!1}))},ye=a=>{const o=a.target.value;fe(o)},fe=Ie.debounce(a=>{C(a)},300),U=m.useCallback(async()=>{console.log("ðŸ” Starting loadData with filters:",{searchTerm:N,departmentFilter:u,statusFilter:_,shiftFilter:x,workDayFilter:f}),k(!0),K(null);try{const a=new URLSearchParams;N&&a.append("search",N),u&&a.append("department",u),_&&a.append("status",_),x&&a.append("shift_type",x),f&&a.append("work_day",f);const o=`/employee-schedules/list?${a.toString()}`;console.log("ðŸ“¡ Making request to:",o);const p=await L.get(o);console.log("ðŸ“¨ Full API Response:",p);let d=[];p.data&&p.data.success&&(d=p.data.schedules||[],console.log("âœ… Success response, schedules found:",d)),console.log("âœ… Final processed schedules:",d),console.log("âœ… Setting schedules state with",d.length,"items"),n(d)}catch(a){console.error("âŒ Error in loadData:",a),K("Failed to load schedule data. Please try again later."),n([]),T("Failed to load schedule data. Please try again later.","error")}finally{k(!1),console.log("ðŸ loadData completed")}},[N,u,_,x,f]);m.useEffect(()=>{console.log("ðŸŽ¯ useEffect triggered for loadData"),U()},[U]),m.useEffect(()=>{(async()=>{if(!t||t.length===0)try{console.log("ðŸ‘¥ Fetching employees...");const o=await L.get("/employees/list",{params:{active_only:!0}});console.log("ðŸ‘¥ Employees response:",o.data);const p=o.data.data||o.data||[];i(p)}catch(o){console.error("Error fetching employees:",o)}})()},[t]),m.useEffect(()=>{(async()=>{try{console.log("ðŸ¢ Fetching departments...");const o=await L.get("/employee-schedules/departments");console.log("ðŸ¢ Departments response:",o.data);const p=o.data.data||o.data||[];w(p)}catch(o){console.error("Error fetching departments:",o)}})()},[]);const be=()=>{C(""),F(""),h(""),y(""),s("");const a=document.querySelector('input[placeholder*="Search"]');a&&(a.value="")},je=async a=>{var o,p;try{const d=R?`/employee-schedules/${R.id}`:"/employee-schedules";(await L[R?"put":"post"](d,a)).data.success&&(T(R?"Schedule updated successfully":`Schedule created for ${a.work_days.length} days`,"success"),I(!1),B(null),U())}catch(d){console.error("Error saving schedule:",d),T(((p=(o=d.response)==null?void 0:o.data)==null?void 0:p.message)||"Failed to save schedule","error")}},ve=async a=>{var o,p;if(confirm("Are you sure you want to delete this schedule? This will remove all related day schedules."))try{const d=await L.delete(`/employee-schedules/${a.id}`);d.data.success&&(T(`Schedule deleted successfully (${d.data.schedules_deleted} records removed)`,"success"),U())}catch(d){console.error("Error deleting schedule:",d),T(((p=(o=d.response)==null?void 0:o.data)==null?void 0:p.message)||"Failed to delete schedule","error")}},Ne=async a=>{var o,p;try{const d=await L.post("/employee-schedules/import",{data:a});d.data.success&&(T(`Successfully imported ${d.data.imported_count} schedules`,"success"),U())}catch(d){console.error("Error importing data:",d),T(((p=(o=d.response)==null?void 0:o.data)==null?void 0:p.message)||"Failed to import data","error")}},we=()=>{const a=c.map(b=>{var q,H,z,Z;return{"Employee Name":`${((q=b.employee)==null?void 0:q.Fname)||""} ${((H=b.employee)==null?void 0:H.Lname)||""}`,"Employee ID":((z=b.employee)==null?void 0:z.idno)||"",Department:((Z=b.employee)==null?void 0:Z.Department)||"","Shift Type":b.shift_type||"","Work Days":b.work_days_formatted||"","Start Time":b.start_time||"","End Time":b.end_time||"","Break Start":b.break_start||"","Break End":b.break_end||"","Effective Date":b.effective_date||"","End Date":b.end_date||"",Status:b.status||"",Notes:b.notes||""}}),o=A.json_to_sheet(a),p=A.book_new();A.book_append_sheet(p,o,"Employee Schedules");const d=[];Object.keys(a[0]||{}).forEach((b,q)=>{const H=Math.max(b.length,...a.map(z=>String(z[b]||"").length));d[q]={width:Math.min(H+2,50)}}),o["!cols"]=d;const S=`employee_schedules_${new Date().toISOString().split("T")[0]}.xlsx`;le(p,S),T("Schedules exported successfully","success")},P=(()=>{const a=c.filter(S=>S.status==="active").length,o=c.filter(S=>S.status==="inactive").length,p=c.filter(S=>S.status==="pending").length,d=c.filter(S=>S.shift_type==="regular").length,O=c.filter(S=>S.shift_type==="night").length;return{total:c.length,active:a,inactive:o,pending:p,regular:d,night:O}})(),ke=a=>{if(!a)return"";const[o,p]=a.split(":"),d=parseInt(o),O=d>=12?"PM":"AM";return`${d%12||12}:${p} ${O}`},_e=a=>{B(null),I(!0)},Se=a=>{B(null),I(!0)};return e.jsxs(Ee,{user:j.user,children:[e.jsx(De,{title:"Employee Scheduling"}),e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsx(Fe,{}),e.jsx("div",{className:"flex-1 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[V.visible&&e.jsx(Ye,{message:V.message,type:V.type,onClose:ge}),(g==null?void 0:g.message)&&e.jsx(ee,{className:"mb-6",children:e.jsx(te,{children:g.message})}),M&&e.jsx(ee,{className:"mb-6 bg-red-50 border border-red-200 text-red-800",children:e.jsx(te,{className:"text-red-700",children:M})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 mb-1 flex items-center",children:[e.jsx(Pe,{className:"h-6 w-6 mr-2 text-indigo-600"}),"Employee Scheduling"]}),e.jsx("p",{className:"text-gray-600",children:"Manage employee work schedules with calendar and list views. Import/export schedules and create manual entries."})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(D,{onClick:we,variant:"outline",className:"shadow-sm",disabled:c.length===0,children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsxs(D,{onClick:()=>Q(!0),variant:"outline",className:"shadow-sm",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Import"]}),e.jsxs(D,{onClick:()=>I(!0),className:"bg-indigo-600 hover:bg-indigo-700 shadow-sm",children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"New Schedule"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4 mb-6",children:[e.jsx(W,{icon:e.jsx(He,{className:"h-5 w-5 text-indigo-600"}),title:"Total Employees",count:P.total,color:"#6366f1"}),e.jsx(W,{icon:e.jsx(J,{className:"h-5 w-5 text-emerald-600"}),title:"Active",count:P.active,color:"#10b981"}),e.jsx(W,{icon:e.jsx(G,{className:"h-5 w-5 text-red-600"}),title:"Inactive",count:P.inactive,color:"#ef4444"}),e.jsx(W,{icon:e.jsx(ie,{className:"h-5 w-5 text-amber-600"}),title:"Pending",count:P.pending,color:"#f59e0b"}),e.jsx(W,{icon:e.jsx(X,{className:"h-5 w-5 text-emerald-600"}),title:"Regular Shift",count:P.regular,color:"#10b981"}),e.jsx(W,{icon:e.jsx(X,{className:"h-5 w-5 text-purple-600"}),title:"Night Shift",count:P.night,color:"#8b5cf6"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 mb-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(de,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Search employees, departments...",className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-shadow",onChange:ye})]}),e.jsx("div",{className:"inline-flex",children:e.jsxs(D,{variant:"outline",onClick:()=>$(!E),className:"flex items-center shadow-sm hover:bg-gray-50",children:[e.jsx(ze,{className:"h-4 w-4 mr-2 text-indigo-500"}),"Filters",e.jsx(Le,{className:`h-4 w-4 ml-2 transform ${E?"rotate-180":""} text-indigo-500`})]})})]}),E&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-4 pt-4 border-t border-gray-100",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"departmentFilter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsxs("select",{id:"departmentFilter",className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",value:u,onChange:a=>F(a.target.value),children:[e.jsx("option",{value:"",children:"All Departments"}),r.map((a,o)=>e.jsx("option",{value:a,children:a},o))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"statusFilter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{id:"statusFilter",className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",value:_,onChange:a=>h(a.target.value),children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"pending",children:"Pending"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"shiftFilter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Shift Type"}),e.jsxs("select",{id:"shiftFilter",className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",value:x,onChange:a=>y(a.target.value),children:[e.jsx("option",{value:"",children:"All Shifts"}),e.jsx("option",{value:"regular",children:"Regular Shift"}),e.jsx("option",{value:"night",children:"Night Shift"}),e.jsx("option",{value:"flexible",children:"Flexible Shift"}),e.jsx("option",{value:"rotating",children:"Rotating Shift"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"workDayFilter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Work Day"}),e.jsxs("select",{id:"workDayFilter",className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",value:f,onChange:a=>s(a.target.value),children:[e.jsx("option",{value:"",children:"All Days"}),e.jsx("option",{value:"monday",children:"Monday"}),e.jsx("option",{value:"tuesday",children:"Tuesday"}),e.jsx("option",{value:"wednesday",children:"Wednesday"}),e.jsx("option",{value:"thursday",children:"Thursday"}),e.jsx("option",{value:"friday",children:"Friday"}),e.jsx("option",{value:"saturday",children:"Saturday"}),e.jsx("option",{value:"sunday",children:"Sunday"})]})]})]}),(N||u||_||x||f)&&e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(D,{onClick:be,variant:"outline",className:"text-sm",children:"Reset Filters"})})]}),e.jsxs($e,{value:he,onValueChange:ue,className:"space-y-4",children:[e.jsxs(Me,{className:"bg-white p-1 shadow-sm border border-gray-100",children:[e.jsxs(se,{value:"calendar",className:"flex items-center space-x-2 data-[state=active]:bg-indigo-50 data-[state=active]:text-indigo-700",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("span",{children:"Calendar View"})]}),e.jsxs(se,{value:"list",className:"flex items-center space-x-2 data-[state=active]:bg-indigo-50 data-[state=active]:text-indigo-700",children:[e.jsx(Qe,{className:"h-4 w-4"}),e.jsx("span",{children:"List View"})]})]}),e.jsx(ae,{value:"calendar",className:"space-y-4",children:e.jsx(tt,{schedules:c,onScheduleClick:_e,onDateClick:Se})}),e.jsx(ae,{value:"list",className:"space-y-4",children:e.jsx(st,{schedules:c,onEdit:a=>{B(a),I(!0)},onDelete:ve,isLoading:l,formatTime:ke})})]}),e.jsx(et,{isOpen:xe,onClose:()=>{I(!1),B(null)},onSubmit:je,employees:t,editingSchedule:R}),e.jsx(Ze,{isOpen:pe,onClose:()=>Q(!1),onImport:Ne})]})})]})]})};export{Wt as default};
