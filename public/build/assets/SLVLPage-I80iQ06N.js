import{a as A,r as d,j as e,H as k,b as n}from"./app-7K62fd2B.js";import{A as E}from"./AuthenticatedLayout-DQzQmHv9.js";import{S as D}from"./Sidebar-Bpho9Ubl.js";import q from"./SLVLList-BOAuCWiW.js";import C from"./SLVLForm-CH1OO0Iy.js";import M from"./SLVLBankManager-DzUqX9_0.js";import{y as o,L as $}from"./index-DkMCAIk8.js";/* empty css                      */import{C as F}from"./calendar-CWo9dUpk.js";import{P}from"./plus-DDuyej1g.js";import{L as T}from"./list-filter-CNQh_e2P.js";import{D as B}from"./database-C7rSFCET.js";import"./ApplicationLogo-IpRttWhS.js";import"./Dropdown-Yo6Rw43S.js";import"./transition-Di9UDWSH.js";import"./search-BmV-knWW.js";import"./createLucideIcon-BK5csKvN.js";import"./x-4sBMcqny.js";/* empty css                */import"./users-D-OfZtV9.js";import"./file-text-B0cEX_Vi.js";import"./SLVLStatusBadge-CDmh6Ib7.js";import"./SLVLDetailModal-Dwp__xfy.js";import"./FileDisplay-Dn0ZBrXB.js";import"./eye-j6hlzOf-.js";import"./download-DiYogtYp.js";import"./format-Bw_hER4B.js";import"./SLVLBulkActionModal-Ct557ud4.js";import"./SLVLForceApproveButton-DPK4M3a9.js";import"./zap-B1geo600.js";import"./clsx-B-dksMZM.js";import"./loader-BbsVEr4_.js";import"./circle-alert-CGQbi50W.js";import"./upload-BWFV_Ypm.js";import"./differenceInDays-BVuYXEfI.js";import"./refresh-cw-DqcGqKqT.js";const ve=()=>{const{props:h}=A(),{auth:y,flash:a={},userRoles:p={},slvls:L=[],employees:x=[],leaveTypes:g=[],payOptions:v=[],departments:S=[]}=h,[u,c]=d.useState(L),[i,f]=d.useState("create"),[b,l]=d.useState(!1);d.useEffect(()=>{a&&a.message&&o.success(a.message),a&&a.error&&o.error(a.error),a&&a.errors&&Array.isArray(a.errors)&&a.errors.forEach(r=>o.error(r))},[a]);const j=r=>{b||(l(!0),console.log("Submitting SLVL form data:",r),n.post(route("slvl.store"),r,{forceFormData:!0,preserveScroll:!0,onSuccess:s=>{console.log("SLVL submission successful:",s),s.props.slvls&&c(s.props.slvls),o.success("SLVL request created successfully"),l(!1)},onError:s=>{console.error("SLVL submission errors:",s),s&&typeof s=="object"?Object.keys(s).forEach(t=>{Array.isArray(s[t])?s[t].forEach(m=>o.error(m)):o.error(s[t])}):o.error("An error occurred while submitting form"),l(!1)},onFinish:()=>{l(!1)}}))},w=(r,s)=>{b||(l(!0),n.post(route("slvl.updateStatus",r),s,{preserveScroll:!0,onSuccess:t=>{t.props.slvls&&c(t.props.slvls),o.success("SLVL status updated successfully"),l(!1)},onError:t=>{let m="An error occurred while updating status";t&&typeof t=="object"&&(m=Object.values(t).join(", ")),o.error(m),l(!1)}}))},V=r=>{confirm("Are you sure you want to delete this SLVL request?")&&(l(!0),n.delete(route("slvl.destroy",r),{preserveScroll:!0,onSuccess:s=>{s.props.slvls?c(s.props.slvls):c(u.filter(t=>t.id!==r)),o.success("SLVL request deleted successfully"),l(!1)},onError:()=>{o.error("Failed to delete SLVL request"),l(!1)}}))},N=r=>{n.post(route("slvl.addDaysToBank"),r,{preserveScroll:!0,onSuccess:()=>{o.success(`Successfully added ${r.days} ${r.leave_type} leave days to ${r.employee_name}'s bank`),n.reload({only:["slvls","employees"]})},onError:s=>{s&&typeof s=="object"?Object.keys(s).forEach(t=>{o.error(s[t])}):o.error("An error occurred while adding days")}})};return e.jsxs(E,{user:y.user,children:[e.jsx(k,{title:"SLVL Management"}),e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsx(D,{}),e.jsx("div",{className:"flex-1 p-8 ml-0",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:[e.jsx(F,{className:"inline-block w-7 h-7 mr-2 text-indigo-600"}),"SLVL Management"]}),e.jsx("p",{className:"text-gray-600",children:"Manage employee sick leave and vacation leave requests"})]})}),e.jsx("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg",children:e.jsxs("div",{className:"p-6 bg-white border-b border-gray-200",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{className:`${i==="create"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,onClick:()=>f("create"),children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"New SLVL Request"]}),e.jsxs("button",{className:`${i==="list"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,onClick:()=>f("list"),children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"View SLVL Requests",e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs",children:u.length})]}),(p.isHrdManager||p.isSuperAdmin)&&e.jsxs("button",{className:`${i==="bank"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,onClick:()=>f("bank"),children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"SLVL Bank"]})]})})}),i==="list"&&e.jsx(q,{slvls:u,onStatusUpdate:w,onDelete:V,userRoles:p}),i==="create"&&e.jsx(C,{employees:x,leaveTypes:g,payOptions:v,departments:S,onSubmit:j}),i==="bank"&&e.jsx(M,{employees:x,onAddDays:N})]})})]})})]}),e.jsx($,{position:"top-right",autoClose:3e3})]})};export{ve as default};
